10 '
20 'pr{sentation du jeu
30 '
40 MODE 0:BORDER 13:FOR I=0 TO 15:INK I,13:PEN I:NEXT I:PRINT CHR$(22)+CHR$(1)
50 SYMBOL AFTER 64
60 SYMBOL 64,&60,&10,&78,&8C,&7C,&CC,&76
70 KEY 129,CHR$(64)
80 SYMBOL 123,&6,&8,&3C,&66,&7E,&60,&3C
90 KEY 128,CHR$(123)
100 SYMBOL 125,&60,&10,&3C,&66,&7E,&60,&3C
110 KEY 132,CHR$(125)
120 SYMBOL 92,&0,&0,&3C,&66,&60,&3E,&8,&18
130 KEY 135,CHR$(92)
140 RESTORE 190
150 FOR I=144 TO 165
160 READ S1,S2,S3,S4,S5,S6,S7,S8
170 SYMBOL I,S1,S2,S3,S4,S5,S6,S7,S8
180 NEXT I
190 DATA &0,&0,&0,&0,&1F,&3F,&7F,&FF,&0,&0,&0,&0,&F0,&F0,&F0,&F0,&0,&0,&0,&0,&10,&20,&50,&A0,&F0,&F0,&F0,&F0,&E0,&C0,&80,&0,&50,&A0,&50,&A0,&50,&A0,&40,&80,&0,&0,&0,&0,&0,&15,&2A,&55
200 DATA &0,&0,&0,&0,&0,&50,&A0,&40,&0,&0,&0,&18,&18,&0,&0,&0,&C0,&C0,&C0,&C0,&C0,&C0,&FF,&FF,&0,&0,&C0,&C0,&C0,&C0,&C0,&C0,&0,&0,&FF,&FF,&C0,&C0,&C0,&C0,&0,&0,&0,&C0,&C0,&C0,&C0,&C0,&C0,&C0,&C0,&C0,&C0,&C0,&C0,&C0
210 DATA &0,&0,&C0,&C0,&C0,&C0,&C0,&0,&FF,&FF,&C0,&C0,&C0,&C0,&FF,&FF,&0,&0,&C0,&C0,&C0,&C0,&C0,&C0,&0,&0,&C0,&C0,&C0,&C0,&0,&0,&F8,&F8,&C0,&C0,&C0,&C0,&FF,&FF,&0,&0,&C0,&C0,&F3,&F3,&F3,&F3,&CC,&CC,&CC,&C0,&C0,&C0,&C0,&C0
220 DATA &0,&0,&C0,&C0,&F0,&F0,&F0,&F0,&CC,&CC,&C3,&C3,&C3,&C3,&C0,&C0
230 POKE &B290,100
240 CLS
250 WINDOW #7,1,20,1,2:PAPER #7,7:CLS #7
260 GOSUB 280
270 GOTO 380
280 RESTORE 350
290 FOR I=1 TO 39
300 READ V,W,X,Y
310 PEN W
320 LOCATE X,Y
330 PRINT CHR$(V)
340 NEXT I
350 DATA 152,1,1,2,152,3,3,2,153,13,10,1,152,10,13,2,152,9,17,2,153,3,3,1,153,3,4,1,153,2,6,1,153,10,13,1,153,9,18,1,153,15,20,1,154,1,1,1,154,2,5,1,154,4,7,1,154,8,11,1,154,11,15,1,154,9,17,1,155,1,2,2                            
360 DATA 156,3,4,2,155,4,8,2,155,8,12,2,155,10,14,2,155,11,16,2,156,13,10,2,156,9,18,2,156,15,20,2,157,1,2,1,158,2,5,2,159,2,6,2,160,4,8,1,160,8,12,1,160,11,16,1,161,4,7,2,161,8,11,2,161,11,15,2,162,13,9,1,163,13,9,2,164,15,19,1,165,15,19,2
370 RETURN
380 PEN 6:LOCATE 3,7:PRINT "JEU DE REFLEXION":LOCATE 6,9:PRINT "2  niveaux":LOCATE 8,20:PRINT "auteur":LOCATE 3,22:PRINT "Georges  GOUMENT":LOCATE 6,24:PRINT "Avril 1985"
390 Y1=14:Y2=15:X1=5:X2=6
400 FOR I=1 TO 6
410 IF I=1 THEN A=1:B=10:GOTO 470
420 IF I=2 THEN A=3:B=11:GOTO 470
430 IF I=3 THEN A=2:B=9:GOTO 470
440 IF I=4 THEN A=4:B=15:GOTO 470
450 IF I=5 THEN A=13:B=5:GOTO 470
460 IF I=6 THEN A=8:B=14
470 PEN B
480 LOCATE X1,Y1:PRINT CHR$(144):LOCATE X2,Y1:PRINT CHR$(145):LOCATE X2,Y2:PRINT CHR$(147)
490 PEN A
500 LOCATE X2,Y1:PRINT CHR$(146):LOCATE X1,Y2:PRINT CHR$(143):LOCATE X2,Y2:PRINT CHR$(148)
510 X1=X1+2:X2=X2+2
520 NEXT I
530 RESTORE 580
540 FOR I=176 TO 192
550 READ S1,S2,S3,S4,S5,S6,S7,S8
560 SYMBOL I,S1,S2,S3,S4,S5,S6,S7,S8
570 NEXT I
580 DATA &3F,&7F,&0,&0,&30,&30,&30,&30,&F0,&F0,&30,&30,&30,&20,&20,&0,&30,&30,&30,&30,&3F,&3F,&0,&0,&0,&30,&70,&30,&30,&30,&20,&0,&30,&70,&30,&30,&30,&30,&30,&30,&30,&30,&30,&30,&30,&30,&20,&0,&3F,&7F,&0,&0,&30,&30,&3C,&3C   
590 DATA &3F,&7F,&0,&0,&30,&30,&3F,&3F,&0,&0,&30,&30,&3F,&3F,&0,&0,&F0,&F0,&30,&30,&30,&30,&20,&0,&F0,&F0,&30,&30,&20,&0,&0,&0,&30,&70,&3C,&3C,&C,&C,&C,&C,&33,&32,&30,&30,&30,&30,&20,&0,&30,&70,&3C,&3C,&C,&C,&F,&F
600 DATA &33,&33,&30,&30,&30,&30,&20,&0,&F0,&F0,&30,&30,&30,&30,&30,&30,&4,&0,&30,&30,&3F,&3F,&0,&0
610 GOSUB 630
620 GOTO 730
630 RESTORE 700
640 FOR I=1 TO 39
650 READ V,W,X,Y
660 PEN W
670 LOCATE X,Y
680 PRINT CHR$(V)
690 NEXT I
700 DATA 176,10,1,1,177,10,2,1,178,10,1,2,179,10,2,2,180,11,3,1,180,11,4,1,178,11,3,2,181,11,4,2,183,9,5,1,177,9,6,1,184,9,5,2,185,9,6,2,182,15,7,1,186,15,8,1,192,15,7,2,179,15,8,2,187,5,9,1,180,5,10,1,188,5,9,2,181,5,10,2
710 DATA 182,14,11,1,186,14,12,1,192,14,11,2,179,14,12,2,180,1,13,1,178,1,13,2,179,1,14,2,182,3,15,1,186,3,16,1,192,3,15,2,179,3,16,2,176,2,17,1,191,2,18,1,178,2,17,2,181,2,18,2,189,4,19,1,180,4,20,1,190,4,19,2,181,4,20,2
720 RETURN
730 BORDER 0:INK 1,2:INK 10,11:INK 3,3:INK 11,17:INK 2,6:INK 9,16:INK 4,9:INK 15,19:INK 13,12:INK 5,24:INK 8,15:INK 14,25:INK 6,26:INK 7,0
740 GOSUB 4820
750 '
760 'mode d'emploi et r}gles du jeu
770 '
780 MODE 1:BORDER 13
790 FOR I=0 TO 15:INK I,13:PEN I:NEXT I
800 SYMBOL 193,&0,&0,&0,&18,&18
810 SYMBOL 194,&18,&18,&0,&C3,&C3,&0,&18,&18
820 SYMBOL 195,&81,&42,&24,&0,&0,&24,&42,&81
830 PRINT CHR$(22)+CHR$(1)
840 A=193:C=1
850 FOR I=1 TO 3
860 FOR X=1 TO 40
870 PEN C
880 LOCATE X,1:PRINT CHR$(A)
890 LOCATE X,24:PRINT CHR$(A)
900 NEXT X
910 A=A+1:C=C+1
920 NEXT I
930 A=193:C=1
940 FOR I=1 TO 3
950 FOR Y=2 TO 23
960 PEN C
970 LOCATE 1,Y:PRINT CHR$(A)
980 LOCATE 40,Y:PRINT CHR$(A)
990 NEXT Y
1000 A=A+1:C=C+1
1010 NEXT I
1020 INK 1,24:INK 2,6:INK 3,0
1030 WINDOW #1,2,39,2,23:PAPER #1,0:CLS #1
1040 INK 3,13:PEN #1,3:PRINT #1:PRINT #1,"            MODE D'EMPLOI":PRINT #1,"            *************"
1050 PRINT #1:PRINT #1:PRINT #1,"    Choisissez votre niveau de jeu":PRINT #1:PRINT #1,"FORCE 1: d{butant  15 cubes 4 couleurs":PRINT #1:PRINT #1,"FORCE 2: champion  25 cubes 6 couleurs":PRINT #1
1060 PRINT #1,"   chaque niveau comporte 4 options":PRINT #1:PRINT #1,"l'ordinateur en tire une au sort avant        de pr{parer la partie"
1070 PRINT #1:PRINT #1,"  Vous n'avez pas @ intervenir durant           cette phase du jeu"
1080 GOSUB 1240
1090 PEN #1,3:PRINT #1:PRINT #1,"             PREPARATION":PRINT #1,"             ***********":PRINT #1:PRINT #1 
1100 PRINT #1,"      L'ordinateur choisi un des cubesdisponibles l' affiche dans le bas de l'{cran et pr{pare le jeu.":PRINT #1
1110 PRINT #1,"Apr}s avoir dispos{ ce m}me cube sur 3ou 5 rangs il effectue un m{lange.":PRINT #1:PRINT #1,"Le choix des cubes, la proc{dure et lenombre de brouillages sont al{atoires."
1120 PRINT #1:PRINT #1,"  Vous b{n{ficiez ainsi d'une centainede parties diff{rentes, quel que soit le niveau choisi."
1130 GOSUB 1240
1140 PEN #1,3:PRINT #1:PRINT #1,"            REGLES DU JEU":PRINT #1,"            *************":PRINT #1
1150 PRINT #1,"Vous commencez @ jouer lorsqu'un petitcarr{ blanc apparait sur la face avantdu cube central.":PRINT #1
1160 PRINT #1,"   Ce carr{ indique le cube servant debase pour modifier les couleurs.":PRINT #1:PRINT #1,"    Pour passer d'un cube @ l'autre etchanger cette base de jeu, servez vousdes 4 touches fl{ch{es."" 
1170 PRINT #1:PRINT #1,"Pour permuter les couleurs appuyez surla touche COPY.Vous annulez la partie avec <A>.Vous appuierez sur <V> pour  que l'ordinateur controle le jeu avantde vous d{clarer vainqueur.""
1180 GOSUB 1240
1190 PEN #1,3:PRINT #1:PRINT #1,"  POUR GAGNER UNE PARTIE  VOUS DEVEZ":PRINT #1:PRINT #1,"   REDONNER A VOS CUBES UNE COULEUR":PRINT #1:PRINT #1," IDENTIQUE A CELLE QUE L'ORDINATEUR A" 
1200 PRINT #1:PRINT #1,"       CHOISIE AU DEBUT DU JEU":PRINT #1:PRINT #1:PRINT #1,"           BONNE CHANCE !":PRINT #1:PRINT #1:
1210 PRINT #1,"Quand les divers affichages clignotentil vous reste 20 coups a jouer.":PRINT #1:PRINT #1,"     Sachez en profiter au mieux.":PRINT #1:PRINT #1,"   R{sultats @ chaque fin de partie."
1220 GOSUB 1240
1230 GOTO 1310
1240 INK 3,0:LOCATE 2,23:PRINT "Appuyez sur une touche"
1250 WHILE INKEY$="":WEND
1260 CLS #1:INK 3,13
1270 RETURN
1280 '
1290 'd{but de la partie
1300 '
1310 RANDOMIZE TIME:MODE 0:INK 1,0:PEN 1:INPUT "NIVEAU CHOISI ",F:CLS:PRINT CHR$(22)+CHR$(1):FOR I=1 TO 15:INK I,13:NEXT:OP=INT(RND*4)+1
1320 PEN 6:LOCATE 7,15:PRINT "couleurs" 
1330 WINDOW #1,1,5,20,23:PAPER #1,10:CLS#1:WINDOW #2,16,20,20,23:PAPER #2,10:CLS#2
1340 LOCATE 1,20:PEN 1:PRINT "SCORE":LOCATE 16,20:PRINT "FORCE"
1350 PEN 12:LOCATE 2,22:PRINT "000":LOCATE 17,22:PRINT F
1360 IF F=1 THEN Y=16:GOTO 1390
1370 Y=16:X=5
1380 LOCATE X,Y:PEN 11:PRINT CHR$(144)+CHR$(145):LOCATE X+1,Y+1:PRINT CHR$(147):LOCATE X+1,Y:PEN 3:PRINT CHR$(146):LOCATE X,Y+1:PRINT CHR$(143)+CHR$(148):LOCATE X+1,Y+1:PEN 7:PRINT CHR$(149)
1390 LOCATE 7,Y:PEN 9:PRINT CHR$(144)+CHR$(145):LOCATE 8,Y+1:PRINT CHR$(147):LOCATE 8,Y:PEN 2:PRINT CHR$(146):LOCATE 7,Y+1:PRINT CHR$(143)+CHR$(148):LOCATE 8,Y+1:PEN 7:PRINT CHR$(149)
1400 LOCATE 9,Y:PEN 15:PRINT CHR$(144)+CHR$(145):LOCATE 10,Y+1:PRINT CHR$(147):LOCATE 10,Y:PEN 4:PRINT CHR$(146):LOCATE 9,Y+1:PRINT CHR$(143)+CHR$(148):LOCATE 10,Y+1:PEN 7:PRINT CHR$(149)
1410 LOCATE 11,Y:PEN 5:PRINT CHR$(144)+CHR$(145):LOCATE 12,Y+1:PRINT CHR$(147):LOCATE 12,Y:PEN 13:PRINT CHR$(146):LOCATE 11,Y+1:PRINT CHR$(143)+CHR$(148):LOCATE 12,Y+1:PEN 7:PRINT CHR$(149)
1420 LOCATE 13,Y:PEN 10:PRINT CHR$(144)+CHR$(145):LOCATE 14,Y+1:PRINT CHR$(147):LOCATE 14,Y:PEN 1:PRINT CHR$(146):LOCATE 13,Y+1:PRINT CHR$(143)+CHR$(148):LOCATE 14,Y+1:PEN 7:PRINT CHR$(149)+CHR$(150)
1430 IF F=1 THEN 1440 ELSE LOCATE 15,Y:PEN 14:PRINT CHR$(144)+CHR$(145):LOCATE 16,Y+1:PRINT CHR$(147):LOCATE 16,Y:PEN 8:PRINT CHR$(146):LOCATE 15,Y+1:PRINT CHR$(143)+CHR$(148):LOCATE 16,Y+1:PEN 7:PRINT CHR$(149)+CHR$(150)
1440 GOSUB 280:GOSUB 630
1450 A=0:INK 1,2:INK 2,6:INK 3,3:INK 4,9:INK 5,24:INK 6,26:INK 7,0:INK 8,15:INK 9,16:INK 10,11:INK 11,17:INK 12,7:INK 13,12:INK 14,25:INK 15,19
1460 ENV 1,1,15,1,1,0,110,15,-1,8
1470 ENT 1,15,-5,6,5,15,5
1480 SOUND 7,80,-1,0,1,1
1490 '
1500 'choix d'un cube par l'ordinateur
1510 '
1520 A=INT(RND*6)+1
1530 IF F=1 THEN 1550
1540 IF A=1 THEN A=3:B=11:GOTO 1620
1550 IF A=2 THEN A=4:B=15:GOTO 1620
1560 IF A=3 THEN A=2:B=9:GOTO 1620
1570 IF A=4 THEN A=13:B=5:GOTO 1620
1580 IF A=5 THEN A=1:B=10:GOTO 1620
1590 IF F=1 THEN 1520
1600 IF A=6 THEN A=8:B=14:GOTO 1620
1610 GOTO 1520
1620 PEN 6:LOCATE 9,19:PRINT"cube":LOCATE 8,20:PRINT "choisi"
1630 LOCATE 10,21:PEN B:PRINT CHR$(144)+CHR$(145):LOCATE 11,22:PRINT CHR$(147):LOCATE 11,21:PEN A:PRINT CHR$(146):LOCATE 11,22:PRINT CHR$(148)
1640 LOCATE 10,22:PRINT CHR$(143):LOCATE 11,22:PEN 7:PRINT CHR$(149)+CHR$(150)
1650 '
1660 'mise en place de 15 ou 25 cubes 
1670 '
1680 IF F=1 THEN 1790
1690 FOR X=10 TO 18 STEP 2
1700 LOCATE X,4:PEN A:PRINT CHR$(143)
1710 LOCATE X,3:PEN B:PRINT CHR$(144)
1720 LOCATE X+1,3:PRINT CHR$(145)
1730 LOCATE X+1,4:PRINT CHR$(147)
1740 LOCATE X+1,3:PEN A:PRINT CHR$(146)
1750 LOCATE X+1,4:PRINT CHR$(148)
1760 LOCATE X+1,4:PEN 7:PRINT CHR$(149)
1770 NEXT X
1780 LOCATE 20,4:PRINT CHR$(150)
1790 FOR X=8 TO 16 STEP 2
1800 LOCATE X,6:PEN A:PRINT CHR$(143)
1810 LOCATE X,5:PEN B:PRINT CHR$(144)
1820 LOCATE X+1,5:PRINT CHR$(145)
1830 LOCATE X+1,6:PRINT CHR$(147)
1840 LOCATE X+1,5:PEN A:PRINT CHR$(146)
1850 LOCATE X+1,6:PRINT CHR$(148)
1860 LOCATE X+1,6:PEN 7:PRINT CHR$(149)
1870 NEXT X
1880 LOCATE 18,6:PRINT CHR$(150)
1890 FOR X=6 TO 14 STEP 2
1900 LOCATE X,8:PEN A:PRINT CHR$(143) 
1910 LOCATE X,7:PEN B:PRINT CHR$(144)
1920 LOCATE X+1,7:PRINT CHR$(145)
1930 LOCATE X+1,8:PRINT CHR$(147)
1940 LOCATE X+1,7:PEN A:PRINT CHR$(146)
1950 LOCATE X+1,8:PRINT CHR$(148)
1960 LOCATE X+1,8:PEN 7:PRINT CHR$(149)
1970 NEXT X
1980 LOCATE 16,8:PRINT CHR$(150)
1990 FOR X=4 TO 12 STEP 2
2000 LOCATE X,10:PEN A:PRINT CHR$(143)
2010 LOCATE X,9:PEN B:PRINT CHR$(144)
2020 LOCATE X+1,9:PRINT CHR$(145)
2030 LOCATE X+1,10:PRINT CHR$(147)
2040 LOCATE X+1,9:PEN A:PRINT CHR$(146)
2050 LOCATE X+1,10:PRINT CHR$(148)
2060 LOCATE X+1,10:PEN 7:PRINT CHR$(149)
2070 NEXT X
2080 LOCATE 14,10:PRINT CHR$(150)
2090 IF F=1 THEN 2230
2100 FOR X=2 TO 10 STEP 2
2110 LOCATE X,12:PEN A:PRINT CHR$(143)
2120 LOCATE X,11:PEN B:PRINT CHR$(144)
2130 LOCATE X+1,11:PRINT CHR$(145)
2140 LOCATE X+1,12:PRINT CHR$(147)
2150 LOCATE X+1,11:PEN A:PRINT CHR$(146)
2160 LOCATE X+1,12:PRINT CHR$(148)
2170 LOCATE X+1,12:PEN 7:PRINT CHR$(149)
2180 NEXT X
2190 '
2200 'd{but du brouillage
2210 '
2220 PEN 7:LOCATE 12,12:PRINT CHR$(150)
2230 WINDOW #3,7,14,23,24
2240 GOSUB 2250:GOTO 2280
2250 FOR J=1 TO 10:FOR I=1 TO 100 STEP 10
2260 SOUND 1,I,1,15
2270 NEXT I:NEXT J:RETURN
2280 IF F=2 THEN 2310
2290 M=INT(RND*10)+5
2300 GOTO 2320
2310 M=INT(RND*25)+10
2320 FOR P=1 TO M
2330 '
2340 'choix al{atoire des cubes 
2350 '
2360 IF F=2 THEN 2410
2370 Y=INT(RND*3)+1
2380 IF Y=1 THEN Y=306:L=6:GOTO 2530
2390 IF Y=2 THEN Y=274:L=8:GOTO 2590
2400 IF Y=3 THEN Y=242:L=10:GOTO 2650
2410 Y=INT(RND*5)+1
2420 IF Y=1 THEN Y=338:L=4:GOTO 2470
2430 IF Y=2 THEN Y=306:L=6:GOTO 2530
2440 IF Y=3 THEN Y=274:L=8:GOTO 2590
2450 IF Y=4 THEN Y=242:L=10:GOTO 2650
2460 IF Y=5 THEN Y=210:L=12:GOTO 2710
2470 X=INT(RND*5)+1
2480 IF X=1 THEN X=290:C=10:GOTO 2860
2490 IF X=2 THEN X=354:C=12:GOTO 2860
2500 IF X=3 THEN X=418:C=14:GOTO 2860
2510 IF X=4 THEN X=482:C=16:GOTO 2860
2520 IF X=5 THEN X=546:C=18:GOTO 2860
2530 X=INT(RND*5)+1
2540 IF X=1 THEN X=226:C=8:GOTO 2860
2550 IF X=2 THEN X=290:C=10:GOTO 2860
2560 IF X=3 THEN X=354:C=12:GOTO 2860
2570 IF X=4 THEN X=418:C=14:GOTO 2860
2580 IF X=5 THEN X=482:C=16:GOTO 2860
2590 X=INT(RND*5)+1
2600 IF X=1 THEN X=162:C=6:GOTO 2860
2610 IF X=2 THEN X=226:C=8:GOTO 2860
2620 IF X=3 THEN X=290:C=10:GOTO 2860
2630 IF X=4 THEN X=354:C=12:GOTO 2860
2640 IF X=5 THEN X=418:C=14:GOTO 2860
2650 X=INT(RND*5)+1
2660 IF X=1 THEN X=98:C=4:GOTO 2860
2670 IF X=2 THEN X=162:C=6:GOTO 2860
2680 IF X=3 THEN X=226:C=8:GOTO 2860
2690 IF X=4 THEN X=290:C=10:GOTO 2860
2700 IF X=5 THEN X=354:C=12:GOTO 2860
2710 X=INT(RND*5)+1
2720 IF X=1 THEN X=34:C=2:GOTO 2860
2730 IF X=2 THEN X=98:C=4:GOTO 2860
2740 IF X=3 THEN X=162:C=6:GOTO 2860
2750 IF X=4 THEN X=226:C=8:GOTO 2860
2760 IF X=5 THEN X=290:C=10:GOTO 2860
2770 NEXT P
2780 P=60:GOSUB 2250
2790 IF F=2 THEN CJ=M*6:GOTO 2810
2800 IF F=1 THEN CJ=M*4
2810 SC=0
2820 X=290:Y=274:L=8:C=10
2830 '
2840 'modifie la couleur du cube de base  
2850 '
2860 MOVE X,Y
2870 IF F=1 THEN 2920
2880 IF TEST(X,Y)<>3 THEN 2920
2890 A=3:B=11
2900 IF OP=1 OR OP=2 THEN A1=8:B1=14:GOTO 3170
2910 IF OP=3 OR OP=4 THEN A1=2:B1=9:GOTO 3170
2920 IF TEST(X,Y)<>2 THEN 2990
2930 A=2:B=9
2940 IF F=2 THEN 2970
2950 IF OP=1 OR OP=2 THEN A1=1:B1=10:GOTO 3170
2960 GOTO 2980
2970 IF OP=1 OR OP=2 THEN  A1=3:B1=11:GOTO 3170
2980 IF OP=3 OR OP=4 THEN A1=4:B1=15:GOTO 3170
2990 IF TEST(X,Y)<>4 THEN 3030
3000 A=4:B=15
3010 IF OP=1 OR OP=2 THEN A1=2:B1=9:GOTO 3170
3020 IF OP=3 OR OP=4 THEN A1=13:B1=5:GOTO 3170
3030 IF TEST(X,Y)<>13 THEN 3070
3040 A=13:B=5
3050 IF OP=1 OR OP=2 THEN A1=4:B1=15:GOTO 3170
3060 IF OP=3 OR OP=4 THEN A1=1:B1=10:GOTO 3170
3070 IF TEST(X,Y)<>1 THEN 3130
3080 A=1:B=10
3090 IF OP=1 OR OP=2 THEN A1=13:B1=5:GOTO 3170
3100 IF F=2 THEN 3120
3110 IF OP=3 OR OP=4 THEN A1=2:B1=9:GOTO 3170
3120 IF OP=3 OR OP=4 THEN A1=8:B1=14:GOTO 3170
3130 IF TEST(X,Y)<>8 THEN 2820
3140 A=8:B=14
3150 IF OP=1 OR OP=2 THEN A1=1:B1=10:GOTO 3170
3160 IF OP=3 OR OP=4 THEN A1=3:B1=11
3170 IF P<=M THEN 3760
3180 GOTO 3240
3190 SOUND 10,46,5,7
3200 SOUND 17,66,5,7
3210 '
3220 'affiche le carr{ blanc sur un cube
3230 '
3240 LOCATE C,L:PEN 6:PRINT CHR$(151)
3250 '
3260 'd{placements et touches de jeu
3270 '
3280 IF INKEY(0)=0 THEN 3360
3290 IF INKEY(2)=0 THEN 3420
3300 IF INKEY(1)=0 THEN 3480
3310 IF INKEY(8)=0 THEN 3590
3320 IF INKEY(9)=0 THEN 3760
3330 IF INKEY(69)=0 THEN 5450
3340 IF INKEY(55)=0 THEN GOSUB 3680::GOTO 4980
3350 GOTO 3240
3360 IF F=2 AND L=4 THEN 3190
3370 IF F=1 AND L=6 THEN 3190
3380 GOSUB 3680
3390 L=L-2:C=C+2
3400 X=X+64:Y=Y+32
3410 GOTO 2860
3420 IF F=2 AND L=12 THEN 3190:GOTO 3440
3430 IF F=1 AND L=10 THEN 3190
3440 GOSUB 3680
3450 L=L+2:C=C-2
3460 X=X-64:Y=Y-32
3470 GOTO 2860
3480 IF F=1 AND L=6 AND C=16 THEN 3190
3490 IF L=4 AND C=18 THEN 3190
3500 IF L=6 AND C=16 THEN 3190
3510 IF L=8 AND C=14 THEN 3190
3520 IF F=2 AND L=10 AND C=12 THEN 3190
3530 IF L=10 AND C=12 THEN 3190
3540 IF L=12 AND C=10 THEN 3190
3550 GOSUB 3680
3560 C=C+2
3570 X=X+64
3580 GOTO 2860
3590 IF F=1 THEN 3600 ELSE IF L=4 AND C=10 THEN 3190
3600 IF L=6 AND C=8 THEN 3190
3610 IF L=8 AND C=6 THEN 3190
3620 IF L=10 AND C=4 THEN 3190
3630 IF F=1 THEN 3640 ELSE IF L=12 AND C=2 THEN 3190
3640 GOSUB 3680
3650 C=C-2
3660 X=X-64
3670 GOTO 2860
3680 LOCATE C,L
3690 PEN A
3700 PRINT CHR$(143)
3710 FOR TP=1 TO 300:NEXT
3720 RETURN
3730 '
3740 'affichage du score
3750 '
3760 IF P=60 THEN 3790 
3770 ENV 1,50,2,2:ENT 1,50,-2,2:SOUND 1,220,75,1,1,1
3780 IF P<>60 THEN 3880
3790 SOUND 1,2000,5,15,0,0,1
3800 SC=SC+1
3810 SOUND 1,1967,5,15,1,1,30
3820 IF SC<=CJ-20 THEN 3850
3830 INK 12,7,26
3840 IF SC=CJ THEN 4730
3850 IF SC>9 THEN 3860 ELSE LOCATE 4,22:PEN 10:PRINT CHR$(143):LOCATE 3,22:PEN 12:PRINT SC:GOTO 3880
3860 IF SC>99 THEN 3870 ELSE LOCATE 3,22:PEN 10:PRINT CHR$(143)+CHR$(143):LOCATE 2,22:PEN 12:PRINT SC:GOTO 3880
3870 LOCATE 2,22:PEN 10:PRINT CHR$(143)+CHR$(143)+CHR$(143):LOCATE 1,22:PEN 12:PRINT SC
3880 PEN B1
3890 LOCATE C,L-1:PRINT CHR$(144)
3900 LOCATE C+1,L-1:PRINT CHR$(145)
3910 LOCATE C+1,L:PRINT CHR$(147)
3920 PEN A1
3930 LOCATE C+1,L-1:PRINT CHR$(146)
3940 LOCATE C,L:PRINT CHR$(143)+CHR$(148)
3950 '
3960 '{tude des cubes entourant le cube de base
3970 '
3980 IF F=2 AND L=4 THEN 4030
3990 IF F=1 AND L<=6 THEN 4030
4000 U=L-2:V=C+2
4010 YA=Y+32:XA=X+64
4020 GOSUB 4320
4030 IF F=2 AND L=4 AND C=18 THEN 4130
4040 IF F=1 AND L<=6 AND C=16 THEN 4130
4050 IF L=6 AND C=16 THEN 4130
4060 IF L=8 AND C=14 THEN 4130
4070 IF F=1 AND L>=10 AND C=12 THEN 4130
4080 IF L=10 AND C=12 THEN 4130
4090 IF L=12 AND C=10 THEN 4130
4100 U=L:V=C+2
4110 YA=Y:XA=X+64
4120 GOSUB 4320
4130 IF F=2 AND L=12 THEN 4180
4140 IF F=1 AND L>=10 THEN 4180
4150 U=L+2:V=C-2
4160 YA=Y-32:XA=X-64
4170 GOSUB 4320
4180 IF F=2 AND L=4 AND C=10 THEN 4280
4190 IF F=1 AND L<=6 AND C=8 THEN 4280
4200 IF L=6 AND C=8 THEN 4280
4210 IF L=8 AND C=6 THEN 4280
4220 IF F=1 AND L>=10 AND C=4 THEN 4280
4230 IF L=10 AND C=4 THEN 4280
4240 IF L=12 AND C=2 THEN 4280
4250 U=L:V=C-2
4260 YA=Y:XA=X-64
4270 GOSUB 4320
4280 IF P<60 THEN 4300
4290 GOTO 2860
4300 IF P=M THEN 2780
4310 GOTO 2770
4320 '
4330 'd{termine les modifications de couleur @ donner aux cubes entourant le cube de base
4340 '
4350 IF F=1 THEN 4390
4360 IF TEST(XA,YA)<>3 THEN 4390
4370 IF OP=2 OR OP=3 THEN A1=2:B1=9:GOTO 4610
4380 IF OP=1 OR OP=4 THEN A1=8:B1=14:GOTO 4610
4390 IF TEST(XA,YA)<>2 THEN 4440
4400 IF F=2 THEN 4420
4410 IF OP=1 OR OP=4 THEN A1=1:B1=10:GOTO 4610
4420 IF OP=2 OR OP=3 THEN A1=4:B1=15:GOTO 4610
4430 IF OP=1 OR OP=4 THEN A1=3:B1=11:GOTO 4610
4440 IF TEST(XA,YA)<>4 THEN 4470
4450 IF OP=2 OR OP=3 THEN A1=13:B1=5:GOTO 4610
4460 IF OP=1 OR OP=4 THEN A1=2:B1=9:GOTO 4610
4470 IF TEST(XA,YA)<>13 THEN 4500
4480 IF OP=2 OR OP=3 THEN A1=1:B1=10:GOTO 4610
4490 IF OP=1 OR OP=4 THEN A1=4:B1=15:GOTO 4610
4500 IF TEST(XA,YA)<>1 THEN 4550
4510 IF F=2 THEN 4530
4520 IF OP=2 OR OP=3 THEN A1=2:B1=9:GOTO 4610
4530 IF OP=1 OR OP=4 THEN A1=13:B1=5:GOTO 4610
4540 IF OP=2 OR OP=3 THEN A1=8:B1=14:GOTO 4610
4550 IF F=1 THEN 4610 ELSE IF TEST(XA,YA)<>8 THEN 4280
4560 IF OP=2 OR OP=3 THEN A1=3:B1=11:GOTO 4610
4570 IF OP=1 OR OP=4 THEN A1=1:B1=10
4580 '
4590 'modifie la couleur cube par cube
4600 '
4610 PEN B1
4620 LOCATE V,U-1:PRINT CHR$(144)
4630 LOCATE V+1,U-1:PRINT CHR$(145)
4640 LOCATE V+1,U:PRINT CHR$(147)
4650 PEN A1
4660 LOCATE V+1,U-1:PRINT CHR$(146)
4670 LOCATE V,U:PRINT CHR$(143)+CHR$(148)
4680 V=0:U=0:A1=0:B1=0
4690 RETURN
4700 '
4710 'la partie est perdue
4720 '
4730 G=40:FOR I=1 TO 26
4740 INK 0,I
4750 SOUND 10,G,10,15
4760 SOUND 17,G-20,10,15
4770 G=G+20
4780 PEN 12:LOCATE 8,24:PRINT "PERDU":NEXT I:GOSUB 2250:GOTO 5500
4790 '
4800 'accompagnement musical
4810 '
4820 ENV 1,1,15,0,7,-2,0
4830 ENV 2,1,15,1,20,-2,0.5
4840 ENV 4,1,15,1,10,-3,0.5 
4850 RESTORE 4920
4860 FOR I=1 TO 73
4870 READ D,P
4880 SOUND 49,P*4,D*15,15
4890 SOUND 42,P,D*14,,2
4900 SOUND 28,P/2,D*14,,4
4910 NEXT I
4920 DATA 2,106,1,80,1,84,2,80,2,106,2,71,2,106,2,67,2,80,2,60,2,80,2,53,2,80,2,50,2,80,1,84,1,80,1,71,1,84,2,106,1,53,1,60,1,63,1,60,1,53,1,63,1,80,1,71,1,63,1,80,2,89,1,100,1,106,2,100,1,60,1,67,1,71,1,67,1,60
4930 DATA 1,71,1,89,1,80,1,71,1,89,2,100,1,106,1,119,2,106,1,67,1,71,1,80,1,71,1,67,1,80,1,100,1,89,1,80,1,100,2,106,1,119,1,134,2,119,2,100,2,106,2,80,1,84,1,80,1,71,1,84,2,84,1,80,1,84,3,80,3
4940 RETURN
4950 '
4960 'controle les cubes du jeu et le cube choisi
4970 '
4980 X=290:Y=50:MOVE X,Y
4990 IF TEST(X,Y)=1 THEN Z=1
5000 IF TEST(X,Y)=2 THEN Z=2
5010 IF TEST(X,Y)=3 THEN Z=3
5020 IF TEST(X,Y)=4 THEN Z=4
5030 IF TEST(X,Y)=8 THEN Z=8
5040 IF TEST(X,Y)=13 THEN Z=13
5050 IF F=2 THEN 5090
5060 X1=228:X2=482
5070 Y=306:NL=3
5080 GOTO 5100
5090 Y=338:X1=290:X2=548:NL=5
5100 FOR I=1 TO NL
5110 FOR X=X1 TO X2 STEP 64
5120 MOVE X,Y
5130 IF TEST(X,Y)<>Z THEN 5210
5140 NEXT X
5150 X1=X1-64:X2=X2-64:Y=Y-32
5160 NEXT I
5170 GOTO 5250
5180 '
5190 'couleurs incorrectes la partie continue
5200 '
5210 PEN 12:LOCATE 8,24:PRINT "REJOUEZ":GOSUB 2250:PEN 0:FOR X=8 TO 14:LOCATE X,24:PRINT CHR$(143):NEXT X:GOTO 3240
5220 '
5230 'partie gagn{e
5240 '
5250 MODE 1:INK 1,7:INK O,9:FOR I=1 TO 10:ENT 1,30,30,5:SOUND 1,20,10,15,0,1:NEXT:PEN 1:LOCATE 5,2:PRINT "J'ai effectu{ ";M;" permutations":LOCATE 4,4:PRINT "Vous deviez r{ussir en ";CJ;" coups":LOCATE 10,7:PRINT "VOTRE SCORE EST DE";SC
5260 LOCATE 9,10:PRINT "TOUTES MES FELICITATIONS":IF F=2 THEN 5270 ELSE LOCATE 3,14:PRINT "Mais si vous voulez }tre un Champion":LOCATE 11,16:PRINT "essayez le niveau 2":GOSUB 4820:GOTO 5280
5270 LOCATE 11,14:PRINT "C'est un vrai plaisir de jouer":LOCATE 6,16:PRINT "avec quelqu'un d'aussi fort":GOSUB 4820
5280 LOCATE 1,24:PRINT "Nouvelle partie   O/N"
5290 T$=UPPER$(INKEY$):IF T$="" THEN 5290
5300 IF T$="N" THEN 5380
5310 IF T$="O" THEN 5330
5320 GOTO 5290
5330 OP=0:P=0:M=0:SC=0:CJ=0:X=0:Y=0:L=0:C=O:NL=0:Z=0:F=0:A=0:B=0:A1=0:B1=0:ya=0:xa=0:BORDER 13:INK 0,13:OP=INT(RND*4)+1:GOTO 1310
5340 GOTO 5290
5350 '
5360 'fin de partie
5370 '
5380 MODE 0:BORDER 13:INK 0,13:A$="AU  REVOIR":LOCATE 6,12
5390 FOR I=1 TO LEN(A$)
5400 PEN I:PRINT MID$(A$,I,1);
5410 NEXT:FOR J=1 TO 2:FOR N=100 TO 800 STEP 5:SOUND 1,N,2,15:NEXT:NEXT:MODE 1:INK 1,0:PEN 1:END
5420 '
5430 'annulation d'un jeu
5440 '
5450 MODE 1:BORDER 2:INK 0,2:INK 1,15:PEN 1:FOR N=1 TO 100 STEP 10:SOUND 1,N,2,15:NEXT
5460 LOCATE 7,6:PRINT "Vous n'allez pas abandonner":LOCATE 5,10:PRINT "je commencais @ bien m'amuser !":LOCATE 12,14:PRINT "ON EN REFAIT UNE ?":GOTO 5280
5470 '
5480 'affichage r{sultat partie perdue
5490 '
5500 MODE 1:INK 0,7:BORDER 7:INK 1,25:LOCATE 1,4:PEN 1:PRINT " D{sol{, je ne suis pas facile @ battre":LOCATE 10,9:PRINT "Vous avez jou{";SC;"fois":LOCATE 5,12:PRINT "Vous deviez r{ussir en";CJ;"coups"
5510 LOCATE 9,18:PRINT "PAS TERRIBLE LE RESULTAT":GOTO 5280