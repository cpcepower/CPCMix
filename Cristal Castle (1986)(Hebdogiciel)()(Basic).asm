10 REM *******************
20 REM * CRISTAL  CASTLE *
30 REM *    LISTING 2    *
90 REM *******************
100 ON BREAK GOSUB 3220
110 REM****************
120 REM*** OPTIONS ***
130 REM****************
140 DIM S(10):DIM P$(10)
150 R=1:XC=10:TA=1:VIE=2:TP=15:SC=0:MODE 0:INK 0,0:INK 1,1:INK 2,24:INK 3,6:INK 4,2:INK 5,4:INK 6,7:INK 7,8:INK 8,9:INK 9,15:INK 10,10:INK 11,11:INK 12,16:INK 13,26:INK 14,3,24:INK 15,24,3:BORDER 0:PAPER 0:CLS
160 P$(1)="LE PROGRAMMEUR":P$(2)="GUGUS":P$(3)="JEAN":P$(4)="FRANCOIS":P$(5)="ERIC":P$(6)="PAUL":P$(7)="PIERRE":P$(8)="SYLVAIN":P$(9)="DAVID":P$(10)="DOMINIQUE"
170 KEY 139,"MODE 1:PEN 2:PAPER 0:CLS"+CHR$(13):SYMBOL AFTER 97
180 SYMBOL 165,0,0,132,254,132,0,0,0
190 SYMBOL 166,15,63,63,103,195,195,195,231
200 SYMBOL 167,248,252,252,230,195,195,195,231
210 SYMBOL 168,255,254,254,95,101,50,31,15
220 SYMBOL 169,255,127,127,253,42,86,252,248
230 SYMBOL 170,24,60,60,60,126,255,255,24
240 SYMBOL 171,24,255,66,66,36,24,24,24
250 SYMBOL 172,160,144,72,36,18,9,5,3
260 SYMBOL 174,56,125,226,193,192,192,192,192
270 SYMBOL 173,64,64,224,160,240,208,96,64
280 SYMBOL 175,192,192,192,132,193,184,125,56
290 SYMBOL 176,124,66,65,65,65,65,126,68
300 SYMBOL 177,72,68,66,66,66,66,130,130
310 SYMBOL 178,4,56,80,16,16,16,16,16
320 SYMBOL 179,16,16,16,16,16,80,180,24
330 SYMBOL 180,29,50,97,96,96,48,24,12
340 SYMBOL 181,4,2,3,131,67,99,182,28
350 SYMBOL 182,16,16,16,16,16,16,16,32
360 SYMBOL 183,24,36,36,66,66,66,66,126
370 SYMBOL 184,126,66,66,66,66,66,66,129
380 SYMBOL 185,128,64,96,96,96,96,96,96
390 SYMBOL 186,96,96,96,96,96,99,254,124
400 SYMBOL 187,128,66,126,98,96,96,100,124
410 SYMBOL 188,124,100,96,96,96,126,130
420 SPEED INK 20,20:X=4:FOR I=1 TO 14:READ A:PEN 14:LOCATE X,2:PRINT CHR$(A);:X=X+1:NEXT I:PEN 15:X=4:FOR U=1 TO 14:READ B:LOCATE X,3:PRINT CHR$(B);:X=X+1:NEXT U
430 DATA 174,176,178,180,178,183,185,32,174,183,180,178,185,187
440 DATA 175,177,179,181,182,184,186,32,175,184,181,182,186,188
450 PEN 13:LOCATE 1,2:A$=CHR$(166)+CHR$(167):B$=CHR$(168)+CHR$(169):PRINT A$;:LOCATE 19,2:PRINT A$;:LOCATE 1,3:PRINT B$;:LOCATE 19,3:PRINT B$;
460 PEN 4:LOCATE 4,10:PRINT "PRESSEZ ";:PEN 6:LOCATE 6,12:PRINT "[1] JEU";:PEN 7:LOCATE 6,14:PRINT "[2] REGLES";
470 PEN 3:LOCATE 3,20:PRINT "BONNE";:PEN 9:PRINT "CHANCE !!!";
480 PEN 12:LOCATE 7,23:INPUT "1 OU 2 ";C
490 IF C<1 OR C>3 THEN GOTO 480
500 IF C=1 THEN R=1:GOTO 2380
510 IF C=2 THEN SYMBOL AFTER 32: GOTO 910
520 SYMBOL 189,120,88,83,79,127,240,240,128
530 REM *********************
540 REM *                   *
550 REM *  T R A C E  D E S *
560 REM *                   *
570 REM *  T A B L E A U X  *
580 REM *                   *
590 REM *    ( DE 1 A 9 )   *
600 REM *********************
610 REM ** TRACE T1 **
620 SYMBOL 192,0,0,0,0,0,225,225,255
630 SYMBOL 193,0,0,136,80,32,80,136,0
640 SYMBOL 194,0,39,132,132,100,20,20,227
650 SYMBOL 191,0,0,16,56,60,124,60,24
660 SYMBOL 195,34,85,85,86,85,85,85,37
670 SYMBOL 196,48,64,64,68,96,68,64,48
680 SYMBOL 197,16,56,84,84,16,16,16,16
690 SYMBOL 198,16,16,16,16,16,16,16,16
700 SYMBOL 199,24,60,126,66,106,82,66,60
710 SYMBOL 200,60,36,66,169,145,137,129,126
720 SYMBOL 201,60,60,36,36,36,36,36,231
730 SYMBOL 202,16,56,56,120,208,144,16,16
740 SYMBOL 203,1,2,4,8,208,96,112,144
750 SYMBOL 204,128,64,32,16,3,7,6,5
760 SYMBOL 205,60,44,44,36,60,24,24,28
770 SYMBOL 206,0,0,0,65,255,65,0,0
780 SYMBOL 207,62,65,85,73,65,65,79,33
790 SYMBOL 208,33,73,65,65,65,65,65,62
800 SYMBOL 211,5,5,18,36,72,144,160,192
810 SYMBOL 212,10,5,26,20,14,11,5,6
820 SYMBOL 213,126,255,165,215,231,243,235,126
830 SYMBOL 209,102,122,118,106,94,98,60,24
840 SYMBOL 210,62,73,79,79,127,119,62,42
850 SYMBOL 216,16,56,171,125,255,255,255,255
860 SYMBOL 217,32,112,240,248,252,253,255,255
870 SYMBOL 218,16,56,124,126,126,255,255,255
880 SYMBOL 219,55,124,116,118,119,126,124,56
890 SYMBOL 220,13,18,57,124,125,124,124,56
900 SYMBOL 221,8,28,62,127,127,65,34,28
910 SYMBOL 222,102,187,19,18,18,18,52,114
920 SYMBOL 223,18,18,18,18,18,146,91,102
930 IF C=1 THEN 950
940 GOTO 2370
950 INK 5,3:PAPER 1:CLS:PAPER 5:PEN 0
960 SYMBOL 242,8,8,8,8,8,8,8,255
970 SYMBOL 243,0,0,0,0,0,0,0,255
980 IF C=2 THEN GOTO 2290
990 C=0
1000 FOR BX=1 TO 20 STEP 2
1010 FOR BY=18 TO 24
1020 B1$=CHR$(242):B2$=CHR$(243)
1030 LOCATE BX,BY
1040 IF BY/2<>INT(BY/2) THEN 1070
1050 PRINT B1$;B2$;
1060 GOTO 1080
1070 PRINT B2$;B1$;
1080 NEXT
1090 NEXT
1100 PAPER 1
1110 XPIE$=CHR$(216)+CHR$(217)+CHR$(218)
1120 PAPER 5:FOR i=1 TO 18 STEP 3:LOCATE i,25:PEN 10:PRINT XPIE$;:NEXT i:LOCATE 19,25:PRINT CHR$(216)+CHR$(217);:PEN 2
1130 WINDOW #1,1,20,1,7:PAPER #1,0:CLS#1:PEN#1,3:LOCATE#1,10,4:PRINT#1,STRING$(10,CHR$(143));CHR$(133);:LOCATE#1,10,3:PRINT#1,STRING$(10,CHR$(192));:LOCATE#1,19,3:PRINT#1,CHR$(138);CHR$(133);
1140 LOCATE#1,19,2:PRINT#1,CHR$(138);CHR$(133);:LOCATE#1,19,1:PRINT#1,CHR$(214);CHR$(215);:PEN#1,4:LOCATE#1,XC,2:PRINT#1,CHR$(193);:LOCATE#1,1,7:PEN#1,7:PEN#1,4:LOCATE#1,10,7:PRINT#1,"tableau:";USING"#";TA;
1150 PEN 10:PAPER 1:FOR MC=10 TO 17:LOCATE 19,MC:PRINT CHR$(133);:NEXT MC:LOCATE 17,10:PRINT CHR$(135);CHR$(131);:PEN 2:LOCATE 17,11:PRINT CHR$(171);:LOCATE 17,12:PRINT CHR$(170);
1160 PEN 9:LOCATE 15,8:PRINT "SUPER";:LOCATE 15,9:PRINT "BONUS";:ORIGIN 545,228:DRAW 0,-100,5
1170 GOTO 1620
1180 TA=2:C=1:TP=15:REM ** TRACE T2 ***
1190 WINDOW #2,1,20,8,25:PAPER #2,1:CLS #2:PEN #1,4:LOCATE #1,10,7:PRINT #1,"tableau:";USING "#";TA;:PAPER 5:PEN 0:IF TA=2 THEN SC=SC+100
1200 FOR BX=1 TO 20 STEP 2:FOR BY=20 TO 25
1210 LOCATE BX,BY
1220 IF BY/2<>INT(BY/2) THEN 1250
1230 PRINT B1$;B2$;
1240 GOTO 1260
1250 PRINT B2$;B1$;
1260 NEXT
1270 NEXT
1280 PAPER 5:FOR I=1 TO 18 STEP 3:LOCATE I,25:PEN 10:PRINT XPIE$;:NEXT I:LOCATE 19,25:PRINT CHR$(216)+CHR$(217);:PEN 2
1290 PEN 10:PAPER 1:FOR MC=10 TO 19:LOCATE 19,MC:PRINT CHR$(133);:NEXT MC:LOCATE 17,10:PRINT CHR$(135);CHR$(131);:PEN 2:LOCATE 17,11:PRINT CHR$(171);:LOCATE 17,12:PRINT CHR$(170);
1300 ORIGIN 545,238:DRAW 0,-100,5:PEN 9:LOCATE 15,8:PRINT "SUPER";:LOCATE 15,9:PRINT "BONUS";
1310 PAPER 5:PEN 0:FOR BO=1 TO 20 STEP 4:LOCATE BO,18:PRINT B1$;B2$;:LOCATE BO,19:PRINT B2$;B1$;:NEXT
1320 XC=XC+1:PAPER 0:PEN 4:LOCATE XC,2:PRINT CHR$(193);:LOCATE XC-1,2:PRINT " ";
1330 GOTO 1620
1340 TA=3:C=0:TP=15:REM ** TRACE T3 **
1350 PAPER #2,1:CLS #2:XC=XC+1:PAPER 0:PEN #1,4:LOCATE #1,10,7:PRINT #1,"tableau:";USING "#";TA;:PEN 4:LOCATE XC,2:PRINT CHR$(193);:LOCATE XC-1,2:PRINT " ";:PAPER 5:PEN 0
1360 FOR BX=1 TO 20 STEP 2:FOR BY=18 TO 24
1370 LOCATE BX,BY
1380 IF BY/2<>INT(BY/2) THEN 1420
1390 PRINT B1$;B2$;
1400 GOTO 1430
1410 PAPER 1:PEN 9:LOCATE 15,8:PRINT "SUPER";:LOCATE 15,9:PRINT "BONUS";:ORIGIN 545,238:DRAW 0,-100,5:IF TA=5 THEN 1610
1420 PRINT B2$;B1$;
1430 NEXT
1440 NEXT
1450 PAPER 5:FOR i=1 TO 18 STEP 3:LOCATE i,25:PEN 10:PRINT XPIE$;:NEXT I:LOCATE 19,25:PRINT CHR$(216);CHR$(217);:PEN 2
1460 PEN 10:PAPER 1:FOR MC=10 TO 17:LOCATE 19,MC:PRINT CHR$(133);:NEXT MC:LOCATE 17,10:PRINT CHR$(135);CHR$(131);:PEN 2:LOCATE 17,11:PRINT CHR$(171);:LOCATE 17,12:PRINT CHR$(170);
1470 PEN 9:LOCATE 15,8:PRINT "SUPER";:LOCATE 15,9:PRINT "BONUS";:ORIGIN 545,238:DRAW 0,-100,5:ON TA GOTO 1,1,1620,1,1620,1,1620,1,1620
1480 LOCATE BX,BY
1490 TA=4:REM ** TRACE T4 **
1500 C=1:TP=15:GOTO 1190
1510 TA=5:REM ** TRACE T5 **
1520 C=0:TP=15:GOTO 1350
1530 TA=6:REM ** TRACE T6 **
1540 C=1:TP=15:GOTO 1190
1550 TA=7:REM ** TRACE T7 **
1560 C=0:TP=15:GOTO 1350
1570 TA=8:REM ** TRACE T8 **
1580 C=1:TP=15:GOTO 1190
1590 TA=9:REM ** TRACE T9 **
1600 C=0:TP=15:GOTO 1350
1610 REM ** INITIALISATION **
1620 A=5:B=17:XF=1:YF=17:XZ=15:YZ=17:K=INT(RND*13)+7:TD$=CHR$(219):CD$=CHR$(205):CSD$=CHR$(189):BD$=CHR$(173):F$=CHR$(165):Z$=CHR$(206)
1630 IF TA=1 THEN GOTO 1660
1640 IF TA=2 THEN GOTO 1790
1650 IF TA=4 THEN GOTO 1660
1660 PEN 10:PAPER 1:CALL &BD19:XF=XF+1:XZ=XZ-1:LOCATE XF,YF:PRINT F$;:LOCATE XZ,YZ:PRINT Z$;:LOCATE XF-1,YF:PRINT " ":LOCATE XZ+1,YZ:PRINT " ":LOCATE 2,YZ:PRINT " ":LOCATE 16,YF:PRINT " ":FOR i=1 TO 100:NEXT:IF XF=A OR XZ=A THEN GOTO 2110
1670 IF XF>=16 THEN XF=1
1680 IF XZ<=2 THEN XZ=14
1690 IF TA=1 THEN GOTO 1790
1700 IF TA=2 THEN GOTO 1790
1710 IF TA=4 THEN GOTO 1790
1720 IF TA=6 THEN GOTO 1790
1730 IF TA=8 THEN GOTO 1790
1740 IF K>14 THEN K=INT(RND*13)+7
1750 LOCATE K,17:PEN 3:PRINT CHR$(220);
1760 IF K=A THEN SOUND 1,478,10,6:GOTO 2130
1770 IF J=A THEN SOUND 1 478,10,6:GOTO 2130
1780 IF H=A THEN SOUND 1,248,10,5:SC=SC+TA*2:LOCATE H,17:PRINT " "
1790 IF INKEY(76)=0 OR INKEY(77)=0 OR INKEY(9)=0 THEN GOSUB 1940
1800 IF INKEY(75)=0 OR INKEY(1)=0 THEN GOSUB 1990
1810 LOCATE #1,1,7:PAPER #1,0:PEN #1,7:PRINT #1,"vie:";USING "#";VIE;:LOCATE #1,1,1:PEN #1,2:PRINT #1,CHR$(194)+CHR$(195)+CHR$(196);USING "####";SC;:LOCATE #1,1,4:PEN #1,12:PRINT #1,"temps:";USING "##";TP;:IF TP=0 THEN GOTO 2110
1820 TP=TP-1:PEN 4:PAPER 1:LOCATE A,B:PRINT CD$;:PEN 12:LOCATE A,B-1:PRINT TD$;:LOCATE A+1,B:PRINT " ";:LOCATE A+1,B-1:PRINT " ";:LOCATE A-1,B:PRINT " ";:LOCATE A-1,B-1:PRINT " ";:IF XF=A THEN GOTO 2110
1830 IF XZ=A THEN GOTO 2110
1840 IF C=1 AND A=3 THEN GOTO 2110
1850 IF C=1 AND A=4 THEN GOTO 2110
1860 IF C=1 AND A=7 THEN GOTO 2110
1870 IF C=1 AND A=8 THEN GOTO 2110
1880 IF C=1 AND A=11 THEN GOTO 2110
1890 IF C=1 AND A=12 THEN GOTO 2110
1900 IF C=1 AND A=15 THEN GOTO 2110
1910 IF C=1 AND A=16 THEN GOTO 2110
1920 IF TA=2 THEN GOTO 1790
1930 GOTO 1660
1940 SC=SC+1:A=A+3:G=B-2:LOCATE A,B-1:PEN 4:PRINT CSD$;:LOCATE A,G:PEN 12:PRINT TD$;:LOCATE A-3,B:PRINT " ";:LOCATE A-3,B-1:PRINT " ";:FOR T=1 TO 100:NEXT:LOCATE A,B-2:PRINT " ":PRINT " ";:LOCATE A-1,B-2:PRINT " ";
1950 IF XZ=A THEN GOTO 2110
1960 IF XF=A THEN GOTO 2110
1970 IF TP=0 THEN GOTO 2110
1980 FOR I=1 TO 100:NEXT:GOTO 2000
1990 SC=SC+1:A=A+1:LOCATE A,B:PEN 4:PRINT CD$;:LOCATE A,B-1:PEN 12:PRINT TD$;:LOCATE A-1,B:PRINT " ";:LOCATE A-1,B-1:PRINT " ";
2000 IF A>16 AND TA=2 THEN SC=SC+100:GOTO 1340
2010 IF A>16 AND TA=1 THEN GOTO 1180
2020 IF A>16 AND TA=3 THEN SC=SC+100:GOTO 1490
2030 IF A>16 AND TA=4 THEN SC=SC+200:GOTO 1510
2040 IF A>16 AND TA=5 THEN SC=SC+100:GOTO 1530
2050 IF A>16 AND TA=6 THEN SC=SC+100:GOTO 1550
2060 IF A>16 AND TA=7 THEN SC=SC+100:GOTO 1570
2070 IF A>16 AND TA=8 THEN SC=SC+200:GOTO 1590
2080 IF A>16 AND TA=9 THEN SC=SC+500:GOTO 3280
2090 FOR Y=1 TO 100:NEXT:RETURN:IF TP=0 THEN GOTO 2110
2100 REM ************
2110 REM ** -1 VIE **
2120 REM ************
2130 SOUND 1,478,20,7:TP=15:VIE=VIE-1:LOCATE A,B:PRINT " ";:LOCATE A,B-1:PRINT " ";:IF VIE=0 THEN GOTO 2160
2140 LOCATE XF,YF:PRINT " ":LOCATE XZ,YZ:PRINT " ":LOCATE K,17:PRINT " ":GOTO 1620
2150 REM **********
2160 REM ** MORT **
2170 REM **********
2180 LOCATE #1,1,7:PAPER #1,0:PEN #1,7:PRINT #1,"vie:";USING "#";VIE;:LOCATE A,B:PEN 13:PRINT CHR$(210);:LOCATE A,B-1:PRINT " ";
2190 FOR D=1 TO 21
2200 READ R,T,Y,U
2210 SOUND R,T,Y,U
2220 NEXT D
2230 DATA 1,500,100,15,1,0,2,0,1,500,75,15,1,0,2,0,1,500,25,15,1,0,2,0,1,500,100,15,1,0,2,0,1,425,75,15,1,0,2,0,1,450,25,15,1,0,2,0,1,450,75,15,1,0,2,0,1,500,25,15,1,0,2,0,1,500,75,15,1,0,2,0,1,525,25,15,1,0,2,0,1,500,100,15
2240 FOR Y=1 TO 1500:NEXT Y
2250 ORIGIN 320,-100
2260 FOR X=-1000 TO 0 STEP 5
2270 MOVE 0,0
2280 DRAW X,300,0:DRAW 0,600,0
2290 MOVE 0,0
2300 DRAW -X,300,0:DRAW 0,600,0
2310 NEXT X
2320 PRINT CHR$(22)+CHR$(1);:PEN 13:PAPER 0:LOCATE 7,12:PRINT "PERDU !!!";:PEN 3:LOCATE 3,2:PRINT "VOTRE SCORE:";SC;:FOR D=1 TO 6000:NEXT:IF SC>S(10) THEN GOTO 2860:PRINT CHR$(22)+CHR$(0);:PEN 4:IF SC<S(10) THEN CLS:FOR D=1 TO 6000:NEXT:GOTO 3040
2330 REM ***************
2340 REM *  REGLES DU  *
2350 REM *     JEU     *
2360 REM ***************
2370 R=0
2380 MODE 0:PAPER 0:BORDER 0:PEN 9:CLS:KEY 138,"SYMBOL AFTER 97"+CHR$(13)
2390 SYMBOL 97,48,88,70,36,116,204,79,58
2400 SYMBOL 98,96,32,32,44,50,34,118,28
2410 SYMBOL 99,24,52,96,96,96,96,164,24
2420 SYMBOL 100,4,4,52,76,196,196,108,52
2430 SYMBOL 101,24,60,100,104,112,86,36,24
2440 SYMBOL 102,12,22,16,56,16,16,42,4
2450 SYMBOL 103,13,22,34,55,29,1,49,30
2460 SYMBOL 104,96,32,40,53,38,34,34,34:SYMBOL 105,24,0,28,8,8,8,26,44
2470 SYMBOL 106,4,0,4,4,4,36,44,24
2480 SYMBOL 107,32,32,44,54,34,36,44,98
2490 SYMBOL 108,16,16,16,16,16,16,26,12
2500 SYMBOL 109,0,0,84,170,42,42,42,42
2510 SYMBOL 110,0,80,168,40,40,40,42,36
2520 SYMBOL 111,29,46,70,70,66,98,180,24
2530 SYMBOL 112,152,108,68,68,232,80,64,64
2540 SYMBOL 113,16,58,108,68,76,52,4,4
2550 SYMBOL 114,0,44,90,16,16,16,16,40
2560 SYMBOL 115,16,56,68,104,48,184,88,176
2570 SYMBOL 116,16,16,56,16,16,16,54,12
2580 SYMBOL 117,68,172,38,36,36,36,54,90
2590 SYMBOL 118,68,170,34,34,34,50,90,12
2600 SYMBOL 119,146,109,73,73,73,73,170,20
2610 SYMBOL 120,40,124,16,16,16,16,90,44
2620 SYMBOL 121,76,166,36,36,26,1,99,62
2630 SYMBOL 122,48,252,8,16,32,64,240,76:SYMBOL 233,24,96,78,26,52,56,35,30
2640 IF R=1 THEN GOTO 520
2650 LOCATE 4,1:PRINT CHR$(222);:LOCATE 4,2:PRINT CHR$(223)+"egles du jeu";
2660 LOCATE 1,4:PEN 2:PRINT "cristal castle est ";:PEN 3:LOCATE 1,6:PRINT " un Jeu d'adresse ";:PEN 2:LOCATE 1,8:PRINT "& d'arcade rapide";:PEN 3:LOCATE 1,10:PRINT "le roi vous a donné ";:PEN 2:LOCATE 1,12:PRINT " une mission :";:LOCATE 1,14:PEN 3
2670 PRINT "rapporter le cris-":PEN 2:LOCATE 1,16:PRINT "tal qui est enferme  ";:PEN 3:LOCATE 1,19:PRINT "dans le chateau mau-";:PEN 2:LOCATE 1,21:PRINT "dit.attention !!! ";:PEN 3:LOCATE 1,23:PRINT " si votre mission ";:GOSUB 4040:PEN 4:LOCATE 6,25
2680 PRINT "[ESPACE]"
2690 IF INKEY(47)=0 THEN 2710
2700 GOTO 2690
2710 CLS:PEN 2
2720 LOCATE 1,1:PEN 3:PRINT "echoue (2 vie)";:PEN 2:LOCATE 1,3:PRINT "votre roi ne sera ";:PEN 3:LOCATE 1,5:PRINT "plus assis sur le ";:PEN 2:LOCATE 1,7:PRINT "trone de votre pays";:PEN 3:LOCATE 1,9:PRINT " car igor detiendra";:PEN 2:LOCATE 1,11
2730 PEN 2:PRINT "tous les pouvoirs du";:PEN 3:LOCATE 1,13:PRINT "cristal et ";:PEN 2:LOCATE 1,15:PRINT "deviendra roi a son ";:PEN 3:LOCATE 1,17:PRINT "tour.vous devrez ";
2740 PEN 2:LOCATE 1,19:PRINT "pour cela passer les";:PEN 3:LOCATE 1,21:PRINT "9 tableaux qui comp-";:PEN 2:LOCATE 1,23:PRINT "osent ce Jeu.ensuite";
2750 GOSUB 4040:PEN 4:LOCATE 6,25:PRINT "[ESPACE]";
2760 IF INKEY(47)=0 THEN 2780
2770 GOTO 2760
2780 CLS:PEN 2
2790 LOCATE 1,1:PRINT "vous devrez decou-";:PEN 3:LOCATE 1,3:PRINT "vrir le code pour";:PEN 2:LOCATE 1,5:PRINT "ouvrir le coffre ";:PEN 3:LOCATE 1,7:PRINT " qui renferme le  ";:PEN 2:LOCATE 1,9:PRINT "precieux cristal.";
2800 LOCATE 1,11:PEN 7:PRINT "ATTENTION !!!!";:PEN 6:LOCATE 1,13:PRINT "VOUS NE POUVEZ VOUS";:PEN 5:LOCATE 1,15:PRINT "DEPLACER QUE VERS";:PEN 8:LOCATE 1,17:PRINT "LA DROITE AVEC";:PEN 3:LOCATE 1,18:PRINT "LA MANETTE OU LA ";:PEN 7:LOCATE 1,21
2810 PRINT "TOUCHE ";:PEN 2:PRINT CHR$(243);:LOCATE 1,23:PEN 13:PRINT "COPY";:PEN 3:PRINT "-";:PEN 13:PRINT "FIRE";:PEN 7:PRINT ":SAUTER";
2820 GOSUB 4040:PEN 4:LOCATE 6,25:PRINT "[ESPACE]";
2830 IF INKEY(47)=0 THEN 2850
2840 GOTO 2830
2850 CLS:PEN 3:LOCATE 4,12:PRINT "BONNE CHANCE !!!";:FOR X=1 TO 1000:NEXT:CLS:RESTORE 420:GOTO 170
2860 REM *********************
2870 REM * TABLE DES SCORES *
2880 REM *********************
2890 BORDER 0:PAPER 0:CLS
2900 PRINT CHR$(22)+CHR$(0);:LOCATE 2,10:PRINT "QUEL EST VOTRE NOM";
2910 INPUT J$
2920 L=LEN(J$):IF L>10 THEN GOTO 2910
2930 CLS
2940 IF SC>S(1) THEN S(1)=SC:P$(1)=J$
2950 IF SC>S(2) AND SC<S(1) THEN S(2)=SC:P$(2)=J$
2960 IF SC>S(3) AND SC<S(2) THEN S(3)=SC:P$(3)=J$
2970 IF SC>S(4) AND SC<S(3) THEN S(4)=SC:P$(4)=J$
2980 IF SC>S(5) AND SC<S(4) THEN S(5)=SC:P$(5)=J$
2990 IF SC>S(6) AND SC<S(5) THEN S(6)=SC:P$(6)=J$
3000 IF SC>S(7) AND SC<S(6) THEN S(7)=SC:P$(7)=J$
3010 IF SC>S(8) AND SC<S(7) THEN S(8)=SC:P$(8)=J$
3020 IF SC>S(9) AND SC<S(8) THEN S(9)=SC:P$(9)=J$
3030 IF SC>S(10) AND SC<S(9) THEN SC(10)=SC:P$(10)=J$
3040 LOCATE 2,1:PEN 3:PRINT "TABLE DES SCORES";:PEN 2:FOR U=1 TO 10:LOCATE 1,U+3:PRINT U;:NEXT
3050 LOCATE 4,4:PEN 7:PRINT P$(1);:LOCATE 15,4:PEN 2:PRINT S(1);
3060 LOCATE 4,5:PEN 7:PRINT P$(2);:LOCATE 15,5:PEN 2:PRINT S(2);
3070 LOCATE 4,6:PEN 7:PRINT P$(3);:LOCATE 15,6:PEN 2:PRINT S(3);
3080 LOCATE 4,7:PEN 7:PRINT P$(4);:LOCATE 15,7:PEN 2:PRINT S(4);
3090 LOCATE 4,8:PEN 7:PRINT P$(S);:LOCATE 15,8:PEN 2:PRINT S(5);
3100 LOCATE 4,9:PEN 7:PRINT P$(6);:LOCATE 15,9:PEN 2:PRINT S(6);
3110 LOCATE 5,10:PEN 7:PRINT P$(7);:LOCATE 15,10:PEN 2:PRINT S(7);
3120 LOCATE 4,11:PEN 7:PRINT P$(8);:LOCATE 15,11:PEN 2:PRINT S(8);
3130 LOCATE 4,12:PEN 7:PRINT P$(9);:LOCATE 15,12:PEN 2:PRINT S(9);
3140 LOCATE 4,13:PEN 7:PRINT P$(10);:LOCATE 15,13:PEN 2:PRINT S(10);
3150 LOCATE 4,23:PEN 14:PRINT "cristal castle";
3160 LOCATE 6,20:PEN 7:PRINT "[ESPACE]";
3170 IF INKEY(47)=0 THEN RESTORE:TA=1:XC=10:SC=0:TP=30:VIE=2:X8=2:Y8=17:CLS:GOTO 150
3180 GOTO 3160
3190 REM *******************
3200 REM *    ON BREAK     *
3210 REM *******************
3220 MODE 1:INK 0,0:PAPER 0:INK 1,24:INK 2,6:INK 3,2:INK 4,26:PAPER 0:PEN 1:BORDER 0:CLS:SOUND 1,478,50,5
3230 LOCATE 1,1:PRINT "ARRET DE CRISTAL CASTLE";
3240 LOCATE 1,2:PEN 2:PRINT "OCTETS RESTANTS:";FRE(0);
3250 LOCATE 1,3:PEN 3:PRINT "MEMOIRE:";:PRINT HIMEM;,
3260 LOCATE 1,4:SOUND 0,0,0,0,0:PEN 1:PRINT "BASIC PRET !!!"
3270 END
3280 PP=0
3290 REM ******************
3300 REM * TABLEAU FINAL *
3310 REM ******************
3320 T=12
3330 A=1
3340 RESTORE 3410
3350 KEY DEF 66,0,32,32,32
3360 WHILE A<>0 AND NOT brk
3370 READ A,B,C
3380 SOUND A,B,INT(T*C*0.833389282),6
3390 WEND
3400 KEY DEF 66,0,252,252,252
3410 DATA 17,190,1,10,239,1,49,179,2,42,213,2,28,239,2,49,159,4,42,190,4,28,239,4,49,159,2,42,190,2,28,239,2,49,142,2,42,179,2,28,239,2,49,159,2,42,190,2,28,239,2,49,142,2,42,179,2
3420 DATA 28,239,2,49,134,2,42,159,2,28,201,2,17,159,1,10,201,1,49,150,1,42,179,1,28,201,1,49,134,4,42,159,4,28,201,4,49,134,2,42,159,2,28,201,2,49,119,2,42,150,2,28,201,2,49,134,2,42,159,2
3430 DATA 28,201,2,49,119,2,42,150,2,28,201,2,49,113,4,42,134,4,28,169,4,49,113,1,42,134,1,28,169,1,49,134,1,42,169,1,28,239,1,49,113,2,42,134,2,28,169,2,49,106,4,42,134,4,28,179,4
3440 DATA 49,106,1,42,134,1,28,179,1,49,134,1,42,179,1,28,213,1,49,106,2,42,134,2,28,179,2,49,106,4,42,127,4,28,159,4,49,106,1,42,127,1,28,159,1,49,127,1,42,159,1,28,213,1
3450 DATA 49,106,2,42,127,2,28,159,2,49,100,4,42,127,4,28,169,4,49,100,1,42,127,4,28,163,4,49,127,1,42,169,1,28,201,1,49,100,2,42,127,2,28,169,2,49,95,10,42,127,10,28,150,10,0,0,0
3460 IF PP=1 THEN GOTO 3860
3470 MODE 0:PAPER 0:BORDER 0:INK 5,3:SYMBOL AFTER 32:CLS
3480 SYMBOL 190,8,20,54,65,113,54,20,8
3490 SYMBOL 191,0,0,16,56,60,124,60,24
3500 SYMBOL 211,5,9,18,36,72,144,160,192
3510 SYMBOL 212,10,5,22,20,14,11,5,6
3520 SYMBOL 172,160,144,72,36,18,9,5,3
3530 SYMBOL 173,64,64,224,160,240,208,96,64
3540 WINDOW#2,8,20,1,5:PAPER#2,3:CLS#2
3550 WINDOW#3,1,7,1,5:PAPER#3,12:CLS#3
3560 WINDOW#4,1,20,23,25:PAPER#4,4:CLS#4
3570 INK 11,24,6:LOCATE 2,10:PEN 10:PRINT CHR$(211);
3580 LOCATE 2,9:PEN 11:PRINT CHR$(212);
3590 LOCATE 18,10:PEN 10:PRINT CHR$(172);
3600 LOCATE 18,9:PEN 11:PRINT CHR$(173);
3610 ORIGIN 0,50:DRAW 300,200,4:ORIGIN 0,50:DRAW 0,218:ORIGIN 0,270:DRAW 100,50,4:ORIGIN 639,50:DRAW -300,200,4:ORIGIN 639,50:DRAW 0,218:ORIGIN 639,270:DRAW -100,50,4:ORIGIN 100,120:DRAW 0,200,4:ORIGIN 100,116:DRAW 300,200,0:ORIGIN 100,116:DRAW 430,0,4
3620 ORIGIN 537,116:DRAW -300,200,0:ORIGIN 537,116:DRAW 0,200,4:ORIGIN 537,316:DRAW -430,0,4:WINDOW#5,6,14,15,20:PAPER#5,3:CLS#5
3630 ORIGIN 260,273:FOR T=-100 TO 0:MOVE 0,0:DRAW T,-100,5:NEXT:ORIGIN 350,273:FOR T=100 TO 0 STEP -1:MOVE 0,0:DRAW T,-100,5:NEXT:WINDOW#6,9,11,9,14:PAPER#6,5:CLS#6
3640 LOCATE#6,1,6:PEN#6,2:PRINT#6,CHR$(235);:LOCATE#6,3,6:PRINT#6,CHR$(235);
3650 LOCATE#5,4,1:PEN#5,2:PRINT#5,CHR$(155);:LOCATE#5,6,1:PRINT#5,CHR$(155);
3660 A=INT(RND*10):D=INT(RND*10)
3670 B=INT(RND*10):E=INT(RND*10)
3680 C=INT(RND*10):F=INT(RND*10):G=INT(RND*10)
3690 ESSAIS=0
3700 ESSAIS=ESSAIS+1:PEN #2,2:LOCATE #2,2,2:PRINT #2,"SCORE:";USING "#####";SC;:PEN #3,3:LOCATE #3,1,2:PRINT #3,"ESSAIS:";ESSAIS;:PEN #4,2:FOR T=1 TO 7:LOCATE #4,2,2:PRINT #4,"CHIFFRE NUMERO";T;:INPUT #4,Z(T):NEXT T
3710 LOCATE#5,2,5:PRINT#5,USING"#";Z(1);:PRINT#5,USING"#";Z(2);:PRINT#5,USING"#";Z(3);:PRINT#5,USING"#";Z(4);:PRINT#5,USING"#";Z(5);:PRINT#5,USING"#";Z(6);:PRINT#5,USING"#";Z(7);
3720 IF Z(1)=A THEN LOCATE#5,2,3:PRINT#5,USING"#";A;:SC=SC+10
3730 IF Z(2)=B THEN LOCATE#5,3,3:PRINT#5,USING"#";B;:SC=SC+20
3740 IF Z(3)=C THEN LOCATE#5,4,3:PRINT#5,USING"#";C;:SC=SC+30
3750 IF Z(4)=D THEN LOCATE#5,5,3:PRINT#5,USING"#";D;:SC=SC+40
3760 IF Z(5)=E THEN LOCATE#5,6,3:PRINT#5,USING"#";E;:SC=SC+50
3770 IF Z(6)=F THEN LOCATE#5,7,3:PRINT#5,USING"#";F;:SC=SC+60
3780 IF Z(7)=G THEN LOCATE#5,8,3:PRINT#5,USING"#";G;:SC=SC+70
3790 IF Z(1)=A AND Z(2)=B AND Z(3)=C AND Z(4)=D AND Z(5)=E AND Z(6)=F AND Z(7)=G THEN GOTO 3820
3800 IF ESSAIS=7 THEN GOTO 3930
3810 GOTO 3700
3820 REM ********************
3830 REM * VOUS AVEZ GAGNE  *
3840 REM ********************
3850 PP=1:GOTO 3320
3860 FOR T=1 TO 5000:NEXT:LOCATE #6,2,2:PEN #6,2:PRINT #6,"B":SOUND 1,379,10,6:FOR T=1 TO 1000:NEXT
3870 LOCATE #6,2,2:PRINT #6,"R":SOUND 1,402,10,6:FOR T=1 TO 1000:NEXT
3880 LOCATE #6,2,2:PRINT #6,"A":SOUND 1,426,10,6:FOR T=1 TO 1000:NEXT
3890 LOCATE #6,2,2:PRINT #6,"V":SOUND 1,451,10,6:FOR T=1 TO 1000:NEXT
3900 LOCATE #6,2,2:PRINT #6,"O":SOUND 1,478,10,6:FOR T=1 TO 1000:NEXT
3910 LOCATE #6,2,2:PEN #6,13:PRINT #6,CHR$(190);:SOUND 1,538,10,6:FOR T=1 TO 1000:NEXT
3920 CLS #4:LOCATE #4,1,1:PRINT #4,"VOUS AVEZ GAGNE!! !";:LOCATE #4,1,2:PRINT #4,"AU BOUT DE ";ESSAIS;:PRINT #4," ESSAIS";:LOCATE #2,1,1:PEN #2,2:SC=SC-ESSAIS:LOCATE #2,2,2:PRINT #2,"SCORE:";SC;:FOR Y=1 TO 10000:NEXT:GOTO 2870
3930 REM *******************
3940 REM *    PERDU ! ! !  *
3950 REM *******************
3960 ENV 1,100,1,3
3970 ENT 1,100,5,3
3980 SOUND 4,284,300,1,1,1:ENT 1,100,-2,3:SOUND 3,284,300,1,1,1
3990 CLS #4:LOCATE #4,3,2:PRINT #4,"PERDU !!! ";
4000 ORIGIN 0,0:FOR D=0 TO 639
4010 MOVE D,0:DRAW D,399,0
4020 NEXT
4030 FOR T=1 TO 2000:NEXT T:GOTO 2870
4040 REM *******************
4050 REM *     MUSIQUE     *
4060 REM *******************
4070 ENV 1,10,1,100
4080 RESTORE 4150
4090 FOR I=1 TO 48
4100 READ B,C,D
4110 SOUND 1,B,C,D+10
4120 SOUND 2,B,C+0.125,D+10
4130 NEXT I
4140 RETURN
4150 DATA 758,50,5,568,50,5,758,50,5,568,50,5,506,50,5,478,50,5,426,50,5,379,50,5,426,100,5,478,50,5,506,100,5,536,50,5,506,150,5,378,50,5,506,50,5,379,50,5,506,50,5,478,50,5,426,50,5,379,50,5,426,400,5,478,50,5,506,100,5,536,50,5,506,150,5
4160 DATA 758,50,5,568,50,5,758,50,5,568,50,5,506,50,5,478,50,5,426,50,5,379,50,5
4170 DATA 426,100,5,478,50,5,506,100,5,536,50,5,506,150,5,379,50,5,506,50,5
4180 DATA 379,50,5,506,50,5,478,50,5
4190 DATA 426,50,5,379,50,5,426,100,5,478,50,5
4200 DATA 506,100,5,536,50,5,506,150,5