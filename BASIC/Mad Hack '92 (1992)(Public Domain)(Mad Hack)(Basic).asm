10 REM A MadHack demoscene... ;)
20 BORDER 0: INK 0,0:DEG:mad=0
30 MODE 0:INK 1,6:INK 2,3,6:INK 3,3
40 LOCATE 1,23:PEN 1:PRINT "Loading"; :PEN 2:PRINT " . . .";:PEN 3
50 DIM frq(8)
60 frq(0)=119
70 frq(1)=106
80 frq(2)=95
90 frq(3)=89
100 frq(4)=80
110 frq(5)=71
120 frq(6)=63
130 frq(7)=60
140 DIM seno[360]
150 DIM coseno[360]
160 FOR x=0 TO 359
170 seno[x]=SIN(x)
180 coseno[(x+90) MOD 360]=seno[x]
190 IF 0=(x MOD 18) THEN LOCATE 1+(x / 18),24:PRINT CHR$(143)
200 IF x MOD 3=0 THEN SOUND 1,360-x,13,3+x/40
210 REM SOUND 1,360-x,10,x/36
220 NEXT
230 CLS
240 PEN 1
250 REM Inicio bucle
260 externo=10
270 direccion=1
280 FOR x=7 TO 15
290 INK 1,6:INK x,3*(x MOD 3)
300 NEXT
310 interno=externo
320 externo=externo*2
330 direccion=direccion*(-1)
340 GOSUB 470
350 INK 1,2
360 FOR x=46 TO 1 STEP -1
370 INK 7+(x MOD 9),11
380 INK 7+((x+1) MOD 9),2
390 INK 7+((x+3) MOD 9),1
400 INK 7+((x+5) MOD 9),0
410 SOUND 1,frq(0)+seno[x*360/46]*20,15,8
420 SOUND 2,frq(0)-seno[x*360/46]*20,15,8
430 FOR y=1 TO 10:NEXT
440 GOSUB 590
450 NEXT
460 GOTO 280
470 FOR x=0 TO 359 STEP (2+INT(60/externo))
480 IF NOT INKEY(47)GOTO 660
490 IF interno>200 THEN GOTO 520
500 PLOT 190-direccion*interno*seno[(x+10) MOD 360],200+interno*coseno[(x+10) MOD 360]:DRAW 190-direccion*externo*seno[x],200+externo*coseno[x],7+(x/6.66667) MOD 9
510 PLOT 450+direccion*interno*seno[(x+10) MOD 360],200+interno*coseno[(x+10) MOD 360]:DRAW 450+direccion*externo*seno[x],200+externo*coseno[x],7+(x/6.66667) MOD 9
520 INK 7+(x/3 MOD 9),0
530 INK 7+((x/3+3) MOD 9),3
540 INK 7+((x/3+6) MOD 9),6
550 GOSUB 590
560 SOUND 1,frq(RND*7),5,7
570 NEXT
580 RETURN
590 TAG
600 MOVE 114+112*seno[mad MOD 360],399
610 GRAPHICS PEN 1
620 FRAME:PRINT " MadHack '82 ";
630 mad=mad+4
640 GRAPHICS PEN 0:TAGOFF
650 RETURN
660 FOR x=0 TO 15:BORDER 3*(x MOD 3):INK x,6:NEXT:CLS:BORDER 6
670 DIM cadena(50)
680 FOR x=27 TO 0 STEP -1: BORDER x: FOR y=1 TO 5:NEXT y,x
690 INK 14,0:FOR x=1 TO 25:INK 15,6:PEN 15:LOCATE 1,x:FRAME:PRINT "";:FRAME:INK 15,0:PEN 14:LOCATE 1,x:PRINT "";:NEXT:INK 0,0:CLS
700 PEN 15:INK 15,6
710 tex$="--[ CatHack! ]--":hig=4:GOSUB 1090
720 tex$="pancake":hig=8:GOSUB 1090
730 tex$="salutte":hig=12:GOSUB 1090
740 tex$="kl4rk":hig=16:GOSUB 1090
750 GOTO 760
760 INK 1,1:INK 2,2:INK 3,2:INK 4,11:INK 5,11:INK 6,11:INK 7,11:PRINT CHR$(23);CHR$(3)
770 FOR x=0 TO 359 STEP 1
780 DRAW 320+150*seno[x]+50*seno[(16*x) MOD 360]-75*coseno[x]+25*coseno[(16*x) MOD 360],200 -75*coseno[x]+25*seno[(16*x) MOD 360]-50*coseno[(16*x) MOD 360],SGN(x)
790 SOUND 1,253+126*SGN(x MOD 8),3+3*SGN(x MOD 16),15*(1-SGN(x MOD 4))-15*(1-SGN((x+12) MOD 16)),,,1
800 NEXT
810 FOR x=0 TO 359 STEP 1
820 DRAW 320+150*seno[(x+8) MOD 360]+50*seno[(16*x) MOD 360]-75*coseno[(x+8) MOD 360]+25*coseno[(16*x) MOD 360],200 -75*coseno[(x+8) MOD 360]+25*seno[(16*x) MOD 360]-50*coseno[(16*x) MOD 360],SGN(x)*2
830 SOUND 1,253+126*SGN(x MOD 8),3+3*SGN(x MOD 16),15*(1-SGN(x MOD 4))-15*(1-SGN((x+12) MOD 16)),,,7
840 NEXT
850 FOR x=0 TO 359 STEP 1
860 DRAW 320+150*seno[(x+16) MOD 360]+50*seno[(16*x) MOD 360]-75*coseno[(x+16) MOD 360]+25*coseno[(16*x) MOD 360],200 -75*coseno[(x+16) MOD 360]+25*seno[(16*x) MOD 360]-50*coseno[(16*x) MOD 360],SGN(x)*4
870 SOUND 1,253+126*SGN(x MOD 8),3+3*SGN(x MOD 16),15*(1-SGN(x MOD 4))-15*(1-SGN((x+12) MOD 16)),,,15
880 NEXT 
890 ENV 1,15,-1,3:PRINT CHR$(23);CHR$(0)
900 ON SQ(2) GOSUB 1000
910 CLEAR INPUT:WHILE INKEY$=""
920 x=(x+1) MOD 3
930 FRAME
940 IF x=2 THEN INK 1,1:INK 2,2:INK 4,11:INK 3,2:INK 5,11:INK 6,11
950 IF x=1 THEN INK 1,2:INK 2,11:INK 4,1:INK 3,11:INK 5,2:INK 6,11
960 IF x=0 THEN INK 1,11:INK 2,1:INK 4,2:INK 3,11:INK 5,11:INK 6,2
970 FOR y=1 TO 25:NEXT
980 WEND:INK 0,1:INK 1,24:BORDER 1:MODE 1
990 END
1000 READ s:IF s=0 THEN RESTORE:GOTO 1000
1010 READ s2:SOUND 2,s2,s,15,1
1020 ON SQ(2) GOSUB 1000:RETURN
1030 DATA 36, 95,18,127,18,119,36,106,18,119,18,127,36,142
1040 DATA 18,142,18,119,36, 95,18,106,18,119,54,127,18,119
1050 DATA 36,106,36, 95,36,119,36,142,72,142,36,106,18, 89
1060 DATA 36, 71,18, 80,18, 89,36, 95,18,119,18,106,36, 95
1070 DATA 18,106,18,119,54,127,18,119,36,108,36, 95,36,119
1080 DATA 36,142,72,142,0
1090 car=1:FOR x=1 TO LEN(tex$):cadena(x)=25:NEXT:posi=10-(LEN(tex$)+1)/2:hige=25-(25-high)/3
1100 WHILE car>0
1110 car=0:FOR x=1 TO LEN(tex$)
1120 IF cadena(x)=hig THEN GOTO 1150
1130 car=car+1
1140 IF (car<4)AND(cadena(x-1)<hige) THEN LOCATE posi+x,cadena(x)-1:PRINT MID$(tex$,x,1);:LOCATE posi+x,cadena(x):PRINT " ";:cadena(x)=cadena(x)-1
1150 NEXT
1160 WEND
1170 RETURN