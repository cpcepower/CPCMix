10 '* CONTACT * par BARJON G:MARGES 26
20 '
30 'pour la revue C P C
40 '
50 'presentation du jeu
60 '
70 MODE 0:BORDER 16:INK 0,16
80 DIM P(14)
90 FOR I=0 TO 14
100 READ P(I):INK I+1,P(I)
110 NEXT
120 DATA 0,1,3,6,8,9,15,18
130 DATA 20,7,1,15,4,6,15
140 CLG 0:PAPER 0:ORIGIN 320,200
150 FOR J=0 TO 103
160 I=J*PI/52
170 MOVE COS(I)*150,SIN(I)*200
180 DRAW COS(I)*320,SIN(I)*80,J MOD 13+1
190 NEXT
200 LOCATE 4,2:PRINT CHR$(22)
210 PRINT CHR$(1)"BARJON GEORGES"
220 LOCATE 7,13:PRINT" CONTACT"
230 LOCATE 14,24:PRINT"(C)1988"
240 FOR K=1 TO 2
250 FOR J=1 TO 9
260 FOR I=1 TO 13
270 INK I,P((J+I)MOD 13)
280 NEXT I,J,K
290 GOSUB 6740
300 '
310 'voir le menu o/n
320 '
330 INK 1,1:MODE 1:GOSUB 5940
340 LOCATE 13,10:PRINT A50$;
350 PRINT STRING$(15,A54$);
360 PRINT A56$:LOCATE 13,11:PRINT A49$;
370 PRINT SPACE$(15);A49$
380 LOCATE 13,12:PRINT A49$;
390 PRINT" C O N T A C T ";A49$
400 LOCATE 13,13:PRINT A49$;
410 PRINT SPACE$(15);A49$
420 LOCATE 13,14:PRINT A47$;
430 PRINT STRING$(15,A54$);
440 PRINT A53$:LOCATE 13,20
450 PRINT"MODE D'EMPLOI O/N"
460 LOCATE 13,21
470 PRINT STRING$(17,A54$);
480 C$=INKEY$:IF C$=""THEN 480
490 C$=UPPER$(C$)
500 IF C$="O"THEN GOSUB 5430
510 '
520 'initialisations des var et dim
530 '
540 MODE 1:GOSUB 5660:GOSUB 5260
550 DEFINT A-Z:NE=102:GOSUB 5940
560 RANDOMIZE TIME:FLX=32:FLO=32
570 DIM NY(NE),NX(NE)
580 DIM MO(NE),ZZ(NE),MZ(NE)
590 DIM TRI(NE),NN(NE),AD(30)
600 DIM IN(NE),A(20),B(20)
610 DIM VA(30),VB(30):T!=TIME
620 IF PAS$<>"1"THEN 660
630 GOSUB 1500:GOSUB 2040
640 GOSUB 2680:C$="00"
650 GOSUB 2880:GOTO 690
660 GOSUB 2040:LOCATE 1,1:GOSUB 6080
670 GOSUB 2680:C$="00":GOSUB 2880
680 '
690 'a qui le tour (les x ou les o )
700 '
710 LOCATE 4,22
720 PRINT"CONTRE L'ORDINATEUR(1) OU A DEUX(2)"
730 B$=INKEY$:IF B$=""THEN 730
740 ORD$=B$
750 IF ORD$="1"OR ORD$="2"THEN 760 ELSE 730
760 GOSUB 3130
770 IF ORD$="2"THEN 780 ELSE COM$="1":GOTO 830
780 GOSUB 3130
790 LOCATE 10,22:PRINT"QUI COMMENCE ";J2$;
800 PRINT" =1 ";J3$;" =2"
810 C$=INKEY$:IF C$=""THEN 810
820 C$=UPPER$(C$):COM$=C$
830 GOSUB 3130
840 LOCATE 12,22:PRINT"FORCE (1) FORCE (2)"
850 B$=INKEY$:IF B$=""THEN 850
860 B$=UPPER$(B$)
870 IF B$="2"THEN FORCE=1:GOTO 890 
880 IF B$<>"1" THEN 840
890 IF COM$="1"THEN B1$=J2$:GOTO 920
900 B1$=J3$:GOTO 920
910 GOTO 790
920 GOSUB 3130
930 IF B1$=J2$THEN FLX=FLX-1:B3=1
940 IF B1$=J3$THEN FLO=FLO-1:B3=3
950 IF FLAG=0 THEN 1070
960 LOCATE 31,22:PRINT"   "
970 '
980 'musique
990 '
1000 DATA 110,30,120,40,110,30,140,40
1010 RESTORE 1000
1020 FOR I=1 TO 4
1030 READ NOTE,TEMP
1040 SOUND 1,NOTE,TEMP,15
1050 NEXT
1060 '
1070 'jeu de l'ordinateur
1080 '
1090 IF ORD$="1"AND ORD=1 THEN 1100 ELSE 1150
1100 T!=TIME:LOCATE 10,22
1110 PRINT"JOUEUR "B1$;" VOTRE CHOIX "
1120 GOSUB 3320:GOSUB 1660:GOSUB 1750
1130 GOSUB 1890:GOTO 1430
1140 '
1150 'joueur humain
1160 '
1170 T!=TIME:LOCATE 10,22
1180 PRINT"JOUEUR "B1$;" VOTRE CHOIX ";
1190 C$="":C$=INKEY$:IF C$=""THEN 1190
1200 C$=UPPER$(C$):C=ASC(C$)
1210 PRINT C$;
1220 IF C<65 OR C>72 THEN GOSUB 3130:GOTO 1170
1230 CC$="":CC$=INKEY$:IF CC$=""THEN 1230
1240 C=ASC(CC$)
1250 IF C<49 OR C>56 THEN GOSUB 3130:GOTO 1170
1260 PRINT CC$
1270 C$=C$+CC$
1280 IF FLT=64 THEN 1400
1290 IF FORCE=0 THEN 1400
1300 TK=0:GOSUB 1590
1310 FOR RF=C-11 TO C-9
1320 IF MO(RF)>0 THEN TK=TK+1
1330 NEXT
1340 FOR RF=C+9 TO C+11
1350 IF MO(RF)>0 THEN TK=TK+1
1360 NEXT
1370 IF MO(C-1)>0 THEN TK=TK+1
1380 IF MO(C+1)>0 THEN TK=TK+1
1390 IF TK=0 THEN PRINT BEL$:GOSUB 3130:GOTO 1150
1400 ORD=0:GOSUB 1750
1410 GOSUB 1590:GOSUB 1890
1420 '
1430 'affichage ecran
1440 '
1450 LOCATE 6+(Y*2),X
1460 PEN B3:PRINT B1$:PEN 1
1470 GOSUB 2450:GOSUB 2780
1480 GOSUB 1970:GOTO 960
1490 '
1500 'efface les x et les o
1510 '
1520 RESTORE 2220
1530 FOR I=1 TO 64
1540 READ NO,NN:CC=NO
1550 GOSUB 1660:GOSUB 1750
1560 LOCATE 6+(Y*2),X:PRINT" "
1570 NEXT:RETURN
1580 '
1590 'change c$ en c (no de case)
1600 '
1610 CB=ASC(C$)
1620 CBB=ASC(MID$(C$,2,2))
1630 C=((CB-64)*10)+((CBB-48)+1)
1640 RETURN
1650 '
1660 'change c en c$ (valeur de case)
1670 '
1680 BC=INT(CC/10)
1690 C$=CHR$(64+BC)
1700 BBC=(CC-(BC*10))
1710 C1$=CHR$((BBC-1)+48)
1720 C$=C$+C1$
1730 RETURN
1740 '
1750 'gestion a1 a2 etc...
1760 '
1770 C$=UPPER$(C$)
1780 CV=ASC(MID$(C$,1,1))-64
1790 ON CV GOTO 1800,1810,1820,1830,1840,1850,1860,1870
1800 Y=(VAL(MID$(C$,2))-1):X=3:RETURN
1810 Y=(VAL(MID$(C$,2))-1):X=5:RETURN
1820 Y=(VAL(MID$(C$,2))-1):X=7:RETURN
1830 Y=(VAL(MID$(C$,2))-1):X=9:RETURN
1840 Y=(VAL(MID$(C$,2))-1):X=11:RETURN
1850 Y=(VAL(MID$(C$,2))-1):X=13:RETURN
1860 Y=(VAL(MID$(C$,2))-1):X=15:RETURN
1870 Y=(VAL(MID$(C$,2))-1):X=17:RETURN
1880 '
1890 'est ce une case libre
1900 '
1910 FOR YT=1 TO 64
1920 IF C=TRI(YT)THEN NO=TRI(YT):GOTO 1930 ELSE NEXT
1930 IF ORD=1 THEN LOCATE 31,22:PRINT C$:FOR I=1 TO 800:NEXT
1940 IF MO(NO)<>0 THEN PRINT BEL$:GOSUB 3130:GOTO 1150
1950 NY(NO)=6+(Y*2):NX(NO)=X:MO(NO)=B3:RETURN
1960 '
1970 'echange
1980 '
1990 IF B1$=J2$THEN B1$=J3$:B3=3:FLO=FLO-1:GOTO 2010
2000 B1$=J2$:B3=1:FLX=FLX-1
2010 IF ORD=1 THEN ORD=0 ELSE ORD=1
2020 RETURN
2030 '
2040 'lecture no de case
2050 '
2060 RESTORE 2220
2070 FOR I=1 TO 64
2080 READ TD,NN
2090 TRI(I)=TD:NN(I)=NN
2100 NEXT
2110 RESTORE 2310
2120 FOR MK=1 TO 28
2130 READ VA,VB
2140 VA(MK)=VA:VB(MK)=VB
2150 NEXT
2160 RESTORE 2390
2170 FOR INUT=1 TO 36
2180 READ IN
2190 MO(IN)=-1
2200 NEXT
2210 RETURN
2220 DATA 12,3,13,2,14,2,15,2,16,2,17,2,18,2,19,3
2230 DATA 22,2,23,0,24,0,25,0,26,0,27,0,28,0,29,2
2240 DATA 32,2,33,0,34,1,35,1,36,1,37,1,38,0,39,2
2250 DATA 42,2,43,0,44,1,45,2,46,2,47,1,48,0,49,2
2260 DATA 52,2,53,0,54,1,55,2,56,2,57,1,58,0,59,2
2270 DATA 62,2,63,0,64,1,65,1,66,1,67,1,68,0,69,2
2280 DATA 72,2,73,0,74,0,75,0,76,0,77,0,78,0,79,2
2290 DATA 82,3,83,2,84,2,85,2,86,2,87,2,88,2,89,3
2300 '
2310 'val cases pour 1
2320 '
2330 DATA 12,50,13,30,14,30,15,30,16,30,17,30
2340 DATA 82,50,83,30,84,30,85,30,86,30,87,30
2350 DATA 22,30,32,30,42,30,52,30,62,30,72,30  
2360 DATA 29,30,39,30,49,30,59,30,69,30,79,30
2370 DATA 18,30,19,50,88,30,89,50
2380 '
2390 'cases inutilisables
2400 '
2410 DATA 1,2,3,4,5,6,7,8,9,10,11,20,21,30,31
2420 DATA 40,41,50,51,60,61,70,71,80,81,90,91
2430 DATA 92,93,94,95,96,97,98,99,100
2440 '
2450 'test cases adjacentes
2460 '
2470 IF B1$=J2$THEN B2=1:GOTO 2490
2480 B2=3
2490 PEN B2
2500 FOR I=NO-11 TO NO-9
2510 IF MO(I)<1 THEN 2540
2520 LOCATE NY(I),NX(I)
2530 PRINT B1$:MO(I)=B2
2540 NEXT
2550 FOR I=NO+9 TO NO+11
2560 IF MO(I)<1 THEN 2590
2570 LOCATE NY(I),NX(I)
2580 PRINT B1$:MO(I)=B2
2590 NEXT
2600 IF MO(NO-1)<1 THEN 2630
2610 LOCATE NY(NO-1),NX(NO-1)
2620 PRINT B1$:MO(NO-1)=B2
2630 IF MO(NO+1)<1 THEN 2660
2640 LOCATE NY(NO+1),NX(NO+1)
2650 PRINT B1$:MO(NO+1)=B2
2660 PEN 1
2670 '
2680 'calcul du score
2690 '
2700 SCO=0:SCX=0
2710 FOR I=12 TO 89
2720 IF MO(I)=1 THEN SCX=SCX+1
2730 IF MO(I)=3 THEN SCO=SCO+1
2740 NEXT
2750 FLT=64-(SCX+SCO)
2760 RETURN
2770 '
2780 'scores des x et des o
2790 '
2800 IF FLX<=0 AND FLO<=0 THEN GOSUB 2880:GOTO 2810 ELSE 2880
2810 GOSUB 3130
2820 IF SCX>SCO THEN LOCATE 12,22:PRINT"LES ";J2$;" ONT GAGNES";
2830 IF SCX<SCO THEN LOCATE 12,22:PRINT"LES ";J3$;" ONT GAGNES";
2840 IF SCO=SCX THEN LOCATE 7,22:PRINT" MATCH NUL , PAS MAL JOUER ";
2850 GOTO 3180
2860 RETURN
2870 '
2880 'affichage
2890 '
2900 TT!=(TIME-T!)/300:TP!=0
2910 LOCATE 28,3:PRINT USING"##";FLO
2920 LOCATE 37,3:PRINT USING"##";FLX
2930 LOCATE 28,18:PRINT USING"##";SCO;
2940 LOCATE 37,18:PRINT USING"##";SCX
2950 LOCATE 25,14:TP=TT!*100
2960 IF FLT=64 THEN PRINT USING"##.##";0:GOTO 2990
2970 IF TP>9999 THEN TP=9999
2980 PRINT USING"##.##";TP/100
2990 LOCATE 37,14:PRINT C$:T!=0:TT!=0
3000 FOR K=1 TO 5
3010 LOCATE 25,6+K:PRINT" "
3020 LOCATE 27,6+K:PRINT" ":NEXT
3030 IF SCO=SCX THEN 3100
3040 IF SCO>SCX THEN 3080
3050 GOTO 3060
3060 LOCATE 27,7:PRINT J2$
3070 LOCATE 25,11:PRINT J3$:RETURN
3080 LOCATE 25,7:PRINT J3$
3090 LOCATE 27,11:PRINT J2$:RETURN
3100 LOCATE 25,9:PRINT J3$
3110 LOCATE 27,9:PRINT J2$:RETURN
3120 '
3130 'efface message
3140 '
3150 LOCATE 3,22:PRINT STRING$(37," ")
3160 RETURN
3170 '
3180 'fin ou rejouer
3190 '
3200 FOR I=200 TO 1 STEP-1
3210 SOUND 2,1,2
3220 SOUND 5,201-I,2
3230 NEXT
3240 FOR FIN=1 TO 1000:NEXT
3250 GOSUB 3130:LOCATE 9,22
3260 PRINT"VOULEZ VOUS CONTINUER  O/N"
3270 C$=INKEY$:IF C$=""THEN 3270
3280 C$=UPPER$(C$)
3290 IF C$="O"THEN CLEAR:PAS$="1":GOTO 550
3300 CLS:END
3310 '
3320 'recherche de la bonne case ?
3330 '
3340 ML=1:FOR Y=1 TO 64:ZZ=0:ZZ(Y)=0:MS=0
3350 NO=TRI(Y):NN=NN(Y):IF MO(NO)<>0 THEN 3420
3360 FOR I=NO-11 TO NO-9:GOSUB 3440:NEXT
3370 FOR I=NO+9 TO NO+11:GOSUB 3440:NEXT
3380 FOR I=NO-1 TO NO+1 STEP 2:GOSUB 3440:NEXT
3390 IF ZZ<10 THEN 3420
3400 IF MS+ZZ>=80 THEN ZZ=ZZ+MS
3410 MZ(ML)=NO:ZZ(ML)=ZZ+NN:ML=ML+1
3420 NEXT:GOSUB 3510:GOTO 3700
3430 '
3440 'test case des x
3450 '
3460 IF MO(I)=0 THEN RETURN
3470 IF MO(I)<0 THEN MS=MS+10:RETURN
3480 IF MO(I)=1 THEN ZZ=ZZ+11:RETURN
3490 ZZ=ZZ+10:RETURN
3500 '
3510 'tri tgv
3520 '
3530 S=1:A(1)=1:B(1)=ML
3540 L=A(S):R=B(S):S=S-1
3550 I=L:J=R:H=ZZ((L+R)/2)
3560 IF ZZ(I)<H AND I<R THEN I=I+1:GOTO 3560
3570 IF ZZ(J)>H AND J>L THEN J=J-1:GOTO 3570
3580 IF I>J THEN 3610
3590 ZZ=ZZ(I):ZZ(I)=ZZ(J):ZZ(J)=ZZ
3600 MZ=MZ(I):MZ(I)=MZ(J):MZ(J)=MZ:I=I+1:J=J-1
3610 IF I<=J THEN 3560
3620 IF R-I<=J-L THEN 3650
3630 IF L<J THEN S=S+1:A(S)=L:B(S)=J
3640 L=I:GOTO 3670
3650 IF I<R THEN S=S+1:A(S)=I:B(S)=R
3660 R=J
3670 IF R>L THEN 3550
3680 IF S>0 THEN 3540
3690 RETURN
3700 N=ML+1
3710 N=N-1:CH=0:FTT=0:ZT=0:GOTO 3730
3720 C=MZ(N):CC=C:RETURN
3730 IF ZZ(N)>=80 THEN 3720
3740 ZR=INT(ZZ(N)/10)
3750 IF N<2 THEN N=ML:GOTO 4810
3760 ON ZR GOTO 3790,3780,3830,3810
3770 GOTO 3860
3780 IF ZR=2 THEN 3710
3790 IF FLT>20 THEN BZ=5:GOTO 3860
3800 BZ=4:GOTO 3860
3810 GOSUB 4490
3820 IF FTT=1 THEN 3710 ELSE 3860
3830 GOSUB 4160
3840 IF FTT=1 THEN 3710
3850 '
3860 'reprise possible
3870 '
3880 DATA 11,10,9,-11,-10,-9,1,-1
3890 RESTORE 3880:AD=MZ(N):Y=0
3900 READ HH:CH=AD+HH
3910 IF CH<12 OR CH>89 THEN 4080
3920 IF MO(CH)<>0 THEN 4080
3930 GOTO 4000
3940 IF ZR=1 AND ZT<BZ THEN 3720
3950 IF ZR=3 AND ZT<5 THEN 3720
3960 IF ZR=4 AND ZT=4 THEN 3720
3970 IF ZT=8 THEN ZZ(N)=0
3980 IF ZT>=ZR THEN 3710 ELSE 3720
3990 '
4000 'test de reprise
4010 '
4020 ZS=0:ZY=1
4030 FOR ZI=CH-11 TO CH-9:GOSUB 4100:NEXT
4040 FOR ZI=CH+9 TO CH+11:GOSUB 4100:NEXT
4050 FOR ZI=CH-1 TO CH+1 STEP 2:GOSUB 4100:NEXT
4060 IF ZS+ZY=8 THEN ZY=ZY+ZS
4070 IF ZT<ZY THEN ZT=ZY
4080 IF Y<7 THEN Y=Y+1:GOTO 3900 ELSE 3940
4090 '
4100 'test case des o
4110 '
4120 IF MO(ZI)=0 THEN RETURN
4130 IF MO(ZI)>0 THEN ZY=ZY+1:RETURN
4140 ZS=ZS+1:RETURN
4150 '
4160 'test de 3
4170 '
4180 TT=MZ(N):F1=0:FL=0
4190 IF TT=23 OR TT=28 OR TT=73 OR TT=78 THEN 4210
4200 GOTO 4320
4210 FLAG=0:TX=0:FOR I=TT-11 TO TT-9
4220 IF MO(I)>0 THEN TX=TX+I
4230 NEXT
4240 FOR I=TT+9 TO TT+11
4250 IF MO(I)>0 THEN TX=TX+I
4260 NEXT
4270 IF MO(TT-1)>0 THEN TX=TX+TT-1
4280 IF MO(TT+1)>0 THEN TX=TX+TT+1
4290 TXT=TT*3
4300 D9=TXT+3:G9=TXT-3:B9=TXT+30:H9=TXT-30
4310 IF TX=D9 OR TX=G9 OR TX=H9 OR TX=B9 THEN 4460
4320 IF MO(TT-11)>0 THEN F1=1:FL=FL+1
4330 IF MO(TT-9)>0 THEN F1=2:FL=FL+1
4340 IF MO(TT+9)>0 THEN F1=3:FL=FL+1
4350 IF MO(TT+11)>0 THEN F1=4:FL=FL+1
4360 IF FL<>1 THEN 4470
4370 ON F1 GOTO 4400,4380,4440,4420
4380 IF MO(TT-20)=0 OR MO(TT-19)=0 OR MO(TT-8)=0 OR MO(TT+2)=0 THEN 4460
4390 GOTO 4470
4400 IF MO(TT-20)=0 OR MO(TT-21)=0 OR MO(TT-2)=0 OR MO(TT-12)=0 THEN 4460
4410 GOTO 4470
4420 IF MO(TT+20)=0 OR MO(TT+21)=0 OR MO(TT+2)=0 OR MO(TT+12)=0 THEN 4460
4430 GOTO 4470
4440 IF MO(TT+20)=0 OR MO(TT+19)=0 OR MO(TT-2)=0 OR MO(TT+8)=0 THEN 4460
4450 GOTO 4470
4460 FTT=1
4470 RETURN
4480 '
4490 'test de 4
4500 '
4510 TT=MZ(N):FT=0:FTT=0
4520 FOR T=TT-11 TO TT-9
4530 IF MO(T)>0 THEN FT=FT+T
4540 NEXT
4550 FOR T=TT+9 TO TT+11
4560 IF MO(T)>0 THEN FT=FT+T
4570 NEXT
4580 IF MO(TT+1)>0 THEN FT=FT+TT+1
4590 IF MO(TT-1)>0 THEN FT=FT+TT-1
4600 ST=MZ(N)*4
4610 IF FT=ST-31 THEN 4700
4620 IF FT=ST+31 THEN 4710
4630 IF FT=ST-29 THEN 4730
4640 IF FT=ST+29 THEN 4720
4650 IF FT=ST+7  THEN 4740
4660 IF FT=ST-7  THEN 4750
4670 IF FT=ST+13 THEN 4760
4680 IF FT=ST-13 THEN 4770
4690 GOTO 4790
4700 IF MO(TT-8)<1 THEN 4780 ELSE 4790
4710 IF MO(TT+8)<1 THEN 4780 ELSE 4790
4720 IF MO(TT+12)<1 THEN 4780 ELSE 4790
4730 IF MO(TT-12)<1 THEN 4780 ELSE 4790
4740 IF MO(TT-21)<1 THEN 4780 ELSE 4790
4750 IF MO(TT+21)<1 THEN 4780 ELSE 4790
4760 IF MO(TT-19)<1 THEN 4780 ELSE 4790
4770 IF MO(TT+19)<1 THEN 4780 ELSE 4790
4780 FTT=1
4790 RETURN
4800 '
4810 'ici on joue le mieux ?
4820 '
4830 FOR MK=2 TO ML
4840 FOR MX=A TO 28
4850 IF MZ(MK)=VA(MX) THEN ZZ(MK)=ZZ(MK)+VB(MX)
4860 NEXT:NEXT
4870 GOSUB 3510
4880 N=ML+1
4890 N=N-1:ZZ(N)=INT(ZZ(N)/10)
4900 IF N<=2 THEN N=ML:GOTO 3720
4910 IF ZZ(N)>6 THEN 4890
4920 GOTO 4940
4930 '
4940 'test des trous
4950 '
4960 FOR Z=1 TO 8:AD(Z)=0:NEXT
4970 TR=MZ(N):TZ=0
4980 FOR I=TR-11 TO TR-9
4990 IF MO(I)=0 THEN TZ=TZ+1:AD(TZ)=I
5000 NEXT
5010 FOR I=TR+9 TO TR+11
5020 IF MO(I)=0 THEN TZ=TZ+1:AD(TZ)=I
5030 NEXT
5040 IF MO(TR-1)=0 THEN TZ=TZ+1:AD(TZ)=TR-1
5050 IF MO(TR+1)=0 THEN TZ=TZ+1:AD(TZ)=TR+1
5060 IF TZ=1 THEN 4890
5070 IF TZ>3 THEN 3720
5080 '
5090 'recherche suplementaire
5100 '
5110 ZT=1
5120 IF ZT>TZ THEN N=N-1:GOTO 4890
5130 TRO=0
5140 FOR T=AD(ZT)-11 TO AD(ZT)-9
5150 IF MO(T)<>0 THEN TRO=TRO+1
5160 NEXT
5170 FOR T=AD(ZT)+9 TO AD(ZT)+11
5180 IF MO(T)<>0 THEN TRO=TRO+1
5190 NEXT
5200 IF MO(AD(ZT))-1<>0 THEN TRO=TRO+1
5210 IF MO(AD(ZT))+1<>0 THEN TRO=TRO+1
5220 IF TRO=6 AND ZZ(N)<7 THEN 3720
5230 IF TRO=5 AND ZZ(N)<7 THEN 3720
5240 ZT=ZT+1:GOTO 5120
5250 '
5260 'araignee
5270 '
5280 DEFREAL a-z:X0=515:Y0=280:R=20
5290 FOR M=1 TO 3 STEP 0.3
5300 PLOT X0+R*M,Y0,1
5310 FOR A=PI/4 TO 2*PI+0.1 STEP PI/4
5320 X=R*M*COS(A)+X0
5330 Y=R*M*SIN(A)+Y0
5340 DRAW X,Y,1:PLOT X0,Y0
5350 DRAW X,Y:NEXT A,M
5360 PLOT X0+5,Y0,1:DRAW X0+5,185
5370 LOCATE 33,13:PRINT CHR$(224)
5380 LOCATE 33,14:PRINT CHR$(162)
5390 LOCATE 32,14:PRINT CHR$(192);
5400 PRINT CHR$(196);CHR$(193);
5410 RETURN
5420 '
5430 'mode d'emploi
5440 '
5450 MODE 2:LOCATE 23,2
5460 PRINT"  REGLE DU JEU DE *  CONTACT  *"
5470 LOCATE 23,3
5480 PRINT"---------------------------------"
5490 LOCATE 11,5
5500 PRINT"LE BUT DU JEU EST DE PRENDRE LE MAXIMUN DE CASES ADVERSES"
5510 LOCATE 8,7
5520 PRINT"IL VOUS FAUT SAVOIR QUE LE SIMPLE CONTACT D'UNE CASE TRANSFORME"
5530 LOCATE 8,9
5540 PRINT"IMMEDIATEMENT TOUTES LES CASES ADJACENTES EN PIONS DE SON CAMP"
5550 LOCATE 8,13
5560 PRINT"POUR PRENDRE IL VOUS FAUT JOUER LIGNE+COLONNE EX:A1,B5.....ETC"
5570 LOCATE 6,15
5580 PRINT"A FORCE (2) IL FAUT TOUCHER UNE CASE OCCUPEE......PAS A FORCE (1)"
5590 LOCATE 30,19
5600 PRINT"ET BIEN JOUER....SVP"
5610 LOCATE 25,24
5620 PRINT"BONNE CHANCE     SUITE (ENTER)"
5630 C$=INKEY$:IF C$=""THEN 5630
5640 RETURN
5650 '
5660 'lettres fines
5670 '
5680 RESTORE 5740
5690 SYMBOL AFTER 65
5700 FOR I=65 TO 90
5710 FOR J=0 TO 6
5720 READ X:TX(J)=X
5730 NEXT
5740 SYMBOL I,TX(0),TX(1),TX(2),TX(3),TX(4),TX(5),TX(6)
5750 NEXT
5760 RETURN
5770 DATA 24,36,66,126,66,66,66,124,34,34,60,34
5780 DATA 34,124,28,34,64,64,64,34,28,120
5790 DATA 36,34,34,34,36,120,126,64,64,124
5800 DATA 64,64,126,126,64,64,124,64,64,64,28
5810 DATA 34,64,78,66,34,28,66,66,66,126,66
5820 DATA 66,66,28,8,8,8,8,8,28,14,4,4,4,4,68
5830 DATA 56,66,68,72,112,72,68,66,64,64,64
5840 DATA 64,64,64,126,66,102,90,90,66,66,66
5850 DATA 66,98,82,74,70,66,66,60,66,66,66,66
5860 DATA 66,60,124,66,66,124,64,64,64,60
5870 DATA 66,66,66,74,68,58,124,66,66,124,72
5880 DATA 68,66,60,66,64,60,2,66,60,62,8,8
5890 DATA 8,8,8,8,66,66,66,66,66,66,60,66,66
5900 DATA 66,36,36,24,24,66,66,66,90,90,102
5910 DATA 99,66,66,36,24,36,66,66,34,34,34
5920 DATA 28,8,8,8,126,2,4,24,32,64,126
5930 '
5940 'chr$(xxx) en xx$
5950 '
5960 J2$=CHR$(202):J3$=CHR$(203)
5970 A49$=CHR$(149):A47$=CHR$(147)
5980 A50$=CHR$(150):A51$=CHR$(151)
5990 A53$=CHR$(153):A54$=CHR$(154)
6000 A55$=CHR$(155):A56$=CHR$(156)
6010 A57$=CHR$(157):A58$=CHR$(158)
6020 A59$=CHR$(159):BEL$=CHR$(7)
6030 A80$=A54$+A58$:A81$=A54$+A56$
6040 A82$=A54$+A59$:A83$=A54$+A57$
6050 A84$=A54$+A55$:A85$=A54$+A53$
6060 A86$=A49$+" ":RETURN
6070 '
6080 'dessin du jeu
6090 '
6100 PRINT TAB(6);"1 2 3 4 5 6 7 8"
6110 PRINT TAB(5);A50$;:FOR Y=1 TO 7
6120 PRINT A80$;:NEXT:PRINT A81$
6130 FOR Y=1 TO 7:PRINT TAB(5);
6140 FOR I=1 TO 9:PRINT A86$;
6150 NEXT:PRINT TAB(5);A51$;
6160 FOR I=1 TO 7:PRINT A82$;:NEXT
6170 PRINT A83$:NEXT:PRINT TAB(5);
6180 FOR I=1 TO 9:PRINT A86$;:NEXT
6190 PRINT TAB(5);A47$;:FOR I=1 TO 7
6200 PRINT A84$;:NEXT:PRINT A85$
6210 FOR Y=1 TO 8:LOCATE 3,(Y*2)+1
6220 PRINT CHR$(64+Y):NEXT
6230 LOCATE 5,19:PEN 1:PRINT CHR$(24);
6240 PRINT"* c o n t a c t *";
6250 PRINT CHR$(24):PEN 3
6260 LOCATE 1,20:PRINT A50$;
6270 PRINT STRING$(38,A54$);:PRINT A56$
6280 FOR I=21 TO 23:LOCATE 1,I
6290 PRINT A49$;:PRINT TAB(40);:PRINT A49$
6300 NEXT:LOCATE 1,I:PRINT A47$;
6310 PRINT STRING$(38,A54$);:PRINT A53$
6320 PEN 1:LOCATE 24,1:PRINT CHR$(24);
6330 PRINT"il reste a jouer";CHR$(24)
6340 LOCATE 24,16:PRINT CHR$(24);
6350 PRINT"total des points";CHR$(24)
6360 LOCATE 24,13:PRINT A50$
6370 LOCATE 25,13:PRINT STRING$(5,A54$);
6380 PRINT A56$:LOCATE 24,15
6390 PRINT A47$:LOCATE 25,15
6400 PRINT STRING$(5,A54$);
6410 PRINT A53$:LOCATE 24,14:PRINT A49$
6420 LOCATE 30,14:PRINT A49$
6430 LOCATE 36,13:PRINT A50$
6440 LOCATE 39,13:PRINT A56$
6450 LOCATE 36,15:PRINT A47$
6460 LOCATE 39,15:PRINT A53$
6470 LOCATE 37,13:PRINT STRING$(2,A54$);
6480 LOCATE 37,15:PRINT STRING$(2,A54$);
6490 LOCATE 36,14:PRINT A49$
6500 LOCATE 39,14:PRINT A49$
6510 LOCATE 25,3:PRINT J3$;" ="
6520 LOCATE 34,3:PRINT J2$;" ="
6530 LOCATE 25,18:PRINT J3$;" ="
6540 LOCATE 34,18:PRINT J2$;" ="
6550 LOCATE 24,2:PRINT A50$
6560 LOCATE 25,2:PRINT STRING$(15,A54$);
6570 LOCATE 39,2:PRINT A56$
6580 LOCATE 24,4:PRINT A47$
6590 LOCATE 25,4:PRINT STRING$(15,A54$);
6600 LOCATE 39,4:PRINT A53$
6610 LOCATE 24,3:PRINT A49$
6620 LOCATE 39,3:PRINT A49$
6630 LOCATE 24,17:PRINT A50$
6640 LOCATE 25,17:PRINT STRING$(14,A54$);
6650 LOCATE 39,17:PRINT A56$
6660 LOCATE 24,19:PRINT A47$
6670 LOCATE 25,19:PRINT STRING$(15,A54$);
6680 LOCATE 39,19:PRINT A53$
6690 LOCATE 24,18:PRINT A49$
6700 LOCATE 39,18:PRINT A49$
6710 FOR I=1 TO 5:LOCATE 26,6+I
6720 PRINT A49$:NEXT:RETURN
6730 '
6740 'musique
6750 '
6760 RESTORE 6830
6770 FOR I=1 TO 25
6780 READ N
6790 SOUND 1,N,35
6800 NEXT
6810 SOUND 1,142,100
6820 RETURN
6830 DATA 95,95,142,127,119,106,,95,95
6840 DATA 119,95,95,119,95,95,142,119
6850 DATA 142,179,119,142,142,106,119
6860 DATA 127,-1