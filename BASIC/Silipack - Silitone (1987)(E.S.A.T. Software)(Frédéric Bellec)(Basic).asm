110 ON ERROR GOTO 1290
120 POKE &BDEE,201:KEY DEF 66,0,0,0,0
121 MEMORY &9000:LOAD"tone.bkf",&A000:POKE &8001,0:POKE &8002,&A0:POKE &8008,0:POKE &8009,7:CALL &8000:CALL &A224
122 |BANKOPEN,5
130 'ENVELOPPES DES INSTRUMENTS
140 '
150 ENV 1,5,-2,3:ENT 1,21,8,1
160 ENV 2,4,-3,4:ENT-2,1,1,3,1,-1,3,1,0,3,1,1,3,1,-1,3
170 ENV 3,1,12,1,4,-3,2:ENT 3,1,15,1,1,-14,1
180 ENV 4,1,15,1,5,-1,2:ENT 4,15,1,1
190 ENV 5,12,-1,6
200 ENV 6,1,0,1,1,-10,1,1,0,1,1,10,1,1,0,2
210 ENV 7,15,1,1
220 ENV 8,5,3,1,9,-1,4
230 ENV 9,1,10,1,1,-10,1
240 '
250 'VARIANTES
260 '
270 ENV 10,2,-2,4,2,2,4,2,-2,4,2,2,4,2,-2,4
280 ENV 11,1,5,1,2,8,4,2,5,6,15,-1,1
290 ENV 12,8,-1,1,8,1,1
300 ENV 13,1,-6,1,1,-6,1,1,-6,1,1,-6,1,1,-6,1
310 ENV 14,1,-6,2,1,-8,1,1,-6,3,1,-6,5,1,-6,1
320 '
330 'TONALITES
340 '
350 ENT-7,1,9,5,1,-9,1
360 ENT 8,10,-2,1
370 ENT 9,10,2,1
380 ENT-10,5,-1,1,5,1,1
390 ENT-11,1,-7,1,1,6,1
400 ENT-12,1,7,1,1,-6,1
410 ENT-13,1,0,5,1,-10,1,1,0,5,1,10,1
420 ENT 14,1,20,1,10,-2,1
430 ENT 15,1,-20,1,10,2,1
440 '
450 GOSUB 1190:GOTO 600
460 '
470 SOUND canal%,1500,t%,15,1,1,0:RETURN'    Grosse caisse
480 SOUND canal%,880,t%,0,1,1,0:RETURN'    tom bass
490 SOUND canal%,740,t%,0,1,1,0:RETURN'    tom medium
500 SOUND canal%,540,t%,0,1,1,0:RETURN'    tom haut
510 SOUND canal%,0,t%,15,2,0,3:RETURN'    caisse claire
520 SOUND canal%,0,t%,13,6,0,7:RETURN'    Claquement de mains
530 SOUND canal%,0,t%,0,7,0,31:RETURN'    break
540 SOUND canal%,0,t%,0,8,2,1:RETURN'    charleston
550 SOUND canal%,0,t%,0,3,0,1:RETURN'    Balais
560 SOUND canal%,36,t%,0,9,3,0:RETURN'    Claves
570 SOUND canal%,22,t%,12,5,0,0:RETURN'    Triangle
580 SOUND canal%,44,t%,0,1,4,0:RETURN'    Whistle bas
590 SOUND canal%,34,t%,0,1,4,0:RETURN'    Whistle haut
600 RESTORE:FOR N=0 TO 9:READ vari(N):NEXT:FOR N=0 TO 9:READ tona(N):NEXT:DATA 0,1,3,6,7,10,11,12,13,14,0,7,8,9,10,11,12,13,14,15
610 tempo%=20
620 WHILE 1:RESTORE 740:FOR n%=0 TO 703 STEP 32
630 FOR m%=n%TO n%+31
640 READ Z$
650 T%=33-TEMPO%:FOR ins%=1 TO 3:canal%=ins%:IF canal%=3 THEN canal%=4
660 ins$=MID$(z$,ins%,1)
670 IF ASC(ins$)>31+3 AND ASC(ins$)<45+3 THEN ON ASC(ins$)-31-3 GOSUB 470,480,490,500,510,520,530,540,550,560,570,580,590:GOTO 700
680 IF ASC(ins$)>44+3 AND ASC(ins$)<105+3 THEN SOUND canal%,note(ASC(ins$)-45-3),t%,13,vari(VAL(MID$(z$,4,1))),tona(VAL(RIGHT$(z$,1))),0:GOTO 700
690 IF ASC(ins$)=105+3 THEN SOUND canal%,0,t%,0,0
700 NEXT ins%
710 IF INKEY$<>""THEN 1250
720 NEXT m%,n%:WEND
730 '
740 DATA "<ll10","Hll10","<ll10","<ll10","Hll10","Hll10","<ll10","Tll10","Hll10","<ll10","Tll10","Tll10","Hll10","<ll10","Hll10","Hll10"
750 DATA "Hll10","Hll10","<ll10","Tll10","Hll10","`ll10","`ll10","<ll10","Hll10","Hll10","<ll10","Tll10","Hll10","Tll10","<ll10","<ll10"
760 DATA "<0l10","H0l10","<0l10","<0l10","H0l10","H0l10","<0l10","T0l10","H0l10","<0l10","T0l10","T0l10","H0l10","<0l10","H0l10","H0l10"
770 DATA "H0l10","H0l10","<0l10","T0l10","H0l10","`0l10","`0l10","<0l10","H0l10","H0l10","<0l10","T0l10","H0l10","T0l10","<0l10","<0l10"
780 DATA "<#010","+<010","+H010","+<010","'H010","+T010","+H010","+T010","#<010","+<010","+H010","+<010","'T010","+H010","+`010","+`010"
790 DATA "#<010","+<010","+H010","+<010","'T010","+T010","+T010","+T010","#<010","+H010","+<010","+H010","'T010","+T010","+`010","+H010"
800 DATA "A#510","+A510","+M510","+A510","'Y510","+M510","+A510","+A510","#M510","+A510","+Y510","+Y510","'M510","A'510","M'510","A'510"
810 DATA "#O710","+C710","+O710","+O710","'C710","+O710","+7710","+C710","#C710","+7710","+C710","+O710","'O710","+O710","O'710","O'710"
820 DATA "A#510","+A510","+M510","+A510","'Y510","+M510","+A510","+A510","#M510","+A510","+Y510","+Y510","'M510","A'510","M'510","A'510"
830 DATA "#O710","+C710","+O710","+O710","'C710","+O710","+7710","+C710","#C710","+7710","+C710","+O710","'O710","+O710","O'710","O'710"
840 DATA "<#010","+<010","+H010","+<010","'H010","+T010","+H010","+T010","#<010","+<010","+H010","+<010","'T010","+H010","+`010","+`010"
850 DATA "#<010","+<010","+H010","+<010","'T010","+T010","+T010","+T010","#<010","+H010","+<010","+H010","'T010","+T010","+`010","+H010"
860 DATA "<ll10","Hll10","<ll10","<ll10","Hll10","Hll10","<ll10","Tll10","Hll10","<ll10","Tll10","Tll10","Hll10","<ll10","Hll10","Hll10"
870 DATA "Hll10","Hll10","<ll10","Tll10","Hll10","`ll10","`ll10","<ll10","Hll10","Hll10","<ll10","Tll10","Hll10","Tll10","<ll10","<ll10"
880 DATA "H<<04","H0<04","H<C04","H0C04","H<@04","H0@04","H<H04","H0H04","Tll04","Tll04","Tll04","Tll04","Tll04","Tll04","Tll04","Tll04"
890 DATA "Mll04","Mll04","Mll04","Mll04","Mll04","Mll04","Mll04","Mll04","Oll04","Oll04","Oll04","Oll04","Oll04","Oll04","Oll04","Oll04"
900 DATA "H<<04","H0<04","H<C04","H0C04","H<@04","H0@04","H<H04","H0H04","Tll04","Tll04","Tll04","Tll04","Tll04","Tll04","Tll04","Tll04"
910 DATA "Mll04","Mll04","Mll04","Mll04","Mll04","Mll04","Mll04","Mll04","Oll04","Oll04","Oll04","Oll04","Oll04","Oll04","Oll04","Oll04"
920 DATA "H<<04","H0<04","H<C04","H0C04","H<@04","H0@04","H<H04","H0H04","THC04","T0C04","THL04","T0L04","THH04","T0H04","THO04","T0O04"
930 DATA "MAA04","M5A04","MAJ04","M5J04","MAC04","M5C04","MAJ04","M5J04","OC<04","O7<04","OC@04","O7@04","OC704","O7704","OC@04","O7@04"
940 DATA "H<<04","H0<04","H<C04","H0C04","H<@04","H0@04","H<H04","H0H04","THC04","T0C04","THL04","T0L04","THH04","T0H04","THO04","T0O04"
950 DATA "MAA04","M5A04","MAJ04","M5J04","MAC04","M5C04","MAJ04","M5J04","OC<04","O7<04","OC@04","O7@04","OC704","O7704","OC@04","O7@04"
960 DATA "H<<04","H0<04","H<C04","H0C04","H<@04","H0@04","H<H04","H0H04","THC04","T0C04","THL04","T0L04","THH04","T0H04","THO04","T0O04"
970 DATA "MAA04","M5A04","MAJ04","M5J04","MAC04","M5C04","MAJ04","M5J04","OC<04","O7<04","OC@04","O7@04","OC704","O7704","OC@04","O7@04"
980 DATA "H<<04","H0<04","H<C04","H0C04","H<@04","H0@04","H<H04","H0H04","THC04","T0C04","THL04","T0L04","THH04","T0H04","THO04","T0O04"
990 DATA "MAA04","M5A04","MAJ04","M5J04","MAC04","M5C04","MAJ04","M5J04","OC<04","O7<04","OC@04","O7@04","OC704","O7704","OC@04","O7@04"
1000 DATA "Hll64","Gll64","Hll64","Jll64","Hll64","<ll64","Gll64","Ell64","Gll64",";ll64","Cll64","7ll64","Ell64","9ll64","9ll64","9ll64"
1010 DATA "Tll64","Sll64","Tll64","Vll64","Tll64","Hll64","Sll64","Qll64","Sll64","Gll64","Oll64","Cll64","Qll64","Ell64","Ell64","Ell64"
1020 DATA "H9964","G7964","H9964","J;964","H<964","<9@64","G;964","E9@64","G7964",";9@64","C9964","79@64","E9@64","99@64","99@64","99@64"
1030 DATA "T9964","S7964","T9964","V;964","T<964","H9@64","S;964","Q9@64","S7964","G9@64","O9964","C9@64","Q9@64","E9@64","E9@64","E9@64"
1040 DATA "5ll14","5ll14","5ll14","5ll14","5ll14","5ll14","5ll14","5ll14","5ll14","5ll14","5ll14","5ll14","5ll14","5ll14","5ll14","5ll14"
1050 DATA "5Ml14","5Al14","5Al14","5Ml14","5Ml14","5Al14","5Al14","5Ml14","5Ml14","5Ml14","77l14","77l14","99l14","9El14","<0l14","<0l14"
1060 DATA "'H514","+H514","+H514","+M514","'Q514","+Q514","+Q514","*H514","'R514","+R514","+R514","+Q514","'H514","+H514","+H514","+M514"
1070 DATA "'R514","+R514","+R514","+Q514","'H514","+H514","+H514","*Q014","'Q<14","+Q014","+Q<14","+O014","'O<14","+O014","+O<14","+O014"
1080 DATA "'H514","+H514","+H514","+M514","'Q514","+Q514","+Q514","*H514","'R514","+R514","+R514","+Q514","'H514","+H514","+H514","+M514"
1090 DATA "'R514","+R514","+R514","+Q514","'H514","+H514","+H514","*Q014","'Q<14","+Q014","+Q<14","+O014","'O<14","+O014","+O<14","+O014"
1100 DATA "'H:14","+MF14","+M:14","+MF14","'M:14","+MF14","+M:14","*MF14","'M:14","+MF14","+M:14","+MF14","'M:14","+MF14","+M:14","+MF14"
1110 DATA "'H514","+M514","+M514","+M514","'M514","+M514","+M514","*M514","'M514","+M514","+M714","+M714","'M914","+M914","+M<14","+M<14"
1120 DATA "'H514","+H514","+H514","+M514","'Q514","+Q514","+Q514","*H514","'R514","+R514","+R514","+Q514","'H514","+H514","+H514","+M514"
1130 DATA "'R514","+R514","+R514","+Q514","'H514","+H514","+H514","*Q014","'Q<14","+Q014","+Q<14","+O014","'O<14","+O014","+O<14","+O014"
1140 DATA "'H514","+H514","+H514","+M514","'Q514","+Q514","+Q514","*H514","'R514","+R514","+R514","+Q514","'H514","+H514","+H514","+M514"
1150 DATA "'R514","+R514","+R514","+Q514","'H514","+H514","+H514","*Q014","'Q<14","+Q014","+Q<14","+O014","'O<14","+O014","+O<14","+O014"
1160 DATA "'H:14","+MF14","+M:14","+MF14","'M:14","+MF14","+M:14","*MF14","'M:14","+MF14","+M:14","+MF14","'M:14","+MF14","+M:14","+MF14"
1170 DATA "'H514","+M514","+M514","+M514","'M514","+M514","+M514","*M514","'M514","+M514","+M714","+M714","'M914","+M914","+M<14","+M<14"
1180 '
1190 DATA 956,902,851,804,758,716,676,638,602,568,538,506
1200 DATA 478,451,426,402,379,358,338,319,301,284,268,253
1210 DATA 239,225,213,201,190,179,169,159,150,142,134,127
1220 DATA 119,113,106,100,95,89,84,80,75,71,67,63
1230 DATA 60,56,53,50,47,45,42,40,38,36,34,32
1240 DIM note(60):RESTORE 1190:FOR n=0 TO 59:READ note(n):NEXT:RETURN
1250 r=0:i$=CHR$(105)+CHR$(105)+CHR$(105)+"00":FOR N=0 TO 511:|BANKWRITE,@R,I$,N:NEXT:MODE 1:FOR n=0 TO 3:INK n,2:NEXT:LOAD"tone.ttr":|SCREENCOPY,5,1:|SCREENCOPY,4,1
1260 RESTORE 1270:FOR h=&A009 TO &A009+16:READ c:POKE h,c:NEXT
1270 DATA 255,192,252,0,255,0,207,192,195,240,0,252,0,63,0,15,255
1280 RESTORE 1281:FOR x=&BE80 TO &BE80+27+8:READ a$:POKE x,VAL("&"+a$):NEXT:CALL &BE80
1281 DATA e,7,21,ff,ab,cd,ce,bc,21,9c,BE,6,8,cd,77,bc,21,34,1,cd,83,bc,cd,7a,bc,c3,40,1,54,4f,4e,45,2e,42,49,4e
1290 CALL 0