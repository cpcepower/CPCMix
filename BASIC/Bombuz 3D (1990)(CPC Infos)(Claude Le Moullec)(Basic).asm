10 REM  ::::::::::::::::::::::::
20 REM  :                      :
30 REM  :  CLAUDE  LE MOULLEC  :
40 REM  :                      :
50 REM  : 83 RUE  JOLIOT CURIE :
60 REM  :                      :
70 REM  :    22420 PLOUARET    :
80 REM  :                      :
90 REM  :    TEL 96 38 94 24   :
100 REM :                      :
110 REM ::::::::::::::::::::::::
120 MEMORY &9400:LOAD "BOMBIN"
130 REM ::::::::::::::::::::::::
140 REM :                      :
150 REM :  VARTIABLES DE BASE  :
160 REM :                      :
170 REM ::::::::::::::::::::::::
180 DEFINT a-z:MODE 0:BORDER 0
190 RESTORE 200:FOR h=0 TO 15:READ a:INK h,a:NEXT
200 DATA 0,2,14,23,26,4,15,6,16,24,25,9,18,10,8,0
210 DIM note(16):RESTORE 220:FOR h=1 TO 16:READ pe:note(h)=pe:NEXT
220 DATA 95,106,127,142,159,190,213,253,284,319,379,80,71,63,53,47
230 DEF FN po(x,y)=&C000+(y-1)*80+(x-1)*2
240 DEF FN pla(x,y)=&E000+(y-1)*320+(x-1)*8
250 DIM pl(15):FOR h=0 TO 8:pl(h+3)=&95C0+(h*128):NEXT
260 DIM sp(15):FOR h=0 TO 7:sp(h+1)=&9A40+(h*90):NEXT
270 WINDOW #3,17,19,2,4:WINDOW #6,2,14,3,22
280 tr$=CHR$(22)+CHR$(1):nr$=CHR$(22)+CHR$(0)
290 DIM je(9,9):FON=1:sc=0:rec=0:vie=3:ta=32
300 ENT 5,200,1,1:ENV 3,5,-2,10:ENV 10,15,-1,1:ENV 14,1,5,1,10,1,4,5,-3,1
310 ENV 15,1,5,1,10,1,4,5,-3,1:ENT 14,40,-10,1:ENT 15,5,-20,1,60,10,1
320 GOSUB 3200
330 REM ::::::::::::::::::::::::
340 REM :                      :
350 REM :    DECOR DE BASE     :
360 REM :                      :
370 REM ::::::::::::::::::::::::
380 IF FON=0 THEN 420 ELSE POKE &A0D8,32:POKE &A0E2,0
390 FOR h=1 TO 8:FOR g=1 TO 6  
400 CALL &A0CB,FN pla(h,g),&94C0:NEXT g,h:POKE &A0E2,&AE
410 WINDOW #1,16,20,1,25:CLS #1
420 PLOT 480,400,0:DRAW 480,0:PLOT 476,400:DRAW 476,0
430 PLOT 0,398,6:DRAW 472,398:DRAW 472,1:DRAW 1,1:DRAW 1,398
440 PLOT 0,396:DRAW 472,396:DRAW 472,3:DRAW 3,3:DRAW 3,396
450 PLOT 5,394,7:DRAW 468,394:DRAW 468,5:DRAW 5,5:DRAW 5,394
460 PLOT 5,392:DRAW 468,392:DRAW 468,7:DRAW 7,7:DRAW 7,392
470 DATA 16,1,5,16,5,5,16,8,5,16,10,5,16,13,5,16,15,5,18,18
480 DATA 3,18,20,3,16,22,3,16,24,3,16,1,5,20,1,5,16,8,3,20
490 DATA 8,3,16,13,3,20,13,3,18,18,3,20,18,3,16,22,3,18,22,3
500 e1=6:e2=7:RESTORE 470:FOR i=1 TO 20:GOSUB 510:NEXT:GOTO 590
510 READ X,Y,L:x1=14+(X-1)*32:y1=388-(Y-1)*16
520 IF i>10 THEN 560
530 FOR J=0 TO 2 STEP 2:PLOT x1,y1+j,e1:DRAW x1+(l-1)*32,y1+j:NEXT
540 FOR J=4 TO 6 STEP 2:PLOT x1,y1+j,e2:DRAW x1+(l-1)*32,y1+j:NEXT
550 RETURN
560 PLOT x1+4,y1+2,e2:DRAW x1+4,y1+2-(l-1)*16
570 PLOT x1,y1+2,e1:DRAW x1,y1+2-(l-1)*16
580 RETURN
590 LOCATE 1,1:PRINT tr$:RESTORE 600:FOR h=1 TO 20:GOSUB 610:NEXT:GOTO 640
600 DATA 16,1,16,5,20,1,20,5,16,8,20,8,16,10,20,10,16,13,20,13
610 DATA 16,15,20,15,18,18,20,18,18,20,20,20,16,22,18,22,16,24,18,24
620 READ x,y:PEN 6:LOCATE x,y:PRINT CHR$(231):PEN 7:LOCATE x,y
630 PRINT CHR$(238):RETURN
640 RESTORE 650:FOR h=1 TO 8:READ ZL,YL,a$:GOSUB 660:NEXT:GOTO 690
650 DATA 32,9,"000000",32,11,"SCORES",32,14,"000000",36,19,"03",32,23,"00",36,23,"TAB",30,19,"VIE",32,16,"RECORD"
660 A$=UPPER$(A$):FOR T=1 TO LEN(A$):SP=(ASC(MID$(A$,T,1)))-48
670 IF sp<0 THEN sp=43
680 CALL &9D10,FN po(ZL,YL)+(T*2),&9D30+(SP*16):NEXT:RETURN
690 GOSUB 3040:GOSUB 3100:GOSUB 3120
700 REM ::::::::::::::::::::::::
710 REM :                      :
720 REM : BRANCHEMENT TABLEAUX :
730 REM :                      :
740 REM ::::::::::::::::::::::::
750 ON ta GOTO 760,770,780,790,800,810,820,830,840,850,860,870,880,890,900,910,920,930,940,950,960,970,980,990,1000,1010,1020,1030,1040,1050,1060,1070,1080
760 RESTORE 3570:GOSUB 1140:GOTO 1320
770 RESTORE 3580:GOSUB 1140:GOTO 1320
780 RESTORE 3590:GOSUB 1140:GOTO 1320
790 RESTORE 3600:GOSUB 1140:GOTO 1320
800 RESTORE 3610:GOSUB 1140:GOTO 1320
810 RESTORE 3620:GOSUB 1140:GOTO 1320
820 RESTORE 3630:GOSUB 1140:GOTO 1320
830 RESTORE 3640:GOSUB 1140:GOTO 1320
840 RESTORE 3650:GOSUB 1140:GOTO 1320
850 RESTORE 3660:GOSUB 1140:GOTO 1320
860 RESTORE 3670:GOSUB 1140:GOTO 1320
870 RESTORE 3680:GOSUB 1140:GOTO 1320
880 RESTORE 3690:GOSUB 1140:GOTO 1320
890 RESTORE 3700:GOSUB 1140:GOTO 1320
900 RESTORE 3710:GOSUB 1140:GOTO 1320
910 RESTORE 3720:GOSUB 1140:GOTO 1320
920 RESTORE 3730:GOSUB 1140:GOTO 1320
930 RESTORE 3740:GOSUB 1140:GOTO 1320
940 RESTORE 3750:GOSUB 1140:GOTO 1320
950 RESTORE 3760:GOSUB 1140:GOTO 1320
960 RESTORE 3770:GOSUB 1140:GOTO 1320
970 RESTORE 3780:GOSUB 1140:GOTO 1320
980 RESTORE 3790:GOSUB 1140:GOTO 1320
990 RESTORE 3800:GOSUB 1140:GOTO 1320
1000 RESTORE 3810:GOSUB 1140:GOTO 1320
1010 RESTORE 3820:GOSUB 1140:GOTO 1320
1020 RESTORE 3830:GOSUB 1140:GOTO 1320
1030 RESTORE 3840:GOSUB 1140:GOTO 1320
1040 RESTORE 3850:GOSUB 1140:GOTO 1320
1050 RESTORE 3860:GOSUB 1140:GOTO 1320
1060 RESTORE 3870:GOSUB 1140:GOTO 1320
1070 RESTORE 3880:GOSUB 1140:GOTO 1320
1080 ta=1:GOTO 750
1090 REM ::::::::::::::::::::::::
1100 REM :                      :
1110 REM :    DESSIN TABLEAU    :
1120 REM :                      :
1130 REM ::::::::::::::::::::::::
1140 CLS #3:POKE &A019,16:POKE &A021,8:GOSUB 3120
1150 ERASE je:DIM je(9,9):FOR h=1 TO 7:READ a$
1160 FOR g=1 TO 7:a=VAL(MID$(a$,g,1)):IF a=0 THEN 1190
1170 ax=(g+h-1)*2:by=(13+h)-g
1180 CALL &A00C,FN po(ax,by),pl(a)
1190 je(g+1,h+1)=a:NEXT g,h
1200 gan=0:fin=0:boum=0:feu=0
1210 POKE &A019,18:POKE &A021,5:POKE &A0D8,16
1220 PPP=1:A$=" <BOMBUZ< "
1230 CLS #3:CALL &A00C,&E094,sp(PPP)
1240 FOR T=1 TO LEN(A$):SP=(ASC(MID$(A$,T,1)))-48
1250 IF sp<0 THEN sp=43
1260 CALL &9D10,&D1CA+(T*2),&9D30+(SP*16):NEXT:RETURN
1270 REM ::::::::::::::::::::::::
1280 REM :                      :
1290 REM :  ROUTINE PRINCIPALE  :
1300 REM :                      :
1310 REM ::::::::::::::::::::::::
1320 READ X,Y:GOSUB 1890
1330 FOR h=700 TO 100 STEP -50:SOUND 1,5+h,10,4:NEXT
1340 CALL &A049,add:CALL &A00C,add,sp(1):ss=3
1350 IF fin=1 THEN 2740
1360 IF INKEY(ha)=0 THEN 1520
1370 IF INKEY(ga)=0 THEN ss=ss-1:GOTO 1420
1380 IF INKEY(da)=0 THEN ss=ss+1:GOTO 1420
1390 IF INKEY(fe)=0 THEN 2200
1400 GOTO 1350
1410 REM ::: QUART DE TOUR :::
1420 IF ss<1 THEN ss=4:GOTO 1440
1430 IF ss>4 THEN ss=1
1440 CALL &A069,add:ON ss GOTO 1450,1460,1470,1480
1450 CALL &A00C,add,sp(5):ac=5:GOTO 1490
1460 CALL &A00C,add,sp(3):ac=3:GOTO 1490
1470 CALL &A00C,add,sp(1):ac=1:GOTO 1490
1480 CALL &A00C,add,sp(7):ac=7
1490 IF feu=0 THEN CLS #3:CALL &A00C,&E094,sp(ac)
1500 FOR t=1 TO 15:SOUND 1,50-t,1,5:NEXT:GOTO 1350
1510 REM ::: AVANCE :::
1520 ON ss GOTO 1540,1630,1720,1810
1530 REM ::: A DROITE :::
1540 ex=je(x,y)
1550 CALL &A069,add:CALL &A049,add+8114
1560 CALL &A00C,add+8114,sp(6)
1570 FOR t=1 TO 200:NEXT:ad=add+8114
1580 x=x+1:GOSUB 1890
1590 CALL &A069,ad:CALL &A049,add
1600 CALL &A00C,add,sp(5):ac=5
1610 SOUND 1,100,2,5:GOTO 1950
1620 REM ::: VERS LE BAS :::
1630 ex=je(x,y)
1640 CALL &A069,add:CALL &A049,add+8194
1650 CALL &A00C,add+8194,sp(4)
1660 FOR t=1 TO 100:NEXT:ad=add+8194
1670 y=y+1:GOSUB 1890
1680 CALL &A069,ad:CALL &A049,add
1690 CALL &A00C,add,sp(3):ac=3
1700 SOUND 1,100,2,5:GOTO 1950
1710 REM ::: A GAUCHE :::
1720 ex=je(x,y)
1730 CALL &A069,add:CALL &A049,add+8190
1740 CALL &A00C,add+8190,sp(2)
1750 FOR t=1 TO 100:NEXT:ad=add+8190
1760 x=x-1:GOSUB 1890
1770 CALL &A069,ad:CALL &A049,add
1780 CALL &A00C,add,sp(1):ac=1
1790 SOUND 1,100,2,5:GOTO 1950
1800 REM ::: VERS LE HAUT :::
1810 ex=je(x,y)
1820 CALL &A069,add:CALL &A049,add+8110
1830 CALL &A00C,add+8110,sp(8)
1840 FOR t=1 TO 100:NEXT:ad=add+8110
1850 y=y-1:GOSUB 1890
1860 CALL &A069,ad:CALL &A049,add
1870 CALL &A00C,add,sp(7):ac=7
1880 SOUND 1,100,2,5:GOTO 1950
1890 ax=((X+Y)*2)-6:by=(12+Y)-X:ADD=(FN PO(AX,BY))+2:RETURN
1900 REM ::::::::::::::::::::::::
1910 REM :                      :
1920 REM :   DALLES  SPECIALES  :
1930 REM :                      :
1940 REM ::::::::::::::::::::::::
1950 IF ex=9 THEN ex=0:GOTO 1990
1960 IF je(x,y)=8 THEN SOUND 2,80,50,4,,5:GOTO 1520
1970 IF je(x,y)=1 OR je(x,y)=0 THEN fin=1:GOTO 1350
1980 IF tst=1 THEN 2160 ELSE 1350
1990 ON ss GOTO 2000,2030,2060,2090
2000 x1=x-1:y1=y
2010 ax=(x1+y1-3)*2:by=(13+y1)-x1:CALL &A0CB,FN po(ax,by),pl(9)
2020 je(x1,y1)=1:GOTO 1950
2030 CALL &A069,add:x1=x:y1=y-1:ax=(x1+y1-3)*2:by=(13+y1)-x1
2040 CALL &A0CB,FN po(ax,by),pl(9):je(x1,y1)=1
2050 CALL &A049,add:CALL &A00C,add,sp(3):GOTO 1950
2060 CALL &A069,add:x1=x+1:y1=y:ax=(x1+y1-3)*2:by=(13+y1)-x1
2070 CALL &A0CB,FN po(ax,by),pl(9):je(x1,y1)=1
2080 CALL &A049,add:CALL &A00C,add,sp(1):GOTO 1950
2090 x1=x:y1=y+1:GOTO 2010
2100 REM ::::::::::::::::::::::::
2110 REM :                      :
2120 REM :      LES BOMBES      :
2130 REM :                      :
2140 REM ::::::::::::::::::::::::
2150 REM ::: TEST SI PLUS DE BOMBES :::
2160 tst=0:fini=0:FOR g=2 TO 8:FOR h=2 TO 8:a=je(h,g)
2170 IF a=5 OR a=6 OR a=7 THEN fini=1
2180 NEXT h,g:IF fini=0 THEN gan=1:fin=1:GOTO 1350 ELSE 1350
2190 REM ::: AMORCE LES BOMBES :::
2200 IF FEU=1 THEN 1350
2210 FS=JE(X,Y):IF FS<5 OR FS>7 THEN 1350
2220 FEU=1:CLS #3:FF=3:FX=X:FY=Y:CALL &A0CB,&C092,PL(FS)
2230 A$="03":ZL=34:YL=4:GOSUB 660:A$="MISE A FEU":GOSUB 1240
2240 EVERY 20,3 GOSUB 2460:GOTO 1350
2250 REM ::: LES BOMBES EXPLOSES :::
2260 MU=REMAIN(3):FEU=0:BOUM=0:FIN=0:bb=0
2270 CALL &A0CB,&C092,PL(FS):CALL &A0CB,&C092,PL(10)
2280 A$=" BOUM @@@ ":GOSUB 1240
2290 ON FS-4 GOTO 2300,2500,2660
2300 kx=fx:ky=fy:GOSUB 2310:GOSUB 1220:tst=1:GOTO 1950
2310 en=0:IF kx=x AND ky=y THEN en=1:GOTO 2350
2320 IF kx=x AND ky+1=y THEN en=1:GOTO 2350
2330 IF kx-1=x AND ky=y THEN en=1:GOTO 2350
2340 IF kx-1=x AND ky+1=y THEN en=1
2350 IF en=1 THEN CALL &A069,add
2360 ax=(kx+ky-3)*2:by=(13+ky)-kx
2370 CALL &A0CB,FN po(ax,by),pl(fs)
2380 IF en=1 THEN CALL &A049,add:CALL &A00C,ADD,SP(AC)
2390 SOUND 4,0,-1,15,3,,30
2400 CALL &A0CB,FN po(ax,by),pl(10):FOR T=1 TO 200:NEXT
2410 CALL &A0CB,FN po(ax,by),pl(10)
2420 CALL &A0CB,FN po(ax,by),pl(11):FOR T=1 TO 200:NEXT
2430 CALL &A0CB,FN po(ax,by),pl(11):JE(kX,kY)=1
2440 RETURN
2450 REM ::: COMPTEUR AVANT EXPLOSION :::
2460 DI:FF=FF-1:A$=STR$(FF):A$=RIGHT$(A$,LEN(A$)-1):ZL=35:YL=4:GOSUB 660
2470 DI:A$=STR$(FF):A$=RIGHT$(A$,LEN(A$)-1):ZL=35:YL=4:GOSUB 660
2480 IF FF=0 THEN FIN=1:BOUM=1:EI:RETURN ELSE EI:RETURN
2490 REM ::: CALCULS POUR GROSSES BOMBES :::
2500 fs=6:kx=fx:ky=fy:GOSUB 2310:IF je(x,y)=1 THEN CALL &BCA7:GOTO 1950
2510 DATA 4,-1,0,1,0,0,-1,0,1
2520 RESTORE 2510:READ nnn
2530 FOR h=1 TO nnn:READ pl,us
2540 IF je(fx+pl,fy+us)=3 THEN 2580
2550 IF je(fx+pl,fy+us)=7 THEN je(fx+pl,fy+us)=27:GOTO 2580
2560 IF je(fx+pl,fy+us)=6 THEN je(fx+pl,fy+us)=26:GOTO 2580
2570 IF je(fx+pl,fy+us)>1 AND je(fx+pl,fy+us)<10 THEN fs=je(fx+pl,fy+us):kx=fx+pl:ky=fy+us:GOSUB 2310
2580 NEXT h:IF je(x,y)=1 THEN CALL &BCA7:GOTO 1950
2590 FOR g=2 TO 8:FOR h=2 TO 8
2600 IF je(h,g)=26 THEN bb=1:fx=h:fy=g
2610 NEXT h,g:IF bb=1 THEN bb=0:GOTO 2500
2620 FOR g=2 TO 8:FOR h=2 TO 8
2630 IF je(h,g)=27 THEN bb=1:fx=h:fy=g
2640 NEXT h,g:IF bb=1 THEN bb=0:GOTO 2660
2650 CALL &BCA7:GOSUB 1220:tst=1:GOTO 1950
2660 fs=7:kx=fx:ky=fy:GOSUB 2310:IF je(x,y)=1 THEN CALL &BCA7:GOTO 1950
2670 DATA 8,-1,-1,1,1,1,-1,-1,1,-1,0,1,0,0,-1,0,1
2680 RESTORE 2670:READ nnn:GOTO 2530
2690 REM ::::::::::::::::::::::::
2700 REM :                      :
2710 REM :     FIN DE PARTIE    :
2720 REM :                      :
2730 REM ::::::::::::::::::::::::
2740 mu=REMAIN(3):IF BOUM=1 THEN 2260
2750 IF gan=1 THEN 2770 ELSE 2860
2760 REM ::: GAGNE :::
2770 IF FON=0 THEN 2820
2780 POKE &A0D8,32:POKE &A0E2,0:CALL &A0CB,&E372,&94C0
2790 SOUND 1,0,15,15,10,,15:FOR h=2 TO 7:FOR g=2 TO 6
2800 CALL &A0CB,FN pla(h,g),&94C0:sc=sc+1:GOSUB 2980
2810 SOUND 1,0,15,15,10,,15:NEXT g,h:GOTO 2830
2820 FOR H=1 TO 25:SC=SC+1:GOSUB 2980:SOUND 1,0,15,15,10,,15:NEXT H:CLS #6
2830 GOSUB 2980:IF sc>rec THEN rec=sc:GOSUB 3040
2840 ta=ta+1:POKE &A0D8,16:POKE &A0E2,&AE:GOTO 750
2850 REM ::: PERDU :::
2860 CALL &A095,add,sp(ac):FOR h=1 TO 17:CALL &A069,add
2870 CALL &A0AD:FOR t=1 TO 150:NEXT t,h
2880 CALL &A069,add:vie=vie-1:GOSUB 3100
2890 SOUND 4,1200,0,0,14,14:SOUND 4,0,20,2,,,10
2900 FOR h=1000 TO 1500 STEP 100:SOUND 4,h,30,0,15,15:NEXT
2910 IF vie=0 THEN ta=1:GOSUB 3200:vie=3:sc=0:GOTO 380
2920 GOTO 750
2930 REM ::::::::::::::::::::::::
2940 REM :                      :
2950 REM :   GESTION COMPTEURS  :
2960 REM :                      :
2970 REM ::::::::::::::::::::::::
2980 IF sc=0 THEN a$="000000":ZL=32:YL=9:GOSUB 660:RETURN
2990 a$=STR$(sc):A$=RIGHT$(A$,LEN(A$)-1)
3000 IF sc<10 THEN ZL=35:YL=9:GOSUB 660:RETURN
3010 IF sc<100 THEN ZL=34:YL=9:GOSUB 660:RETURN
3020 IF sc<1000 THEN ZL=33:YL=9:GOSUB 660:RETURN
3030 ZL=32:YL=9:GOSUB 660:RETURN
3040 IF REC=0 THEN a$="000000":ZL=32:YL=14:GOSUB 660:RETURN
3050 a$=STR$(REC):A$=RIGHT$(A$,LEN(A$)-1)
3060 IF REC<10 THEN ZL=35:YL=14:GOSUB 660:RETURN
3070 IF REC<100 THEN ZL=34:YL=14:GOSUB 660:RETURN
3080 IF REC<1000 THEN ZL=33:YL=14:GOSUB 660:RETURN
3090 ZL=32:YL=14:GOSUB 660:RETURN
3100 a$=STR$(vie):A$=RIGHT$(A$,LEN(A$)-1)
3110 ZL=37:YL=19:GOSUB 660:RETURN
3120 a$=STR$(ta):A$=RIGHT$(A$,LEN(A$)-1)
3130 IF ta>9 THEN ZL=32 ELSE a$="0"+a$:ZL=32
3140 YL=23:GOSUB 660:RETURN
3150 REM ::::::::::::::::::::::::
3160 REM :                      :
3170 REM :     PRESENTATION     :
3180 REM :                      :
3190 REM ::::::::::::::::::::::::
3200 WHILE INKEY$<>"":WEND:FON=1
3210 POKE &A019,18:POKE &A021,5:POKE &A0D8,16:POKE &A0E0,8
3220 CLS:RESTORE 3240:FOR h=1 TO 43:READ x,y,ac
3230 CALL &A0CB,FN po(x,y),pl(ac):NEXT
3240 DATA 5,1,4,5,3,6,5,5,4,3,2,4,3,4,4,7,2,4,7,4,4,1,3,4,9,3,4
3250 DATA 33,1,4,33,3,7,33,5,4,31,2,4,31,4,4,35,2,4,35,4,4,29,3,4,37,3,4
3260 DATA 5,11,4,5,13,10,5,15,4,3,12,10,3,14,10,7,12,10,7,14,10,1,13,4,9,13,4
3270 DATA 33,11,10,33,13,10,33,15,10,31,12,10,31,14,10,35,12,10,35,14,10,29,13,10,37,13,10
3280 DATA 19,1,5,19,4,10,19,16,4,4,21,4,14,21,3,24,21,9,34,21,8
3290 DATA 14,8,"1 : JOYSTICK",14,10,"2 : CURSEURS",14,12,"3 : FOND:ON "
3300 DATA 7,19,"BOMBUZ 3D  BY LMC SOFTWARE"
3310 DATA 1,24,"NORMALE    BLINDEE    FELEE    GLACEE"
3320 PEN 10:LOCATE 2,9:PRINT CHR$(241)+"  "+CHR$(241):LOCATE 16,9:PRINT CHR$(241)+"  "+CHR$(241)
3330 FOR h=1 TO 5:READ zl,yl,a$:GOSUB 660:NEXT:CALL &A049,&C485
3340 ENT 1,1,1,3,1,-1,3,1,0,1,1,1,3,1,-1,3
3350 ENV 2,=10,390:ENV 1,1,15,1,1,0,1,1,0,1,12,-1,8,2,-1,20
3360 EVERY 35,2 GOSUB 3490
3370 CALL &A00C,&C485,SP(1)
3380 FOR t=1 TO 400:NEXT:CALL &A069,&C485
3390 CALL &A00C,&C485,SP(2)
3400 FOR t=1 TO 400:NEXT:CALL &A069,&C485
3410 t$=INKEY$:IF t$="" THEN 3370 ELSE 3420
3420 IF T$="1" THEN GA=74:DA=75:HA=72:FE=76:GOTO 3470
3430 IF T$="2" THEN GA=8:DA=1:HA=0:FE=9:GOTO 3470
3440 IF T$="3" AND FON=0 THEN FON=1:zl=14:YL=12:A$="3 : FOND:ON ":GOSUB 660:GOTO 3410
3450 IF T$="3" AND FON=1 THEN FON=0:zl=14:YL=12:A$="3 : FOND:OFF":GOSUB 660:GOTO 3410
3460 GOTO 3410
3470 mu=REMAIN(2):CALL &BCA7:CLS:ta=INT(RND*4)+1
3480 IF ta>1 THEN ta=(ta-1)*8:RETURN ELSE RETURN
3490 mus=INT(RND*16)+1:SOUND 2,note(mus),32,11,1
3500 mus=INT(RND*16)+1:SOUND 2,note(mus),32,11,1
3510 mus=INT(RND*11)+1:SOUND 4,note(mus),64,,2:RETURN
3520 REM ::::::::::::::::::::::::
3530 REM :                      :
3540 REM :   DATA 32 TABLEAUX   :
3550 REM :                      :
3560 REM ::::::::::::::::::::::::
3570 DATA 0000000,0800800,8540580,0044400,0449000,8504580,0800800,5,5
3580 DATA 0000000,0400000,0608480,0694640,0608440,0400000,0000000,3,3
3590 DATA 0006474,0004746,0007444,6476849,4744000,4674000,5446000,6,2
3600 DATA 0744440,4475674,4756474,4466744,4756756,4456474,4446744,3,8
3610 DATA 0466664,4449464,4580854,7900097,4780874,4479744,4447440,8,4
3620 DATA 0745666,6500006,6000006,6044446,6000006,3000073,5635730,5,5
3630 DATA 0449080,4854445,6444447,9748984,4449844,4845479,7449440,6,5
3640 DATA 0300456,8934500,0060708,0934567,0006605,8795700,0498630,7,8
3650 DATA 0070494,4940704,6040404,4049404,4040707,6940494,4079400,2,5
3660 DATA 0666445,3444588,3474486,3447446,3944746,3944476,3964440,2,3
3670 DATA 0599595,4995959,9579799,5593955,9999999,9559559,5995990,2,3
3680 DATA 0888784,4868888,8886848,8788884,8884888,8788884,4858640,2,3
3690 DATA 0666666,4674647,9047474,5070706,4476464,4744744,7007070,2,3
3700 DATA 0444444,4474000,7649884,0006447,4948856,6006404,4300470,6,2
3710 DATA 0040400,4047464,4040440,7040460,4490044,0000090,4464640,2,6
3720 DATA 0855885,8644645,4409095,4696944,8404044,4797974,8874740,2,5
3730 DATA 0388865,7495949,4447464,7488444,4488464,6998649,4994940,5,7
3740 DATA 0464647,5900005,4444444,0030004,4744693,8000900,6498600,5,6
3750 DATA 0400049,4640568,0430044,4645864,0444484,4797974,4444440,6,5
3760 DATA 0505558,0498948,4988954,4847887,8584644,8846444,5999480,7,6
3770 DATA 0400040,4649464,0840040,0800040,0800090,4649464,0400040,4,7
3780 DATA 0888888,8474468,8488848,8987848,8488848,8749478,8888880,5,5
3790 DATA 0004500,0004400,4446445,4748464,0004800,0008400,4644500,6,3
3800 DATA 0474344,4744474,3748843,4474834,3447474,6444448,4464880,8,5
3810 DATA 0444444,4744747,4474449,4447448,4444749,4644464,0499940,5,6
3820 DATA 0446494,4644444,4447474,6444444,4446449,4644464,0455850,8,5
3830 DATA 0449443,6474744,0845480,9848489,0845480,4474745,3443440,3,3
3840 DATA 0889886,9447449,3444446,6444643,9454443,9464749,0888880,5,4
3850 DATA 0457444,4544449,4484847,7468869,4400048,4788848,4444640,5,4
3860 DATA 0889488,8745487,7460088,3606043,3400787,7343484,7887330,4,7
3870 DATA 0889889,7888888,4888388,8899898,9888889,8888888,8889880,5,5
3880 DATA 0599595,4995959,0430044,4645864,0444749,4644464,0499940,5,6