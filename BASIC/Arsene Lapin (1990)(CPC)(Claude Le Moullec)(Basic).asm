10 REM  :::::::::::::::::::::::::
20 REM  :                       :
30 REM  :   CLAUDE LE MOULLEC   :
40 REM  :                       : 
50 REM  :    83 RUE J CURIE     :
60 REM  :                       :
70 REM  :    22420 PLOUARET     :
80 REM  :                       : 
90 REM  :   TEL  96 38 94 24    :
100 REM :                       : 
110 REM :::::::::::::::::::::::::
120 SYMBOL AFTER 200  
130 SYMBOL 221,0,138,142,138,138,138,234,0 
140 SYMBOL 222,0,224,128,128,128,128,224,0  
150 SYMBOL 223,0,238,138,138,234,42,238,0  
160 SYMBOL 224,0,238,132,132,196,132,132,0 
170 SYMBOL 225,0,174,170,170,174,234,170,0  
180 SYMBOL 226,0,238,168,232,204,168,174,0   
190 MEMORY &9EFE:LOAD "roulapin",&9EFF     
200 RESTORE 210:FOR h=&A350 TO &A368:READ a$:POKE h,VAL("&"+a$):NEXT  
210 DATA 21,A2,C0,06,B0,C5,E5,06,4C,C5,3E,00,77,23,C1,10,F8,E1,CD,34,A3,C1,10,ED,C9
220 GOSUB 4120:MODE 0:BORDER 0  
230 RESTORE 240:FOR h=0 TO 15:READ a:INK h,a:NEXT
240 DATA 0,3,2,11,9,24,3,6,0,16,6,13,26,24,9,18
250 DEF FN po(x,y)=&C002+(y-1)*80+(x-1)*4
260 IF PEEK(&A340)=1 THEN ga=8:da=1:ht=0:ba=2:fe=9 ELSE ga=74:da=75:ht=72:ba=73:fe=76
270 DIM sp(15):FOR h=0 TO 14:sp(h+1)=&9F70+(h*64):NEXT
280 FOR h=&A1F0 TO &A1F0+63:POKE h,0:NEXT
290 DIM jeu(21,13):DIM a1$(11)
300 TR$=CHR$(22)+CHR$(1)
310 NR$=CHR$(22)+CHR$(0)
320 TEMPS=150:SC=0:clee=0:tt=150:FIN=0:VIE=5:ta=1
330 ENV 1,100,3,1:ENT 1,100,2,2
340 ENV 2,10,-1,2:ENT 2,10,-2,2
350 ON BREAK GOSUB 4090
360 REM :::: DESSIN BASE ::::
370 FOR h=1 TO 23 STEP 2
380 CALL &A30C,FN po(1,h)-2,sp(7)
390 CALL &A30C,FN po(20,h)-2,sp(7)
400 NEXT h
410 FOR h=1 TO 20
420 CALL &A30C,FN po(h,1)-2,sp(7)
430 CALL &A30C,FN po(h,24)-2,sp(7):NEXT h
440 GOSUB 3260:GOSUB 450:GOTO 490
450 CALL &A350
460 FOR g=1 TO 21:jeu(g,1)=10:jeu(g,13)=10:NEXT g
470 FOR g=1 TO 13:jeu(1,g)=10:jeu(21,g)=10:NEXT g:RETURN
480 REM :::: BRANCHEMENT ::::
490 ON TA GOTO 510,530,550,570,590,610,630,650,670,690,710,730,750,770,790,810,830,850,870,890,910
500 GOTO 510:ON BREAK GOSUB 3270 
510 RESTORE 3290:GOSUB 930:ca=2
520 PEN 1:LOCATE 1,1:PRINT"A/1  0/3  200  00000":GOSUB 3060:GOTO 1210 
530 RESTORE 3330:GOSUB 930
540 PEN 1:LOCATE 1,1:PRINT"A/2  0/2  200  00000":GOSUB 3060:GOTO 1210
550 RESTORE 3370:GOSUB 930:ca=1
560 PEN 1:LOCATE 1,1:PRINT"A/3  0/3  200  00000":GOSUB 3060:TEMPS=200:nbkey=3:ch=1:GOTO 1210   
570 RESTORE 3410:GOSUB 930:ca=2
580 PEN 1:LOCATE 1,1:PRINT"A/4  0/4  200  00000":GOSUB 3060:nbkey=0:GOTO 1210
590 RESTORE 3450:GOSUB 930:ca=1
600 PEN 1:LOCATE 1,1:PRINT"A/5  0/5  200  00000":GOSUB 3060:GOTO 1210  
610 RESTORE 3490:GOSUB 930:ca=2
620 PEN 1:LOCATE 1,1:PRINT"B/1  0/14 200  00000":GOSUB 3060:GOTO 1210
630 RESTORE 3530:GOSUB 930:ca=3
640 PEN 1:LOCATE 1,1:PRINT"B/2  0/2  200  00000":GOSUB 3060:GOTO 1210  
650 RESTORE 3570:GOSUB 930:ca=1
660 PEN 1:LOCATE 1,1:PRINT"B/3  0/4  200  00000":GOSUB 3060:nbkey=4:ch=2:GOTO 1210    
670 RESTORE 3610:GOSUB 930:ca=0
680 PEN 1:LOCATE 1,1:PRINT"B/4  0/4  200  00000":GOSUB 3060:nbkey=0:GOTO 1210 
690 RESTORE 3650:GOSUB 930:ca=2
700 PEN 1:LOCATE 1,1:PRINT"B/5  0/5  200  00000":GOSUB 3060:GOTO 1210 
710 RESTORE 3690:GOSUB 930:ca=4
720 PEN 1:LOCATE 1,1:PRINT"C/1  0/3  200  00000":GOSUB 3060:GOTO 1210 
730 RESTORE 3730:GOSUB 930:ca=1
740 PEN 1:LOCATE 1,1:PRINT"C/2  0/4  200  00000":GOSUB 3060:GOTO 1210 
750 RESTORE 3770:GOSUB 930:ca=1
760 PEN 1:LOCATE 1,1:PRINT"C/3  0/4  200  00000":GOSUB 3060:nbkey=4:ch=2:GOTO 1210    
770 RESTORE 3810:GOSUB 930:ca=2
780 PEN 1:LOCATE 1,1:PRINT"C/4  0/6  200  00000":GOSUB 3060:TEMPS=200:nbkey=0:GOTO 1210 
790 RESTORE 3850:GOSUB 930
800 PEN 1:LOCATE 1,1:PRINT"C/5  0/6  200  00000":GOSUB 3060:GOTO 1210 
810 RESTORE 3890:GOSUB 930:ca=1
820 PEN 1:LOCATE 1,1:PRINT"D/1  0/5  200  00000":GOSUB 3060:GOTO 1210 
830 RESTORE 3930:GOSUB 930:ca=2
840 PEN 1:LOCATE 1,1:PRINT"D/2  0/8  200  00000":GOSUB 3060:GOTO 1210 
850 RESTORE 3970:GOSUB 930:ca=1
860 PEN 1:LOCATE 1,1:PRINT"D/3  0/3  200  00000":GOSUB 3060:nbkey=3:ch=2:GOTO 1210   
870 RESTORE 4010:GOSUB 930:ca=2
880 PEN 1:LOCATE 1,1:PRINT"D/4  0/4  200  00000":GOSUB 3060:nbkey=0:GOTO 1210
890 RESTORE 4050:GOSUB 930
900 PEN 1:LOCATE 1,1:PRINT"5/5  0/5  200  00000":GOSUB 3060:GOTO 1210 
910 TA=1:GOTO 490
920 REM :::: DESSIN TABLEAU ::::
930 spt=8:cx=4:GOSUB 940:spt=7:cx=5:GOSUB 940:GOTO 1100
940 FOR h=1 TO 11:READ a1
950 a1$(h)=BIN$(a1,10):NEXT h
960 FOR h=1 TO 11:IF a1$(h)="0000000000" THEN 1010
970 FOR g=1 TO 10
980 b1$=MID$(a1$(h),g,1):b1=VAL(b1$)
990 IF b1=1 THEN CALL &A30C,FN po(g,(h*2)+1),sp(spt):jeu(g+1,h+1)=cx
1000 NEXT g
1010 SOUND 1,INT(RND*600)+60,5,15:NEXT h
1020 FOR h=1 TO 11:READ a1
1030 a1$(h)=BIN$(a1,9):NEXT h
1040 FOR h=1 TO 11:IF a1$(h)="000000000" THEN 1090
1050 FOR g=1 TO 9
1060 b1$=MID$(a1$(h),g,1):b1=VAL(b1$)
1070 IF b1=1 THEN CALL &A30C,FN po(g+10,(h*2)+1),sp(spt):jeu(g+11,h+1)=cx
1080 NEXT g
1090 SOUND 1,INT(RND*600)+60,5,15:NEXT h:RETURN
1100 READ ptx,pty:CALL &A30C,FN po(ptx,pty),sp(10):jeu(ptx+1,pty/2)=5
1110 READ nbkey:FOR h=1 TO nbkey
1120 READ a,b:CALL &A30C,FN po(a,b),sp(9):jeu(a+1,b/2)=3
1130 NEXT h
1140 READ x,y:CALL &A30C,FN po(x,y),sp(5):jeu(x+1,(y+1)/2)=1
1150 m1=0:n1=0:READ mons:IF mons=0 THEN RETURN
1160 IF mons=1 THEN tt=50:GOTO 1190 ELSE tt=10
1170 READ nx,ny:CALL &A30C,FN po(nx,ny),sp(14)
1180 sn=1:n1=1:EVERY 850,1 GOSUB 3050
1190 READ mx,my:CALL &A30C,FN po(mx,my),sp(13)
1200 sm=1:m1=1:EVERY 950,2 GOSUB 3020:RETURN
1210 EVERY 250,0 GOSUB 3090:SOUND 2,50,0,15,2,2,31
1220 REM :::: ENTREE ORDRES ::::
1230 IF m1=1 THEN GOSUB 2420
1240 IF n1=1 THEN GOSUB 2700
1250 IF FIN=1 THEN 3160
1260 IF INKEY(ga)=0 THEN sens=1:GOTO 1350
1270 IF INKEY(da)=0 THEN sens=2:GOTO 1480
1280 IF INKEY(ht)=0 THEN 1710
1290 IF INKEY(ba)=0 THEN 1880
1300 IF INKEY(fe)=0 THEN 1620
1310 GOTO 1230
1320 CALL &A30C,FN po(x1,y1),sp(11)
1330 jeu(x1+1,(y1+1)/2)=0:RETURN
1340 '*****  VERS LA GAUCHE  *****
1350 x1=x:y1=y:x=x-1
1360 IF jeu(x+1,(y+1)/2)=0 THEN GOSUB 1320:GOTO 1410
1370 IF jeu(x+1,(y+1)/2)=6 THEN GOSUB 1320:GOTO 2330 
1380 IF jeu(x+1,(y+1)/2)=3 THEN GOSUB 2250:GOSUB 1320:GOTO 1410
1390 IF jeu(x+1,(y-1)/2)=0 AND jeu(x+2,(y-1)/2)=0 THEN 1400 ELSE x=x+1:GOTO 1230
1400 GOSUB 1320:y=y-2
1410 CALL &A30C,FN po(x,y),sp(2)
1420 SOUND 1,300,5,1,1,1,15
1430 FOR t=1 TO tt:NEXT
1440 CALL &A30C,FN po(x,y),sp(4)
1450 FOR t=1 TO tt:NEXT
1460 jeu(x+1,(y+1)/2)=1:IF jeu(x+1,(y+3)/2)=0 THEN 2050 ELSE 1230
1470 '*****  VERS LA DROITE  *****
1480 x1=x:y1=y:x=x+1
1490 IF jeu(x+1,(y+1)/2)=0 THEN GOSUB 1320:GOTO 1540
1500 IF jeu(x+1,(y+1)/2)=6 THEN GOSUB 1320:GOTO 2330
1510 IF jeu(x+1,(y+1)/2)=3 THEN GOSUB 2250:GOSUB 1320:GOTO 1540
1520 IF jeu(x+1,(y-1)/2)=0 AND jeu(x,(y-1)/2)=0 THEN 1530 ELSE x=x-1:GOTO 1230
1530 GOSUB 1320:y=y-2
1540 CALL &A30C,FN po(x,y),sp(1)
1550 SOUND 1,300,5,1,1,1,15
1560 FOR t=1 TO tt:NEXT
1570 CALL &A30C,FN po(x,y),sp(3)
1580 FOR t=1 TO tt:NEXT
1590 jeu(x+1,(y+1)/2)=1:IF jeu(x+1,(y+3)/2)=0 THEN 2050 ELSE 1230
1600 CALL &BB18:MODE 1:PEN 1:END
1610 REM :::: POSE CAISSES ::::
1620 ON sens GOTO 1630,1660
1630 IF jeu(x,(y+1)/2)=0 THEN 1640 ELSE 1230
1640 CALL &A30C,FN po(x-1,y),sp(8)
1650 jeu(x,(y+1)/2)=4:GOTO 1230
1660 IF jeu(x+2,(y+1)/2)=0 THEN 1670 ELSE 1230
1670 CALL &A30C,FN po(x+1,y),sp(8)
1680 SOUND 1,200,3,5
1690 REM :::: CAISSE DISPARAIT ::::
1700 jeu(x+2,(y+1)/2)=4:GOTO 1230
1710 IF jeu(x+1,(y-1)/2)=4 THEN 1730
1720 IF jeu(x+1,(y-1)/2)=3 THEN GOSUB 2250 ELSE 1230
1730 CALL &A30C,FN po(x,y),sp(11)
1740 CALL &A30C,FN po(x,y-1),sp(5)
1750 FOR t=1 TO tt/2:NEXT t
1760 SOUND 1,800,5,12,,,10
1770 CALL &A30C,FN po(x,y-1),sp(11)
1780 CALL &A30C,FN po(x,y),sp(5)
1790 FOR t=1 TO tt/2:NEXT t
1800 SOUND 1,800,5,12,,,10
1810 CALL &A30C,FN po(x,y),sp(11)
1820 CALL &A30C,FN po(x,y-2),sp(5)
1830 FOR t=1 TO tt/2:NEXT t
1840 CALL &A30C,FN po(x,y-2),sp(11)
1850 CALL &A30C,FN po(x,y),sp(5)
1860 SOUND 1,800,5,12,,,10
1870 jeu(x+1,(y-1)/2)=0:GOTO 1230
1880 IF jeu(x+1,(y+3)/2)=4 THEN 1900
1890 IF jeu(x+1,(y+3)/2)=3 THEN GOSUB 2250 ELSE 1230
1900 jeu(x+1,(y+1)/2)=0:CALL &A30C,FN po(x,y),sp(11)
1910 CALL &A30C,FN po(x,y+1),sp(5)
1920 FOR t=1 TO tt/2:NEXT t
1930 SOUND 1,700,5,12,,,10
1940 CALL &A30C,FN po(x,y+1),sp(11)
1950 CALL &A30C,FN po(x,y),sp(5)
1960 FOR t=1 TO tt/2:NEXT t
1970 CALL &A30C,FN po(x,y),sp(11)
1980 CALL &A30C,FN po(x,y+2),sp(5)
1990 FOR t=1 TO tt/2:NEXT t
2000 SOUND 1,700,5,12,,,10
2010 y=y+2:jeu(x+1,(y+1)/2)=1
2020 SOUND 1,700,5,12,,,10
2030 IF jeu(x+1,(y+3)/2)=0 THEN 2050 ELSE 1230
2040 REM :::: DESCENTE EN BALLON ::::    
2050 jeu(x+1,(y+1)/2)=0:tby=(y+3)/2:tom=0
2060 IF jeu(x+1,tby)=0 THEN tom=tom+1 ELSE 2080
2070 tby=tby+1:GOTO 2060
2080 IF tom=1 THEN 2180
2090 FOR h=1 TO tom*2
2100 SOUND 1,46+(h*10),3,5
2110 CALL &A30C,FN po(x,y),sp(11)
2120 IF y>4 AND h>2 THEN CALL &A30C,FN po(x,y-1),sp(12)
2130 y=y+1:CALL &A30C,FN po(x,y),sp(5)
2140 FOR t=1 TO tt:NEXT t
2150 IF y>4 AND h>2 THEN CALL &A30C,FN po(x,y-2),sp(11)
2160 NEXT h
2170 jeu(x+1,(y+1)/2)=1:GOTO 2230
2180 IF sens=1 THEN spt=4 ELSE spt=3
2190 CALL &A30C,FN po(x,y),sp(11)
2200 y=y+2:CALL &A30C,FN po(x,y),sp(spt)
2210 FOR t=1 TO tt:NEXT t
2220 jeu(x+1,(y+1)/2)=1
2230 IF jeu(x+1,(y+3)/2)=8 OR jeu(x+1,(y+3)/2)=9 THEN 3160 ELSE 1230
2240 REM :::: RAMASSE SACS ::::
2250 clee=clee+1:IF nbkey>9 THEN 2280
2260 PEN 0:LOCATE 6,1:PRINT CHR$(143):PEN 1:LOCATE 5,1:PRINT TR$;clee
2270 SC=SC+1:GOSUB 3060:GOTO 2290
2280 PEN 0:LOCATE 5,1:PRINT CHR$(143)+CHR$(143):PEN 1:LOCATE 4,1:PRINT TR$;clee:GOTO 2270
2290 IF clee=nbkey THEN 2300 ELSE RETURN
2300 SOUND 1,2056,60,15
2310 CALL &A30C,FN po(ptx,pty),sp(6):jeu(ptx+1,pty/2)=6:RETURN
2320 REM :::: GAGNE ::::
2330 FOR h=0 TO 3:mu=REMAIN(h):NEXT
2340 CALL &A30C,FN po(ptx,pty),sp(10)
2350 SOUND 1,2056,60,15:FOR t=1 TO 1000:NEXT t
2360 INK 15,18,0:FOR h=1 TO 20
2370 SOUND 1,h*10,10,14:NEXT h
2380 TEMPS=200:clee=0:INK 15,0:ta=ta+1:IF ta=41 THEN ta=1:ca=0
2390 ERASE jeu:DIM jeu(21,13):GOSUB 450
2400 GOTO 490
2410 REM :::: LES GARDIENS :::::
2420 mx1=mx:my1=my
2430 ON sm GOTO 2440,2540,2600,2650
2440 mx=mx+1:IF jeu(mx+1,(my+1)/2)=1 THEN 3160
2450 IF jeu(mx+1,(my+1)/2)=0 THEN 2500
2460 IF jeu(mx+1,(my+1)/2)=4 AND ca1>0 THEN ca1=ca1-1:jeu(mx+1,(my+1)/2)=0:GOSUB 2480:GOTO 2490
2470 mx=mx-1
2480 sm=INT(RND*4)+1:IF sm=1 OR sm=3 THEN 2480 ELSE RETURN
2490 SOUND 2,50,0,15,2,2,31
2500 CALL &A30C,FN po(mx1,my1),sp(11)
2510 jeu(mx1+1,(my1+1)/2)=0
2520 CALL &A30C,FN po(mx,my),sp(13)
2530 jeu(mx+1,(my+1)/2)=8:RETURN
2540 my=my+2:IF jeu(mx+1,(my+1)/2)=1 THEN 3160
2550 IF jeu(mx+1,(my+1)/2)=0 THEN 2500
2560 IF jeu(mx+1,(my+1)/2)=4 AND ca1>0 THEN ca1=ca1-1:jeu(mx+1,(my+1)/2)=0:GOSUB 2580:GOTO 2490
2570 my=my-2
2580 sm=INT(RND*4)+1:IF sm=2 OR sm=4 THEN 2580 ELSE RETURN
2590 GOTO 2500
2600 mx=mx-1:IF jeu(mx+1,(my+1)/2)=1 THEN 3160
2610 IF jeu(mx+1,(my+1)/2)=0 THEN 2500
2620 IF jeu(mx+1,(my+1)/2)=4 AND ca1>0 THEN ca1=ca1-1:jeu(mx+1,(my+1)/2)=0:GOSUB 2640:GOTO 2490
2630 mx=mx+1
2640 sm=INT(RND*4)+1:IF sm=3 OR sm=1 THEN 2640 ELSE RETURN
2650 my=my-2:IF jeu(mx+1,(my+1)/2)=1 THEN 3160
2660 IF jeu(mx+1,(my+1)/2)=0 THEN 2500
2670 IF jeu(mx+1,(my+1)/2)=4 AND ca1>0 THEN ca1=ca1-1:jeu(mx+1,(my+1)/2)=0:GOSUB 2690:GOTO 2490
2680 my=my+2
2690 sm=INT(RND*4)+1:IF sm=4 OR sm=2 THEN 2690 ELSE RETURN
2700 nx1=nx:ny1=ny
2710 ON sn GOTO 2720,2830,2900,2960
2720 nx=nx+1:IF jeu(nx+1,(ny+1)/2)=1 THEN 3160
2730 IF jeu(nx+1,(ny+1)/2)=0 THEN 2790
2740 IF jeu(nx+1,(ny+1)/2)=4 AND ca>0 THEN ca=ca-1:jeu(nx+1,(ny+1)/2)=0:GOSUB 2770:GOTO 2780
2750 IF ch>0 AND jeu(nx+1,(ny+1)/2)=8 THEN GOSUB 3120
2760 nx=nx-1
2770 sn=INT(RND*4)+1:IF sn=1 OR sn=3 THEN 2770 ELSE RETURN
2780 SOUND 2,50,0,15,2,2,31
2790 CALL &A30C,FN po(nx1,ny1),sp(11)
2800 jeu(nx1+1,(ny1+1)/2)=0
2810 CALL &A30C,FN po(nx,ny),sp(14)
2820 jeu(nx+1,(ny+1)/2)=9:RETURN
2830 ny=ny+2:IF jeu(nx+1,(ny+1)/2)=1 THEN 3160
2840 IF jeu(nx+1,(ny+1)/2)=0 THEN 2790
2850 IF jeu(nx+1,(ny+1)/2)=4 AND ca>0 THEN ca=ca-1:jeu(nx+1,(ny+1)/2)=0:GOSUB 2880:GOTO 2780
2860 IF ch>0 AND jeu(nx+1,(ny+1)/2)=8 THEN GOSUB 3120
2870 ny=ny-2
2880 sn=INT(RND*4)+1:IF sn=2 OR sn=4 THEN 2880 ELSE RETURN
2890 GOTO 2790
2900 nx=nx-1:IF jeu(nx+1,(ny+1)/2)=1 THEN 3160
2910 IF jeu(nx+1,(ny+1)/2)=0 THEN 2790
2920 IF jeu(nx+1,(ny+1)/2)=4 AND ca>0 THEN ca=ca-1:jeu(nx+1,(ny+1)/2)=0:GOSUB 2950:GOTO 2780
2930 IF ch>0 AND jeu(nx+1,(ny+1)/2)=8 THEN GOSUB 3120
2940 nx=nx+1
2950 sn=INT(RND*4)+1:IF sn=3 OR sn=1 THEN 2950 ELSE RETURN
2960 ny=ny-2:IF jeu(nx+1,(ny+1)/2)=1 THEN 3160
2970 IF jeu(nx+1,(ny+1)/2)=0 THEN 2790
2980 IF jeu(nx+1,(ny+1)/2)=4 AND ca>0 THEN ca=ca-1:jeu(nx+1,(ny+1)/2)=0:GOSUB 3010:GOTO 2780
2990 IF ch>0 AND jeu(nx+1,(ny+1)/2)=8 THEN GOSUB 3120
3000 ny=ny+2
3010 sn=INT(RND*4)+1:IF sn=4 OR sn=2 THEN 3010 ELSE RETURN
3020 sm=INT(RND*4)+1:ca1=ca:RETURN
3030 'TEL:96.38.94.24
3040 REM :::: GESTION COMPTEURS ::::
3050 sn=INT(RND*4)+1:ca=ca:RETURN
3060 PEN 0:IF SC>99 THEN LOCATE 16,1:PRINT CHR$(143)+CHR$(143)+CHR$(143):PEN 1:LOCATE 15,1:PRINT TR$;SC;NR$:RETURN
3070 IF SC>9 THEN LOCATE 17,1:PRINT CHR$(143)+CHR$(143):PEN 1:LOCATE 16,1:PRINT TR$;SC;NR$:RETURN
3080 LOCATE 18,1:PRINT CHR$(143):PEN 1:LOCATE 17,1:PRINT TR$;SC;NR$:RETURN
3090 DI:TEMPS=TEMPS-5:PEN 1:LOCATE 10,1:PRINT NR$;TEMPS:PRINT CHR$(7)
3100 IF TEMPS<5 THEN FIN=1:EI:RETURN
3110 EI:RETURN
3120 chx=INT(RND*18)+1:chy=INT(RND*11)+1:IF jeu(chx,chy)<>0 THEN 3120
3130 FOR sd=1 TO 15:SOUND 1,50-sd,1,5:NEXT
3140 CALL &A30C,FN po(chx-1,(chy*2)-1),sp(9):ch=ch-1:jeu(chx,chy)=3:RETURN
3150 REM :::: PERDU ::::
3160 FOR h=0 TO 3:mu=REMAIN(h):NEXT h
3170 FIN=0
3180 VIE=VIE-1:BORDER 26:INK 0,26:INK 1,26:INK 2,26
3190 OUT &BC00,2:OUT &BD49,49:SOUND 4,1500,50,7,0,0,10:OUT &BC00,2:OUT &BD49,46
3200 FOR t=1 TO 4000:NEXT t
3210 BORDER 0:INK 0,0:INK 1,26:INK 2,13:ca1=0:ca=0
3220 GOSUB 3260:ERASE jeu:ERASE a1$:DIM jeu(21,13):DIM a1$(11)
3230 FOR t=1 TO 2000:NEXT t
3240 TEMPS=150:clee=0:ca=0
3250 IF VIE=0 THEN 320 ELSE GOSUB 450:GOTO 490   
3260 PEN 1:LOCATE 1,1:PRINT" ONE  PLAYER  MAN   ":LOCATE 18,1:PRINT VIE:RETURN
3270 FIN=1:RETURN
3280 '*****  TABLEAU 1  *****  
3290 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
3300 DATA 0,1,0,0,0,512,0,1,2,4,0,0,0,0,0,0,1,0,0,256,128,64
3310 DATA 12,23,3,1,3,10,3,19,3,7,23,2,9,3,10,15
3320 '*****  TABLEAU 2  *****     
3330 DATA 0,7,0,0,0,0,0,7,7,0,0,0,384,0,0,0,0,0,384,384,0,0
3340 DATA 256,264,392,136,128,128,136,136,136,248,0,66,66,70,66,2,2,66,66,66,126,0
3350 DATA 12,3,2,3,5,17,5,10,23,1,15,5
3360 '*****  TABLEAU 3  ***** 
3370 DATA 8,0,128,256,0,512,0,256,128,0,8,64,0,4,2,0,1,0,2,4,0,64
3380 DATA 0,96,56,14,3,1,3,14,56,96,0,0,24,112,448,256,0,256,448,112,24,01
3390 DATA 11,13,2,10,9,9,13,10,23,2,6,17,14,17
3400 '*****  TABLEAU 4  ***** 
3410 DATA 0,0,0,4,0,0,96,96,96,96,64,24,24,24,24,16,0,0,0,0,0,0
3420 DATA 96,48,24,8,6,0,2,2,2,2,2,128,128,128,128,128,0,192,96,48,24,12
3430 DATA 1,3,4,6,3,17,3,2,23,15,23,18,23,1,11,23
3440 '*****  TABLEAU 5  *****   
3450 DATA 0,8,192,0,0,0,32,32,0,0,129,0,7,0,0,128,320,128,0,0,8,0
3460 DATA 0,768,1,1,144,0,2,260,384,16,16,64,64,0,24,8,0,4,8,192,1,0
3470 DATA 1,3,5,6,9,3,17,12,13,16,15,19,3,2,23,2,16,3,19,15
3480 '*****  TABLEAU 6  *****    
3490 DATA 0,0,0,0,0,0,0,0,0,0,256,0,0,0,0,0,0,0,0,0,0,0
3500 DATA 0,18,18,639,0,274,274,1023,0,146,146,0,145,144,511,0,144,144,504,16,144,128
3510 DATA 19,3,14,18,3,7,7,10,7,13,7,19,7,19,11,5,15,8,15,11,15,14,15,4,23,7,23,10,23,13,23,1,23,2,16,7,1,15
3520 '*****  TABLEAU 7  *****
3530 DATA 0,0,1023,1023,1023,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
3540 DATA 0,831,0,0,0,0,1023,0,831,0,0,0,511,0,0,0,0,499,0,511,0,0
3550 DATA 19,3,2,1,3,19,17,15,23,2,10,3,10,17
3560 '*****  TABLEAU 8  ***** 
3570 DATA 32,0,0,0,0,0,0,0,0,0,32,16,0,0,0,0,0,0,0,0,0,16
3580 DATA 0,14,17,1,65,63,65,1,17,14,0,0,448,32,0,8,480,8,0,32,448,0
3590 DATA 15,13,2,10,5,10,21,7,19,2,4,13,16,13
3600 '*****  TABLEAU 9  *****     
3610 DATA 0,0,0,0,0,3,6,0,0,0,0,0,1,0,0,384,256,0,0,0,0,0
3620 DATA 0,16,16,1011,0,0,0,1023,2,2,0,0,256,256,511,0,0,0,319,32,32,0
3630 DATA 19,3,4,1,3,18,3,1,19,19,19,15,15,2,19,7,1,23
3640 '*****  TABLEAU 10  *****  
3650 DATA 0,896,0,1,0,0,0,256,0,2,4,0,0,0,256,0,2,0,0,0,0,0
3660 DATA 0,0,0,14,8,8,8,527,0,0,1,128,0,0,224,32,33,32,480,0,0,0
3670 DATA 19,23,5,1,3,1,15,8,13,13,15,19,11,9,23,2,8,15,17,17
3680 '*****  TABLEAU 11  *****  
3690 DATA 0,0,967,967,967,960,960,960,960,960,960,0,0,399,399,399,15,15,15,15,15,15
3700 DATA 1,57,40,40,40,40,47,40,40,40,0,0,112,80,80,80,80,464,80,208,80,64
3710 DATA 12,17,3,10,13,6,23,14,23,14,3,2,6,21,14,21
3720 '*****  TABLEAU 12  *****   
3730 DATA 0,960,960,960,960,1022,1022,1022,1022,1022,0,0,8,0,128,0,64,8,0,0,32,3
3740 DATA 0,1,1,1,1,1,1,1,1,1,1,0,503,0,1,0,0,503,0,256,0,0
3750 DATA 19,23,4,2,9,9,15,19,7,11,17,3,23,2,13,9,13,19
3760 '*****  TABLEAU 13  *****    
3770 DATA 1,2,0,0,0,4,4,0,0,0,1,0,0,0,0,0,128,128,0,0,256,0
3780 DATA 0,0,1,127,1,1,1,127,1,0,0,0,1,0,504,0,0,0,504,0,0,0
3790 DATA 19,3,2,9,11,11,11,17,23,2,13,3,9,19
3800 '*****  TABLEAU 14  *****   
3810 DATA 0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,272,0,0,256,256,0,0
3820 DATA 4,962,4,960,1,1,33,33,33,33,33,64,0,64,0,0,305,0,0,0,504,0
3830 DATA 19,11,6,1,3,1,7,13,5,11,15,1,23,11,23,7,23,2,11,3,3,17
3840 '*****  TABLEAU 15  *****  
3850 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
3860 DATA 0,7,960,31,0,480,256,886,0,324,324,0,478,2,315,0,368,264,448,8,264,264
3870 DATA 19,23,6,1,5,1,9,10,3,10,11,14,17,16,7,17,3,2,1,23,19,15
3880 '*****  TABLEAU 16  ***** 
3890 DATA 0,1,0,0,0,0,0,0,8,8,8,0,510,0,0,0,0,0,1,0,0,0
3900 DATA 0,510,0,0,512,63,32,32,33,33,33,0,1,0,0,0,487,0,0,16,16,16
3910 DATA 1,9,5,1,3,19,3,19,15,10,17,15,17,7,17,1,17,23
3920 '*****  TABLEAU 17  ***** 
3930 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
3940 DATA 3,512,768,192,48,12,1,96,24,6,1,0,384,96,24,0,0,256,192,48,12,3
3950 DATA 1,3,8,12,3,19,3,14,5,1,9,10,17,18,17,12,19,9,23,17,23,2,2,5,13,5
3960 '*****  TABLEAU 18  ***** 
3970 DATA 1,2,0,0,512,512,0,0,0,0,1,0,0,0,0,4,3,0,0,0,256,0
3980 DATA 0,0,1,1,1,127,1,1,1,0,0,0,0,1,0,0,504,0,0,0,0,0
3990 DATA 19,5,1,11,15,17,23,2,5,17,17,5
4000 '*****  TABLEAU 19  *****    
4010 DATA 0,0,0,0,64,0,0,0,0,2,4,0,340,340,0,0,0,0,0,0,340,340
4020 DATA 0,24,102,65,1,32,65,65,38,24,0,0,1,0,510,0,0,0,511,0,0,0
4030 DATA 19,3,4,7,7,19,9,10,13,5,17,19,23,2,19,7,19,5
4040 '*****  TABLEAU 20  *****   
4050 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,272,272,272,272,272,0,0
4060 DATA 0,511,256,256,272,272,272,272,287,511,0,0,504,8,0,0,0,0,0,8,504,0
4070 DATA 1,23,5,7,3,6,9,12,13,14,13,13,15,9,17,2,11,3,4,17
4080 '*  BREAK  *
4090 FIN=1:RETURN
4100 'POUR LE CAS OU VOUS ETES BLOQUES;POUR NE PAS ATTENDRE LA FIN DU TEMPS IMPARTI
4110 REM :::: PRESENTATION ::::
4120 DEFINT a-z:CALL &BBFF:EVERY 25,2 GOSUB 4390
4130 LMC$=CHR$(221)+CHR$(222)+CHR$(223)+CHR$(224)+CHR$(225)+CHR$(226)  
4140 MODE 0:BORDER 0:RESTORE 4150:FOR h=0 TO 15:READ a:INK h,a:NEXT    
4150 DATA 0,4,8,17,26,15,11,20,9,3,12,6,13,24,8,18  
4160 LOCATE 1,7:FOR A=1 TO 6:PAPER CINT(A/2):PEN INT(A/2):PRINT STRING$(80,207);:NEXT:PAPER 0 
4170 WINDOW#1,1,6,23,25:CLS#1:WINDOW#1,7,16,21,25:CLS#1:WINDOW#1,2,3,19,23:CLS#1:WINDOW#1,19,19,17,25:CLS#1:FOR A=1 TO 8:PEN 0:LOCATE 21-A,17+A:PRINT CHR$(22)CHR$(1)CHR$(214)STRING$(A-1,143);:NEXT:PEN 1
4180 PLOT 250,80,0:DRAWR 0,70:PLOT 200,150:DRAWR 100,0:FOR A=0 TO 8:PLOT 196+A*12,154:DRAWR 12,-6:NEXT:FOR A=0 TO 3:PLOT 300+A*2-140*(A>1),80:DRAWR 0,60:NEXT:PLOT 300,130:DRAWR 60,-10:DRAWR 20,0:DRAWR 60,10 
4190 ORIGIN 0,0:INK 4,0:PLOT -10,-10,4:a$="ARSENE LAPIN":LOCATE 1,1:PRINT CHR$(22)+CHR$(0)
4200 TAG:FOR H=1 TO LEN(A$):B$=MID$(A$,H,1):MOVE (H*36)-36,14:PRINT B$;:NEXT:TAGOFF   
4210 ENC=5:EN2=11:Y=300:X=110  
4220 FOR G=0 TO 14 STEP 2:FOR H=0 TO 432 STEP 2 
4230 IF TEST(H,2+G)=4 THEN GOSUB 4250 
4240 NEXT H,G:LOCATE 1,25:PRINT NR$;SPACE$(18):INK 4,26:GOTO 4260 
4250 PLOT H+X,Y+(G*2),ENC:PLOT H+X,Y+2+(G*2),EN2:RETURN 
4260 PEN 0:LOCATE 1,25:PRINT SPACE$(12)
4270 FOR H=1 TO 5:MOVE 30,H:DRAW 610,H,15:NEXT:FOR H=6 TO 20:MOVE 30,H:DRAW 610,H,14:NEXT   
4280 FOR H=20 TO 22:MOVE 30,H:DRAW 610,H,11:NEXT:FOR H=1 TO 8:MOVE H,26:DRAW H,374,15:NEXT  
4290 FOR H=8 TO 20:MOVE H,26:DRAW H,374,14:NEXT:FOR H=20 TO 22:MOVE H,26:DRAW H,374,11:NEXT    
4300 FOR H=616 TO 620:MOVE H,26:DRAW H,374,11:NEXT:FOR H=620 TO 632:MOVE H,26:DRAW H,374,14:NEXT    
4310 FOR H=632 TO 636:MOVE H,26:DRAW H,374,15:NEXT:FOR H=394 TO 400:MOVE 30,H:DRAW 610,H,15:NEXT    
4320 FOR H=382 TO 392:MOVE 30,H:DRAW 610,H,14:NEXT:FOR H=378 TO 380:MOVE 30,H:DRAW 610,H,11:NEXT    
4330 X=20:FOR T=1 TO 22:MOVE T,X:DRAW T,20,15:X=X-1:NEXT T   
4340 X=380:FOR T=1 TO 22:MOVE T,X:DRAW T,380:X=X+1:NEXT T   
4350 X=380:FOR T=618 TO 636:MOVE T,380:DRAW 618,X:X=X+1:NEXT T   
4360 X=1:FOR T=618 TO 636:MOVE T,20:DRAW T,X:X=X+1:NEXT T 
4370 PLOT -10,-10,15:TAG:MOVE 32,44:PRINT lmc$;:TAGOFF:LOCATE 1,1
4380 WHILE INKEY$="":WEND:mu=REMAIN(2):CALL &BCA7:GOTO 4450
4390 DI:IF (SQ(1) AND 7)=0 THEN EI:RETURN ELSE READ p,d:IF p=-1 THEN RESTORE 4410:GOTO 4390
4400 SOUND 1,p,d,4:GOTO 4390
4410 DATA 1,41,71,50,1,8,71,50,1,8,67,50,1,8,60,50,1,8,60,50,1,30,67,50,1,8,71,50,1,8,80,50,1,8,89,50,1,8,89,50  
4420 DATA 1,8,80,50,1,8,71,50,1,8,71,50,1,12,80,33,1,8,80,83,1,12,71,50,1,8,71,50,1,8,67,50,1,8,60,50,1,8 ,60,50  
4430 DATA 1,8,67,50,1,8,71,50,1,8,80,50,1,8,89,50,1,8,89,50,1,8,80,50,1,8,71,50,1,8,80,50,1,8,89,25,89,50,-1,-1      
4440 REM :::: JOYSTICK/CLAVIER ::::
4450 MODE 1:PEN 1:PRINT:PRINT:PRINT 
4460 PRINT" JOYSTICK ................ [ J ]
4470 PRINT:PRINT:PRINT  
4480 PRINT" CLAVIER  ................ [ C ] 
4490 a$=INKEY$:IF a$="" THEN 4490
4500 a$=UPPER$(a$):IF a$="J" THEN 4520
4510 IF a$="C" THEN POKE &A340,1:RETURN
4520 RETURN