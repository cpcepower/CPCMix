10 ' *******************
20 ' **               **
30 ' * *  Z E L D A  * *
40 ' **               **
50 ' *       B Y       *
60 ' *  LE CHAT CYRIL  *
70 ' * -COPYRIGHT 1991 *
80 ' *       B Y       *
90 ' *******************
100 DIM P$(14):OUT &BC00,7:OUT &BD00,33
110 DATA 3e,00,06,00,cd,4d,bc,c9
120 DATA 3e,00,06,ff,cd,4d,bc,c9
130 '
140 ' PRESENTATION
150 '
160 FOR CO=0 TO 15:INK CO,0:NEXT:BORDER 0
170 MODE 0:MEMORY &5999:LOAD"!ZELDA.PRE",&6000
180 MEMORY 39999:LOAD"ZELDA.SCR",40000:CALL 40000:CALL &6000:POKE &9E1B,1
190 MEMORY &4000:LOAD"ZELDA.ASS",&4000
200 RESTORE 110:FOR i=1 TO 16:READ v$:POKE &7048+i,VAL("&"+v$):NEXT I
210 FOR T=1 TO 15:CALL &7049:NEXT
220 RESTORE 620:FOR CO=0 TO 15:READ COU:INK CO,COU:NEXT
230 FOR ATT=1 TO 500:NEXT:FOR T=1 TO 15:CALL &7051:NEXT
240 RESTORE 260:FOR T=1 TO 63:READ A,B:OUT &BC00,2:OUT &BD00,A:OUT &BC00,7:OUT &BD00,B:FOR U=1 TO 25:NEXT:NEXT
250 OUT &BC00,7:OUT &BD00,33
260 DATA 47,30,48,31,49,32,50,33,51,33,52,33,53,33,54,33,55,32,56,31,57,30,57,29,57,28,57,27,57,26,57,25,57,24,57,23,57,22,56,21,55,20,54,19,53,19,52,19,51,19,50,19,49,19,48,19,47,19,46,19,45,19,44,19,43,19,42,19,41,19,40,19,39,19,38,19
270 DATA 37,20,36,21,35,22,35,23,35,24,35,25,35,26,35,27,35,28,35,29,35,30,35,31,35,32,35,33,36,33,37,33,38,32,39,32,40,32,41,32,42,31,43,31,44,31,45,31,46,30
280 GOTO 310
290 ENV 1,15,-1,1:SOUND 2,200,15,15,1,0,1:RETURN
300 ENV 1,15,-1,1:SOUND 2,284,15,15,1,0,1:RETURN
310 DEFINT A-Z:AD=&4001:X=100:Y=200
320 IF PEEK(AD)=1 AND PEEK(AD+1)=1 AND PEEK(AD+2)=1 THEN X=250:Y=0:GOTO 360
330 IF PEEK(AD)=2 AND PEEK(AD+1)=2 AND PEEK(AD+2)=2 THEN X=200:Y=0:GOTO 360
340 IF PEEK(AD)=0 AND PEEK(AD+1)=0 AND PEEK(AD+2)=0 THEN 370
350 PLOT PEEK(AD)+X,PEEK(AD+1)+Y,PEEK(AD+2)
360 AD=AD+3:GOTO 320
370 DATA H,H,H,B,B,B,B,B,B,B,H,H,H,H,B,B,B,B,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,B,B,B,B,B,B,H,H,H,H,H,B,B,H,G,D,B,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,B,B,B,B,B,B,H,H,H,H,H,B,B,H,G,D,B,H,B,H,B,H,B
380 DATA B,H,B,H,B,H,B,H,B,H,B,H,B,H,B,H,B,H,H,H,G,D,G,D,G,D,G,D,G,D,G,D,G,D,G,D,G,D,G,D,G,D,G,D,G,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,D,B,G,H,D,F
390 AD=&4900
400 EVERY 30,1 GOSUB 290:EVERY 60,3 GOSUB 300:GOTO 410
410 RESTORE 370
420 EVERY 5,2 GOSUB 470
430 IF PEEK(AD)=9 THEN AD=&4900
440 SOUND 2,PEEK(AD)*3,15,15,1:AD=AD+1
450 IF INKEY$>"" THEN CLEAR:GOSUB 940:GOTO 610
460 GOTO 430
470 READ D$:IF D$="F" THEN RESTORE 370:GOTO 470
480 IF D$="D" THEN |DROITE,20,80,40,20
490 IF D$="G" THEN |GAUCHE,20,80,40,20
500 IF D$="H" THEN |HAUT,20,80,40,20
510 IF D$="B" THEN |BAS,20,80,40,20
520 IF INKEY$>"" THEN CLEAR:GOSUB 940:GOTO 610
530 D1=D1+1:IF D1>=6 AND D2=1 THEN D1=0:D2=0
540 IF D1>=6 AND D2=0 THEN D1=0:D2=1
550 IF D2=0 THEN |GAUCHE,20,110,40,20
560 IF D2=1 THEN |DROITE,20,110,40,20
570 RETURN
580 '
590 IF PEEK(AD)=9 THEN AD=&4900
600 SOUND 2,PEEK(AD)*3,15,15,1:AD=AD+1:RETURN
610 '
620 DATA 0,3,6,15,24,25,26,20,11,2,1,9,12,18,4,13
630 FOR n=1 TO 26 STEP 2:SOUND 1,20+N,1,12:LOCATE 1,1:PRINT STRING$(n,11);STRING$(26+n,10);:SOUND 1,200+N,1,12:NEXT
640 '
650 ' MENU
660 '
670 DEFINT A-Z
680 MEMORY &7FFF
690 MODE 2:INK 1,0:LOAD"!ZELDA.PRG",&C000:CALL &C000:CALL &9B00
700 CALL &BE80:CALL &9730
710 CALL &9B0F,&8D20
720 CALL &9B18,&A400
730 MODE 0:INK 1,3:MEMORY &6000-1:LOAD"!ZELDA.MEN",&6000:FOR T=0 TO 15:INK T,0:NEXT:CALL &6000:|COPY,&C000,&4000:CLEAR:DRO=1:GAU=8:BAS=2:HAU=0:FIN=47
740 DEF FN le(x,y)=&C000+(y-1)*80+(X-1)*2
750 DEF FN adr(x,y,nboctlet)=&C000+(x-1)*nboctlet+(y-1)*80
760 OUT &BC00,7:OUT &BD00,33
770 A$="LE CHAT CYRIL PRESENTE":LY=1:LOOP=0:GOSUB 1190
780 A$="<<<< VOTRE CHOIX <<<<":LY=25:LOOP=0:GOSUB 1190
790 GOSUB 1940
800 RESTORE 620:FOR CO=0 TO 15:READ COU:INK CO,COU:NEXT:BORDER 0
810 IF DRO=1 AND GAU=8 AND BAS=2 AND HAU=0 AND FIN=47 THEN Y=99:Y1=89:GOSUB 930
820 IF DRO=75 AND GAU=74 AND BAS=73 AND HAU=72 AND FIN=47 THEN Y=89:Y1=99:GOSUB 930
830 FOR T=20 TO 24:LOCATE 9,T:PRINT STRING$(10," "):NEXT
840 '
850 IF INKEY(49)=0 OR INKEY(12)=0 THEN GOSUB 1270
860 IF INKEY(56)=0 OR INKEY(20)=0 THEN GOSUB 950
870 IF INKEY(57)=0 OR INKEY(5)=0 THEN Y=99:Y1=89:GOSUB 930:DRO=1:GAU=8:BAS=2:HAU=0:FIN=47
880 |SCRDROIT,1:CALL &BD19
890 IF INKEY(65)=0 OR INKEY(14)=0 THEN Y=89:Y1=99:GOSUB 930:DRO=75:GAU=74:BAS=73:HAU=72:FIN=47
900 IF INKEY(64)=0 OR INKEY(13)=0 THEN GOSUB 1650
910 |SCRDROIT,1:CALL &BD19:GOTO 840
920 |SCRDROIT,1:CALL &BD19:RETURN
930 |LMOVE,23,60,Y:|LMOVE,31,60,Y1:RETURN
940 FOR H=1 TO 3:MU=REMAIN(H):NEXT:RETURN
950 GOSUB 940:CLS:LOAD"!ZELDA.DRT",&6000:CALL &6000
960 MEMORY &4C20-1:LOAD"!ZELDA.MUS",&4C20 
970 GOSUB 1860
980 INK 15,13,26:F$=CHR$(143)
990 '
1000 ' REDEFINIR LES TOUCHES
1010 '
1020 x=9:y=9:PE=15:GOSUB 1120:GOSUB 1070:DRO=A:PE=0:GOSUB 1120
1030 x=9:y=12:PE=15:GOSUB 1120:GOSUB 1070:GAU=A:PE=0:GOSUB 1120
1040 x=9:y=15:PE=15:GOSUB 1120:GOSUB 1070:HAU=A:PE=0:GOSUB 1120
1050 x=9:y=18:PE=15:GOSUB 1120:GOSUB 1070:BAS=A:PE=0:GOSUB 1120
1060 INK 15,13:CLS:GOSUB 940:GOTO 680
1070 A=0:CLEAR INPUT:GOSUB 1870
1080 IF INKEY$>"" THEN 1100
1090 GOSUB 1870:GOTO 1070
1100 FOR A=0 TO 79:IF INKEY(A)=0 THEN RETURN
1110 NEXT:GOTO 1070
1120 LOCATE x,y:PEN PE:PRINT F$:CALL &9730,2,26,FNadr(x,y,4):RETURN
1130 ' 
1140 OPENOUT "!ZELDA.DIR":WRITE #9,GAU,DRO,HAU,BAS:CLOSEOUT:RETURN
1150 OPENIN "!ZELDA.DIR":INPUT #9,GAU,DRO,HAU,BAS,FIN:CLOSEIN:RETURN
1160 '
1170 ' ECRITURE DU TEXTE
1180 '
1190 IF LX=0 THEN LX=20-(LEN(A$)/2):MOIN=15
1200 A$=UPPER$(A$):FOR T=1 TO LEN(A$):PS=(ASC(MID$(A$,T,1)))-48
1210 IF PS<0 OR PS>42 THEN PS=43
1220 CALL &A000,FN LE(LX,LY)+(T*2),&A020+(PS*16)
1230 NEXT:IF LOOP=1 AND LX=0 THEN H=LEN(A$)-2
1240 IF LOOP=1 AND LX>0 THEN H=LEN(A$)+2
1250 IF LOOP=1 THEN PEN 1,1:LOCATE (LX/2),Ly:PRINT STRING$(H," "):CALL &9730,2,(H*3)+3-MOIN,FNadr((LX/2),LY,4):PEN 1,0:LOOP=0:MOIN=0
1260 LX=0:RETURN
1270 '
1280 ' INSTRUCTIONS
1290 '
1300 GOSUB 940:FOR T=0 TO 15:INK T,0:NEXT:LOAD"!ZELDA.IST",&C000:CALL &C000:CLS
1310 MODE 2:INK 1,0:LOAD"!ZELDA.PRG",&C000:CALL &C000
1320 MODE 0:CALL &6000:OUT &BC00,2:OUT &BD00,46:OUT &BC00,7:OUT &BD00,30
1330 DEF FN le(x,y)=&C000+(y-1)*80+(X-1)*2
1340 A$="Z E L D A ":LY=5:LOOP=1:GOSUB 1190
1350 A$="INSTRUCTIONS":LY=9:LOOP=1:GOSUB 1190
1360 CALL &A43E,0,0,1,1:CALL &A471,1
1370 RESTORE 620:FOR CO=0 TO 15:READ COU:INK CO,COU:NEXT:FOR ATT=1 TO 500:NEXT
1380 DATA "VOUS ZELDA, DEVEZ AFFRONTER"
1390 DATA "  A VOS RISQUES ET PERILS,"
1400 DATA "  DES PASSAGES MYSTERIEUX"
1410 DATA "    DES SALLES SECRETES"
1420 DATA "   ET PRENDRE DES OBJETS"
1430 DATA "  INDISPENSABLES A VOTRE"
1440 DATA "  MISSION ET ENSUITE....."
1450 DATA "CE SERA A VOUS DE JOUER,CAR"
1460 DATA "VOUS ETES LE HEROS DE CETTE"
1470 DATA "AVENTURE.MAIS ATTENTION AUX"
1480 DATA "   GARDIENS DU CHATEAU."
1490 DATA " VITE..VITE.. SAUVEZ VOTRE"
1500 DATA "EPOUSE QUI EST PRISONNIERE"
1510 DATA "DANS LE CHATEAU D'HYRUS...."
1520 DATA ""
1530 DATA "            BONNE CHANCE...!"
1540 RESTORE 1380:X=110:Y=194:PRINT CHR$(22)+CHR$(1);:PRINT CHR$(23)+CHR$(1);:FOR I=1 TO 6:READ P$(I):GOSUB 1630:NEXT:GOSUB 1640
1550 GOSUB 1700
1560 FOR T=13 TO 20:LOCATE 1,T:PRINT STRING$(40," "):NEXT
1570 RESTORE 1440:X=110:Y=194:PRINT CHR$(22)+CHR$(1);:PRINT CHR$(23)+CHR$(1);:FOR I=1 TO 5:READ P$(I):GOSUB 1630:NEXT:GOSUB 1640
1580 GOSUB 1700
1590 FOR T=13 TO 20:LOCATE 1,T:PRINT STRING$(40," "):NEXT
1600 RESTORE 1490:X=110:Y=194:PRINT CHR$(22)+CHR$(1);:PRINT CHR$(23)+CHR$(1);:FOR I=1 TO 5:READ P$(I):GOSUB 1630:NEXT:GOSUB 1640
1610 GOSUB 1700
1620 CALL &A46E:MODE 0:CLEAR:GOTO 670
1630 TAG:PLOT -2,-2,1:MOVE X,Y:PRINT P$(I);:PLOT -2,-2,2:MOVE X+1,Y-1:PRINT P$(I);:Y=Y-20:TAGOFF:RETURN
1640 TAGOFF:PRINT CHR$(22)+CHR$(0);:PRINT CHR$(23)+CHR$(0);:RETURN
1650 '
1660 GOSUB 1130
1670 CLS:OUT &BC00,2:OUT &BD00,46:OUT &BC00,7:OUT &BD00,30:RUN"!ZELDA2
1680 RESTORE 1690:FOR h=&8000 TO &8055:READ a$:POKE h,VAL("&"+a$):NEXT:RETURN
1690 DATA F5,CD,21,80,11,0,C0,19,6,8,C5,E5,D1,23,1,4F,0,1A,ED,B0,12,1,B0,7,9,C1,10,EE,F1, 3D,20,E0,C9,DD,6E,0,DD,23,DD,23,2D,26,0,29,29,29,29,E5,D1,29,29,19,C9,F5,CD,21, 80,11,4F,C0,19,6,8,C5,E5,D1,2B,1,4F,0,1A,ED,B8,12,1,50,8,9,C1,10,EE,F1,3D,20,E0,C9
1700 RESTORE 1810
1710 ENV 2,4,0,1,7,-1,1:ENV 3,24,-1.25,0.5
1720 G=12
1730 READ C,D,N:IF C=0 AND D=0 AND N=0 THEN 1700
1740 SOUND 1,C,12,15,2:SOUND 2+16,0,12,G,3,,D
1750 SOUND 36,N,12,14,5
1760 IF D=1 THEN G=12 ELSE G=15
1770 IF D=1 THEN ENV 3,3,0,1,1,-12,1
1780 IF D=31 OR D=8 THEN G=15
1790 IF INKEY(47)=0 THEN RETURN
1800 GOTO 1730
1810 DATA 638,1,0,638,1,0,319,1,0,319,1,0,638,31,0,638,1,0,319,1,0,319,1,0,638,1,0,638,1,0,426,1,0,426,1,0,358,31,0,379,1,0,426,1,0,506,1,0
1820 DATA 638,1,0,638,1,0,319,1,119,319,1,0,638,31,106,638,1,0,319,1,119,319,1,0,638,1,127,638,1,0,426,1,159,426,1,0,358,31,127,379,1,0,426,1,159,506,1,0
1830 DATA 638,1,95,638,1,106,319,1,89,319,1,106,358,31,0,638,1,0,319,1,0,319,1,0,638,1,0,638,1,0,426,1,0,426,1,0,358,31,0,379,1,0,426,1,0,506,1,0
1840 DATA 0,0,0
1850 '
1860 ENV 1,15,-1,15:ENV 2,13,-1,6:ENV 3,15,-1,1:ENT -1,2,2,5,4,-2,5,2,2,5:AD=&4C20:RETURN
1870 S1=PEEK(AD)
1880 IF S1=253 THEN ad=ad+1:S=PEEK(AD)*3.5:ad=ad+1:t=PEEK(AD):ad=ad+1:SOUND 1,s,t*20,15,1,1:GOTO 1930
1890 IF s1=254 THEN ad=ad+1:t=PEEK(AD):ad=ad+1:SOUND 1,0,t*20,15,3,0,1:GOTO 1930
1900 IF s1=255 THEN ad=ad+1:S=PEEK(AD)*2:ad=ad+1:t=PEEK(AD):ad=ad+1:b=PEEK(AD):ad=ad+1:SOUND 1,s,t*20,15,3,1,b:GOTO 1930
1910 IF s1=252 THEN ad=ad+1:t1=PEEK(AD):ad=ad+1:SOUND 6,0,t1*20,0:GOTO 1930
1920 IF s1=251 THEN AD=&4C20
1930 RETURN
1940 RESTORE 1960:FOR H=&A000 TO &A000+75:READ A$:POKE H,VAL("&"+A$):NEXT
1950 CALL &A000:RETURN
1960 DATA 01,09,A0,21,17,A0,CD,D1,BC,0E,A0,C3,1B,A0,53,43,52,44,52,4F,49,D4,00,00,00,00,00,FE,01,C0,F5,DD,6E,00,2D,26,00
1970 DATA 06,04,29,10,FD,E5,D1,06,02,29,10,FD,19,11,00,C0,19,06,08,C5,01,4F,00,E5,D1,23,1A,ED,B0,12,01,B0,07,09,C1
1980 DATA 10,EE,F1,C9