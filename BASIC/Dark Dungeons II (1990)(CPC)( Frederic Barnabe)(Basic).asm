10 '
20 ' DARK DUNGEONS II
30 '
40 MODE 0:BORDER 0:FOR i=0 TO 13:READ a:INK i, a:NEXT:INK 15,0,6:INK 14 ,6,0
50 DATA 0,26,1,2,4,14,23,15,16,7,6, 3,3,13
60 MEMORY 24999
70 LOAD"screen",&C0B0
80 LOAD"rout",&61E0
90 '
100 '
110 POKE 25997,13
120 GOSUB 1590:tabl=1:RESTORE 2170 
130 DIM sprite(14),ta(21,12)
140 DEF FNad(x,y)=49152+y*80+x*2
150 FOR i=0 TO 14:sprite(i)=25000+i*64:NEXT
160 vitesse=80:tabl=tabl-1:vie=3:GOSUB 1890
170 '
180 '
190 '
200 IF ok=2 THEN GOSUB 1890
210 FOR i=1 TO vitesse:NEXT
220 IF cl=0 THEN j=JOY(0) ELSE GOSUB 1460
230 IF INKEY(67)=0 THEN 970
240 IF j=16 THEN 1090
250 ON j GOTO 270,380,220,600,220,220,220,490
260 GOTO 220
270 IF ja<>j THEN GOSUB 710:CALL 25576,FNad(x1,y1),sprite(2):ja=j:GOTO 210
280 x2=x1:y2=y1-2:GOSUB 750:IF ok>0 THEN 200
290 CALL 25576,FNad(x1,y1),sprite(0)
300 y1=y1-1
310 CALL 25576,FNad(x1,y1),sprite(3)
320 FOR i=1 TO vitesse:NEXT
330 CALL 25576,FNad(x1,y1),sprite(0)
340 y1=y1-1
350 CALL 25576,FNad(x1,y1),sprite(2)
360 FOR i=1 TO vitesse:NEXT
370 ja=j:GOTO 220
380 IF ja<>j THEN GOSUB 710:CALL 25576,FNad(x1,y1),sprite(4):ja=j:GOTO 210
390 x2=x1:y2=y1+2:GOSUB 750:IF ok>0 THEN 200
400 CALL 25576,FNad(x1,y1),sprite(0)
410 y1=y1+1
420 CALL 25576,FNad(x1,y1),sprite(5)
430 FOR i=1 TO vitesse:NEXT
440 CALL 25576,FNad(x1,y1),sprite(0)
450 y1=y1+1
460 CALL 25576,FNad(x1,y1),sprite(4)
470 FOR i=1 TO vitesse:NEXT
480 ja=j:GOTO 220
490 IF ja<>j THEN GOSUB 710:CALL 25576,FNad(x1,y1),sprite(7):ja=j:GOTO 210
500 x2=x1+2:y2=y1:GOSUB 750:IF ok>0 THEN 200
510 CALL 25576,FNad(x1,y1),sprite(0)
520 x1=x1+1
530 CALL 25576,FNad(x1,y1),sprite(1)
540 FOR i=1 TO vitesse:NEXT
550 CALL 25576,FNad(x1,y1),sprite(0)
560 x1=x1+1
570 CALL 25576,FNad(x1,y1),sprite(7)
580 FOR i=1 TO vitesse:NEXT
590 ja=j:GOTO 220
600 IF ja<>j THEN GOSUB 710:CALL 25576,FNad(x1,y1),sprite(6):ja=j:GOTO 210
610 : x2=x1-2:y2=y1:GOSUB 750:IF ok>0 THEN 200
620 CALL 25576,FNad(x1,y1),sprite(0)
630 x1=x1-1
640 CALL 25576,FNad(x1,y1),sprite(8)
650 FOR i=1 TO vitesse:NEXT
660 CALL 25576,FNad(x1,y1),sprite(0)
670 x1=x1-1
680 CALL 25576,FNad(x1,y1),sprite(6)
690 FOR i=1 TO vitesse:NEXT
700 ja=j:GOTO 220
710 IF j=1 AND ja=2 THEN CALL 25576,FNad(x1,y1),sprite(7):FOR i=1 TO vitesse:NEXT:RETURN
720 IF j=2 AND ja=1 THEN CALL 25576,FNad(x1,y1),sprite(6):FOR i=1 TO vitesse:NEXT:RETURN
730 IF j+ja=12 THEN CALL 25576,FNad(x1,y1),sprite(4):FOR i=1 TO vitesse:NEXT:RETURN
740 RETURN
750 '
760 '
770 '
780 ok=0:a=(x2+1)/2+1:b=(y2-1)/2+1
790 ON ta(a,b) GOTO 1260,810,890,830,840
800 RETURN
810 IF torche<3 THEN ta(a,b)=0:torche=torche+1:CALL 25576,FNad(torche*2+5,0),sprite(11):SOUND 7,0,1,15,,,2 ELSE ok=1
820 RETURN
830 clef=1:CALL 25576,FNad(14,0),sprite(13):ta(a,b)=0:SOUND 7,0,1,15,,,4:RETURN
840 IF clef=1 THEN ok=2:clef=0:i=REMAIN(0) ELSE ok=1
850 RETURN
860 '
870 '
880 '
890 i=REMAIN(0):SPEED INK 1,1
900 INK 9,7,0:INK 10,6,0:INK 11,3,0
910 IF vie=0 THEN 960
920 CALL 25579,FNad(vie*2-2,0),25000:vie=vie-1
930 FOR i=1 TO 1000:NEXT
940 INK 9,0:INK 10,0:INK 11,0:SPEED INK 10,10
950 ok=1:RETURN
960 FOR i=1 TO 1000:NEXT
970 MODE 1:SPEED INK 10,10
980 INK 2,10:INK 3,26
990 TAG#1:A$="GAME OVER":x=240:y=220:GOSUB 1730
1000 FOR i=1 TO 2500:NEXT
1010 MODE 0:RUN
1020 MODE 1:INK 1,26:INK 2,10:INK 3,26:TAG#1
1030 A$="BRAVO ARTHUR... ":x=220:y=220:GOSUB 1730
1040 FOR i=1 TO 3000:NEXT:MODE 0:RUN
1050 MODE 1:INK 1,26:INK 2,10:INK 3,26:TAG#1
1060 a$="TABLEAU :"+STR$(tabl):x=240:y=220:GOSUB 1730
1070 FOR i=1 TO 2000:NEXT
1080 MODE 0:WINDOW #2,1,40,25,25:RETURN
1090 '
1100 '
1110 '
1120 IF torche=0 THEN 220
1130 SOUND 1,0,10,7,,1,15:SOUND 1,0,10,7,,1,5
1140 t=t+8:EVERY 50,0 GOSUB 1190
1150 torche=torche-1
1160 CALL 25576,FNad(torche*2+7,0),25000
1170 INK 9,23:INK 10,10:INK 11,3
1180 FOR i=1 TO vitesse*2:NEXT:GOTO 220
1190 t=t-1
1200 IF T=1 THEN SPEED INK 1,1:INK 9,23,0:INK 10,10,0:INK 11,3,0
1210 IF t=0 THEN i=REMAIN(0):INK 9,0:INK 10,0:INK 11,0:SPEED INK 10,10
1220 RETURN
1230 '
1240 '
1250 '
1260 xd=x2-x1:yd=y2-y1
1270 SOUND 2,0,1,15,,,21
1280 IF ta(a+xd/2,b+yd/2)=0 THEN 1290 ELSE ok=1:RETURN
1290 SOUND 1,50,1,15:SOUND 2,0,1,15,,,21
1300 CALL 25576,FNad(x2,y2),25000:ta(a,b)=0
1310 a=a+xd/2:b=b+yd/2
1320 ta(a,b)=1:CALL 25576,FNad(x2+xd,y2+yd),sprite(10)
1330 IF ta(a,b-1)=1 THEN IF ta(a,b-2)=1 OR ta(a,b+1)=1 THEN 1380
1340 IF ta(a,b+1)=1 THEN IF ta(a,b+2)=1 OR ta(a,b-1)=1 THEN 1380
1350 IF ta(a-1,b)=1 THEN IF ta(a-2,b)=1 OR ta(a+1,b)=1 THEN 1380
1360 IF ta(a+1,b)=1 THEN IF ta(a+2,b)=1 OR ta(a-1,b)=1 THEN 1380
1370 RETURN
1380 IF clef<2 THEN RETURN
1390 SOUND 1,50,1,15:SOUND 2,0,1,15,,,2
1400 CALL 25576,FNad(xc,yc),sprite(13)
1410 clef=0:ta((xc+1)/2+1,(yc-1)/2+1)=4
1420 RETURN
1430 '
1440 '
1450 '
1460 j=0:IF INKEY(0)=0 THEN j=1
1470 IF INKEY(2)=0 THEN j=2
1480 IF INKEY(8)=0 THEN j=4
1490 IF INKEY(1)=0 THEN j=8
1500 IF INKEY(47)=0 THEN j=16
1510 RETURN
1520 '
1530 '
1540 '
1550 timer=timer-1
1560 SOUND 1,100,2,5,0,0,15
1570 IF timer=0 THEN i=REMAIN(1)
1580 RETURN
1590 '
1600 '
1610 '
1620 a$=INKEY$
1630 WHILE a$<>"":a$=INKEY$:WEND
1640 REM FOR i=1 TO 13:INK i,PEEK(25984+i):NEXT:INK 10,6:CALL 25972
1650 GOSUB 1760
1660 MODE 1:INK 2,10:INK 3,26:PRINT CHR$(23)+CHR$(3)
1670 TAG#1:a$="JOYSTICK    1":x=200:y=260:GOSUB 1730
1680 a$="CLAVIER     2":x=200:y=200:GOSUB 1730
1690 a$=INKEY$
1700 cl=VAL(a$)-1
1710 IF cl=1 OR cl=0 THEN MODE 0:RETURN
1720 GOTO 1690
1730 PLOT -2,0,1:MOVE x,y:PRINT#1,a$;
1740 PLOT -2,0,2:MOVE x+6,y-6:PRINT#1,a$;
1750 RETURN
1760 '
1770 '
1780 '
1790 ENT -1,1,1,5,2,-1,5,1,1,5
1800 RESTORE 1800:i=1:WHILE i<>62 AND a$=""
1810 READ s,d:a$=INKEY$
1820 IF s=0 THEN SOUND 1,0,d*40,1:SOUND 2,0,d*40,1:SOUND 4,0,d*40,1:GOTO 1840
1830 SOUND 1,s/2,d*40,5,,1:SOUND 2,s*2,d*40,4,,1:SOUND 4,s,d*40,4
1840 i=i+1:WEND:IF a$<>"" THEN RETURN ELSE 1800
1850 DATA 568,1,379,1,426,0.5,379,0.5,358,1,426,1,379,3,239,1,0,0.05,239,1.5,253,0.5,284,1,319,1,284,3
1860 DATA 568,1,379,1,426,0.5,379,0.5,358,1,426,1,379,3,239,1,0,0.05,239,1.5,253,0.5,284,1,319,1,284,3
1870 DATA 379,1,239,1,253,0.5,284,0.5,319,1,358,1,379,2,426,1,253,1,0,0.05,253,1,284,0.5,319,0.5,284,1,358,1,379,3
1880 DATA 0,0.05,379,1,239,1,253,0.5,284,0.5,319,1,358,1,426,2,506,1,358,1,379,1,426,0.5,379,0.5,506,1,478,1,568,3,0,2
1890 '
1900 '
1910 '
1920 tabl=tabl+1:IF tabl=16 THEN 1020
1930 GOSUB 1050
1940 FOR i=1 TO 15:INK i,0:NEXT
1950 FOR i=1 TO 20:CALL 25576,FNad(i*2-1,2),sprite(12):CALL 25576,FNad(i*2-1,23),sprite(12):ta(i,1)=3:ta(i,12)=3:NEXT
1960 FOR i=1 TO 11:CALL 25576,FNad(0,i*2),sprite(12):CALL 25576,FNad(38,i*2),sprite(12):ta(1,i)=3:ta(21,i)=3:NEXT
1970 FOR i=1 TO vie:CALL 25576,FNad(i*2-2,0),sprite(5):NEXT
1980 FOR i=1 TO torche:CALL 25576,FNad(i*2+5,0),sprite(11):NEXT
1990 FOR i=1 TO 15:INK i,0:NEXT
2000 SPEED INK 10,10:CLS#2
2010 FOR j=2 TO 11:READ a$:FOR i=2 TO 20:b=VAL(MID$(a$,i-1,1))
2020 ta(i,j)=b
2030 SOUND 1,150-(j*10+i),1,7,,,2
2040 ON b GOSUB 2110,2110,2110,2130,2110,2120
2050 IF b=0 THEN CALL 25576,FNad((i-1)*2-1,(j-1)*2+1),25000
2060 NEXT:NEXT
2070 FOR i=1 TO 13:INK i,PEEK(25984+i):NEXT:INK 14,0,6:INK 15,6,0
2080 timer=15:EVERY 50,1 GOSUB 1520
2090 WHILE timer<>0:WEND
2100 INK 9,0:INK 10,0:INK 11,0:RETURN
2110 CALL 25576,FNad((i-1)*2-1,(j-1)*2+1),sprite(9+b):RETURN
2120 x1=(i-1)*2-1:y1=(j-1)*2+1:ta(i,j)=0:CALL 25576,FNad(x1,y1),sprite(4):ja=2:RETURN
2130 xc=(i-1)*2-1:yc=(j-1)*2+1:ta(i,j)=0:CALL 25576,FNad(xc,yc),25000:clef=2:RETURN
2140 '
2150 '
2160 '
2170 DATA 0003603005333330000
2180 DATA 0003003000333330000
2190 DATA 0403203000333330001
2200 DATA 0000003000333331010
2210 DATA 0030000000333330000
2220 DATA 3333333300333330000
2230 DATA 3333333300000000000
2240 DATA 0000000000003333333
2250 DATA 0200000000023333333
2260 DATA 0002300032003333333
2270 '
2280 DATA 0003000333300003000
2290 DATA 2000000333300003100
2300 DATA 0003000000000003000
2310 DATA 0003333330300000002
2320 DATA 0000100300333303333
2330 DATA 3303303360320003333
2340 DATA 3303003333333303333
2350 DATA 3303000000000000000
2360 DATA 0000000000001000000
2370 DATA 5003000333300003004
2380 '
2390 DATA 3333332000002333333
2400 DATA 3333000000000003333
2410 DATA 3333030033300303333
2420 DATA 3330000331330000333
2430 DATA 3330300056400300333
2440 DATA 3330030330330030333
2450 DATA 3330000030300000333
2460 DATA 3333130000000313333
2470 DATA 3333000000000003333
2480 DATA 3333332003002333333
2490 '
2500 DATA 2333330333330333323
2510 DATA 0333330333330100003
2520 DATA 0100000000000333303
2530 DATA 0333330333330333305
2540 DATA 0333330333330333303
2550 DATA 0333330016000333303
2560 DATA 0000000333330000003
2570 DATA 0333330333330333303
2580 DATA 0333330333330333304
2590 DATA 2333330000000000023
2600 '
2610 DATA 3100000005000000003
2620 DATA 0000000033300000000
2630 DATA 0330003313133000030
2640 DATA 2003003100013003002
2650 DATA 3303003306033003033
2660 DATA 0000303100013030004
2670 DATA 3131313313133131313
2680 DATA 3000000000000000003
2690 DATA 3000000300033333003
2700 DATA 3330000303032000033
2710 '
2720 DATA 1313131315131313131
2730 DATA 0000000000000000000
2740 DATA 3030203030303030203
2750 DATA 0000303030003000300
2760 DATA 1313131316131313131
2770 DATA 0000000000000000000
2780 DATA 3030303020303030203
2790 DATA 0000000000000000004
2800 DATA 3131313131313131313
2810 DATA 3333333333333333333
2820 '
2830 DATA 3330003333333330003
2840 DATA 3000300000023300303
2850 DATA 3033333033333303303
2860 DATA 3033331200000013300
2870 DATA 3000030000000003330
2880 DATA 3303000005600020000
2890 DATA 3303330000000003303
2900 DATA 3303330100000003303
2910 DATA 3300003033333033303
2920 DATA 3333300033333000043
2930 '
2940 DATA 0030000000003003000
2950 DATA 3002305030100060020
2960 DATA 0003000000300000030
2970 DATA 0000003000003030000
2980 DATA 0030000003000000300
2990 DATA 0000300000000300003
3000 DATA 0300103000030010300
3010 DATA 0003000030000300030
3020 DATA 0300030300300003003
3030 DATA 2003000430003000002
3040 '
3050 DATA 3333000303003333005
3060 DATA 3200000300003200000
3070 DATA 3333000303003333000
3080 DATA 3333003313000000033
3090 DATA 3000000003033330033
3100 DATA 3033031333032000000
3110 DATA 3003036300033330033
3120 DATA 3303030203000000033
3130 DATA 3003030303000000033
3140 DATA 3433000000033330000
3150 '
3160 DATA 3000000000000000002
3170 DATA 3030004333333333330
3180 DATA 0003033330000033330
3190 DATA 1333033500033000000
3200 DATA 0033133333333333330
3210 DATA 0301610000003030030
3220 DATA 0033131333333030030
3230 DATA 0000030000000010030
3240 DATA 3333000003333033330
3250 DATA 3333333333333000002
3260 '
3270 DATA 3333333333333000333
3280 DATA 3500000000000000000
3290 DATA 3333000000333330000
3300 DATA 0000000133311300000
3310 DATA 0232301330331000000
3320 DATA 0333303311333003333
3330 DATA 0300000016100000033
3340 DATA 2303303330331033033
3350 DATA 3303301330333033033
3360 DATA 3300004331320000033
3370 '
3380 DATA 0000033000003300000
3390 DATA 2000000000003310300
3400 DATA 0002033000000000000
3410 DATA 0000033000003300000
3420 DATA 3033333333333333303
3430 DATA 3000033000003300003
3440 DATA 3000033010003300003
3450 DATA 3000000000063300003
3460 DATA 3000033001043300003
3470 DATA 3000033000003350003
3480 '
3490 DATA 2333300033300000000
3500 DATA 0033000000000033300
3510 DATA 0100003333300031300
3520 DATA 0000003420333033356
3530 DATA 0300333000333033333
3540 DATA 0300313101313000023
3550 DATA 0300333303333000003
3560 DATA 3000000000000003333
3570 DATA 3333333300333333333
3580 DATA 3200000000000000023
3590 '
3600 DATA 3100300130300000000
3610 DATA 1503130510303333330
3620 DATA 3003330030300000230
3630 DATA 2000600000003331330
3640 DATA 3003330030303330000
3650 DATA 3100300130303400330
3660 DATA 3100300130303400330
3670 DATA 3333333333303313330
3680 DATA 0000030003000000000
3690 DATA 2030000300033333333
3700 '
3710 DATA 3302003033330233403
3720 DATA 3303303030000003300
3730 DATA 3000000000033000330
3740 DATA 0030330000030000000
3750 DATA 0330330303330003303
3760 DATA 0030330010603303300
3770 DATA 3030330303010300330
3780 DATA 5030330303300000300
3790 DATA 3330330303003333303
3800 DATA 3332000333000021323