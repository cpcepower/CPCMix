10 ON BREAK GOSUB 4170:ON ERROR GOTO 4170
15 CALL &9F9C
20 MEMORY &6600:CLEAR:RANDOMIZE TIME:POKE &A302,0:POKE &A202,69:POKE &A203,2:POKE &A204,2:POKE &A303,2
30 ENV 1,2,3,2,1,0,10,6,-1,2:ENV 4,2,3,2,1,0,30,6,-1,8:ENV 2,2,3,2,1,0,15,6,-1,3:ENV 3,2,3,2,1,0,23,6,-1,5:ENV 6,2,3,2,1,0,50,6,-1,6:ol$="ÅåóúÜ§±´†":OC$="232223323"
40 SOUND 49,80,40,3,3:SOUND 42,239,70,5,6:SOUND 28,478,60,4,4
50 hb$(1)="ÇÉ":hb$(2)=" é":hb$(3)="ò":hb$(4)="ù":hb$(5)="áà":hb$(6)="•¶":hb$(7)=" ì":hb$(8)="¨≠":hb$(9)="°¢":bb$(1)="ÑÖ":bb$(3)="ôö":bb$(4)="è":bb$(5)="âä":bb$(7)="ï":bb$(8)="ÆØ"
60 hr$(2)="ç":hr$(3)=" õ":hr$(4)=" û":hr$(6)="ß®":hr$(7)="ê":hr$(8)="∞":br$(2)="è":br$(4)=" ü":br$(5)="ã":br$(6)="©™":br$(7)="ëí":br$(9)="£":l$=CHR$(10)+CHR$(8)+CHR$(8):i$=l$+STRING$(3,CHR$(11))
70 y$=CHR$(22)+CHR$(0):t$=CHR$(22)+CHR$(1):j$=l$+CHR$(8):cm$="32223":pr$="476582139":DATA Corde,Briquet,Torche,Affutoir,Ceinture,Fiole,Ration,Breuvage,Clef
80 POKE &A201,141:POKE &A200,64:w$(0)="Microbe":x$(0)="sauvage !":w$(1)="Miserable":x$(1)="guerrier !":w$(2)="Modeste":x$(2)="brave !":w$(3)="Belligerant":x$(3)="dechaine !"
90 w$(4)="Aventurier":x$(4)="de classe !":w$(5)="Maitre du":x$(5)="labyrinthe":GOSUB 610:GOSUB 2860:GOSUB 1620:re=REMAIN(0)
100 MODE 1:BORDER 0:INK 2,20:INK 0,0:PAPER 0:INK 1,18:INK 3,15:RELEASE 7:AFTER 1500*RND+1000 GOSUB 4020:u=1:SOUND 135,1,1,0:AFTER 750,1 GOSUB 4180
110 gf=80:gv=90:gc=100:gm=100:mv(0)=130:dg(0)=8:mv(1)=99:dg(1)=13:mv(2)=110:dg(2)=18:mv(3)=90:dg(3)=20:mv(4)=95:dg(4)=15:odo(0)=120:odo(1)=190:odo(2)=50:odo(3)=70:odo(4)=90
120 NOMO=5:FOR T=0 TO 4:MP(T)=MV(T):NEXT:OBJM(0)=9
130 MODE 1:enc=3:ti=-1:f$="ÛÒÚ":GOSUB 1490:RESTORE 70:FOR i=1 TO 10:READ obj$(i):NEXT
140 WINDOW #2,28,40,17,17:WINDOW #3,28,40,18,18:PEN #3,2:WINDOW #4,35,40,11,11:PEN #4,2:WINDOW #5,35,40,12,12:PEN #5,2:WINDOW #6,35,40,13,13:PEN #6,2:WINDOW #7,35,40,14,14:PEN #7,2
150 d$(0)="013452":d$(1)="031452":d$(2)="301254":d$(3)="103452"
160 FOR n=0 TO 4:ODO(n)=100:NEXT
170 FOR n=1 TO 8:PEN n MOD 2+2:LOCATE 22,2+2*n:PRINT MID$("WALKYRIE",N,1):NEXT
180 WINDOW #1,25,40,9,20:WINDOW SWAP 1 
190 PEN 3:PRINT "-  SCORE : 0000":PRINT
200 PEN 2:PRINT " - Vie   : 9":PRINT " - Force : 8":PRINT " - Coups : 10"
210 PRINT" - Magie : 10":FOR t=1 TO 5:PRINT:NEXT:PEN 3:PRINT"-  Encens : 3"
220 WINDOW SWAP 0,1:WINDOW #1,1,40,21,25:GOSUB 2510
230 MOVE 545,294:DRAW 629,294,2:DRAW 629,378:DRAW 545,378:DRAW 545,294
240 MOVE 414,294:DRAW 498,294:DRAW 498,378:DRAW 414,378:DRAW 414,294 
250 ORIGIN 166,234,16,316,84,384 
260 GOSUB 930:RE=REMAIN(2):IF gv<=0 OR gf<=0 THEN 3850
270 IF A%(HG,XG,YG,1)<>0 THEN 300
280 SC=SC+3:IF XG>3 AND YG>3 THEN IF AL=0 THEN SC=SC-2 ELSE SC=SC+2
290 GOSUB 3680
300 TIM=TIM+1:IF ti+6>tim AND ti>0 THEN A%(HG,XG,YG,1)=1 ELSE A%(HG,XG,YG,1)=TIM:ti=-1
310 IF al=1 THEN IF RND*15<1 THEN cop=3:GOSUB 1500:al=0:GOSUB 4040:GOSUB 2520:GOSUB 930
320 ON de+1 GOSUB 1220,4190
330 IF BG=1 THEN re=REMAIN(1):GOTO 260 ELSE 320
340 MOVE 148*s,100:DRAW 100*s,100,co:DRAW 80*s,80:DRAW 80*s,-80:DRAW 100*s,-100:DRAW 148*s,-100:MOVE 100*s,100:DRAW 100*s,-100:RETURN    
350 MOVE 148*s,148:DRAW 80*s,80,co:DRAW 80*s,-80:DRAW 148*s,-148:RETURN
360 MOVE 80*s,40:DRAW 40*s,40,co:DRAW 30*s,30:DRAW 30*s,-30:DRAW 40*s,-40:DRAW 80*s,-40:MOVE 40*s,40:DRAW 40*s,-40:RETURN
370 MOVE 80*s,78:DRAW 80*s,-78,cf:MOVE 80*s,-80:DRAW 30*s,-30,co:DRAW 30*s,30:DRAW 80*s,80:RETURN   
380 MOVE 30*s,12:DRAW 12*s,12,co:DRAW 0,0:DRAW 12*s,-12:DRAW 30*s,-12:MOVE 12*s,12:DRAW 12*s,-12:RETURN  
390 MOVE 30*s,30:DRAW 0,0,co:DRAW 30*s,-30:MOVE 30*s,-28:DRAW 30*s,28,cf:RETURN
400 MOVE 87,148*s:DRAW 60,115*s,co:DRAW -60,115*s:DRAW -87,148*s:MOVE 80,148*s:DRAW 58,120*s:DRAW -58,120*s:DRAW -80,148*s:RETURN
410 MOVE 46,70*s:DRAW 28,50*s,co:DRAW -28,50*s:DRAW -46,70*s:DRAW 46,70*s:MOVE 42,70*s:DRAW 26,54*s:DRAW -26,54*s:DRAW -42,70*s:RETURN
420 MOVE 20,30*s:DRAW 12,22*s,co:DRAW -12,22*s:DRAW -20,30*s:DRAW 20,30*s:RETURN
430 MOVE 100,100:DRAW -100,100,co:MOVE  100,-100:DRAW -100,-100
440  MOVE 98,98:DRAW 80,80,cf:DRAW 80,-80:DRAW 98,-98
450 IF pd=1 THEN MOVE 100,98:DRAW 100,-98,cf ELSE MOVE 100,100:DRAW 100,-100,co
460 MOVE -98,98:DRAW -80,80,cf:DRAW -80,-80:DRAW -98,-98
470 IF pg=1 THEN MOVE -100,98:DRAW -100,-98,cf ELSE MOVE -100,100:DRAW -100,-100,co
480 RETURN
490 MOVE 40,40:DRAW -40,40,co:MOVE -40,-40:DRAW 40,-40
500 MOVE 40,40:DRAW -40,40,co:MOVE -40,-40:DRAW 40,-40
510 MOVE 38,38:DRAW 30,30,cf:DRAW 30,-30:DRAW 38,-38
520 MOVE -38,38:DRAW -30,30,cf:DRAW -30,-30:DRAW -38,-38  
530 IF pd=1 THEN MOVE 40,38:DRAW 40,-38,cf ELSE MOVE 40,40:DRAW 40,-40,co
540 IF pg=1 THEN MOVE -40,38:DRAW -40,-38,cf ELSE MOVE -40,40:DRAW -40,-40,co
550 RETURN
560 MOVE 10,10:DRAW -10,-10,cf:MOVE 10,-10:DRAW -10,10
570 MOVE 12,12:DRAW -12,12,co:MOVE 12,-12:DRAW -12,-12
580 IF pd=1 THEN MOVE 12,-10:DRAW 12,10,cf ELSE MOVE 12,-12:DRAW 12,12,co
590 IF pg=1 THEN MOVE -12,-10:DRAW -12,10,cf ELSE MOVE -12,-12:DRAW -12,12,CO
600 RETURN
610 :
620 DEFINT A-Z:DEFREAL b:vol(1)=2:vol(2)=5:vol(4)=4:ad=&660E
630 DIM a%(1,9,9,1)
640 DATA 0,1,1,0,0,-1,-1,0
650 RESTORE 640
660 FOR n=0 TO 3:READ ax(n),ay(n):NEXT:AH(4)=1:AH(5)=-1
670 xm(4)=9:ym(4)=9:a%(0,9,9,0)=2^4:a%(1,9,9,0)=2^5
680 FOR n=0 TO 4
690 IF RND*12<1 THEN GOSUB 830
700 IF h(N)=0 THEN x=FIX(RND*6)MOD 4 ELSE x=FIX(RND*4)
710 ON SQ(1) GOSUB 3140:ON SQ(2) GOSUB 3140:ON SQ(4) GOSUB 3140
720 IF n=4 THEN x=FIX(RND*6):IF x>3 THEN x=x-2
730 y=(x+2)MOD 4 
740 IF ABS(d(N)-x)=2 THEN 700
750 IF X(N)+AX(X)<0 OR X(N)+AX(X)>9 THEN 700 
760 IF Y(N)+AY(X)<0 OR Y(N)+AY(X)>9 THEN 700 
770 d(n)=x:d=d(n):k=1:GOSUB 920
780 x(n)=x(n)+ax(d(n)):y(n)=Y(n)+ay(d(n))
790 d=y:k=1:GOSUB 920  
800 IF x(n)=9 AND y(n)=9 AND n<3 THEN RETURN
810 NEXT
820 GOTO 680
830 IF h(N)=1 THEN 880 
840 IF n=2 AND pr=0 THEN IF x(n)<4 AND y(n)<4 THEN pr=1:a%(h(n),x(n),y(n),0)=256+a%(h(n),x(n),y(n),0)
850 d=4:k=1:GOSUB 920   
860 h(N)=1:d=5:GOSUB 920
870 RETURN
880 REM
890 d=5:k=1:GOSUB 920  
900 h(N)=0:d=4:GOSUB 920 
910 RETURN 
920 a%(h(N),x(n),y(n),0)=a%(h(N),x(n),y(n),0) OR 2^d:RETURN
930 '
940 GOSUB 4160:FOR t=0 TO 1:m=FIX(RND*5):GOSUB 1830:NEXT:INK 1,0
950 IF mb<1 THEN IF a%(hg,xg,yg,0)>=2^14 THEN GOSUB 3070:IF nmo<>-1 THEN GOTO 3210 ELSE STOP
960 IF xg>3 AND yg>3 THEN IF al=0 THEN RETURN
970 CO=1:CF=0:dr=(dg+1) MOD 4:ga=(dg+3) MOD 4:FOR t=0 TO 2:g=t+1
980 a=a%(hg,xg+t*ax(dg),yg+t*ay(dg),0):a$=RIGHT$(BIN$(a,16),6)
990 FOR n=0 TO 5:P(n)=VAL(MID$(a$,6-n,1)):NEXT n
1000 s=1:IF P(dr)=0 THEN PD=0:ON G GOSUB 350,370,390 ELSE PD=1:ON G GOSUB 340,360,380
1010 IF P(4)=1 THEN ON G GOSUB 400,410,420
1020 s=-1:IF P(ga)=0 THEN PG=0:ON G GOSUB 350,370,390 ELSE PG=1:ON G GOSUB 340,360,380
1030 IF P(5)=1 THEN ON G GOSUB 400,410,420
1040 IF P(dG)=0 THEN 1060
1050 IF al=0 AND xg+ax(dg)*g>3 AND yg+ay(dg)*g>3 THEN 1090 ELSE 1070
1060 ON G GOSUB 430,490,560:GOTO 1090
1070 NEXT
1080 IF al=0 THEN IF xg+ax(dg)*t>3 AND yg+ay(dg)*t>3 THEN RETURN
1090 INK 1,18
1100 IF xg=yg THEN IF xg=9 AND hg=0 THEN GOSUB 3080 
1110 '
1120 IF xg>3 AND yg>3 THEN IF al=0 THEN RETURN
1130 FOR T=0 TO 2
1140 xx=xg+ax(dg)*t:yy=yg+ay(dg)*t
1150 IF al=0 THEN IF xx>3 AND yy>3 THEN 1200
1160 g=a%(hg,xx,yy,0):IF g>2^14 THEN GOSUB 4060:GOTO 1200
1170 no=FIX(g/256)
1180 IF no=0 THEN 1200
1190 DI:ON t+1 GOSUB 2160,2150,2180:EI
1200 g$=RIGHT$(BIN$(g,4),4):IF MID$(g$,4-dg,1)="0"THEN RETURN
1210 NEXT:RETURN
1220 '
1230 EI:BG=0:IF INKEY(23)=128 AND gm>0 THEN GOSUB 2340:gm=gm-10:PRINT#7,gm/10
1240 IF INKEY(21)=32 THEN GOSUB 2550
1250 K$=INKEY$:IF K$="" THEN RETURN
1260 IF INKEY(47)=0 AND enc>0 THEN GOSUB 2920
1270 BG=1
1280 K=ASC(K$) 
1290 IF k=13 THEN POKE &A400,0:POKE &A401,&9B:POKE &A402,PEEK(&A202):CALL &A410:GOSUB 2420:AFTER 50,1 GOSUB 3130
1300 IF k=127 THEN GOSUB 2510
1310 IF INKEY(8)=0 THEN DG=(DG+3) MOD 4:GOSUB 1490:RETURN 
1320 IF INKEY(2)=0 THEN DG=(DG+2) MOD 4:GOSUB 1490:RETURN
1330 IF INKEY(1)=0 THEN DG=(DG+1) MOD 4:GOSUB 1490:RETURN  
1340 A=A%(HG,Xg,YG,0):A$=RIGHT$(BIN$(A,16),6)
1350 FOR P=0 TO 5:P(P)=VAL(MID$(A$,6-P,1)):NEXT
1360 coi=3
1370 nob=0:FOR t=0 TO 1:IF obj(t)>0 THEN nob=nob+1
1380 NEXT
1390 IF INKEY(0)=-1 OR P(DG)=0 THEN 1430
1400 COP=coi:GOSUB 1500:XG=XG+AX(DG):YG=YG+AY(DG):COP=1:gf=gf-1*nob*(1-cei):GOSUB 1500:EVERY 10,2 GOSUB 3020:IF de=1 THEN RETURN
1410 IF a%(hg,xg,yg,0)<2^14 THEN 2640
1420 GOSUB 3070:IF nmo<>-1 THEN 3210 
1430 IF INKEY(9)=-1 THEN BG=0:RETURN
1440 IF obj(obj)<>1 THEN 1470
1450 IF HG=0 THEN IF P(4)=1 THEN COP=coi:GOSUB 1500:HG=1:COP=1:GOSUB 1500:gf=gf-4*nob-8*cei:PRINT#5,gf/10:RETURN
1460 IF HG=1 THEN IF P(5)=1 THEN COP=coi:GOSUB 1500:HG=0:COP=1:GOSUB 1500:gf=gf-2*nob*(1-cei):PRINT#5,gf/10:RETURN
1470 BG=0
1480 RETURN
1490 PEN 3:LOCATE 33,4:PRINT MID$(f$,dg+1,1):RETURN
1500 :
1510 IF HG=1 THEN ORIGIN 550,300,0,640,0,400 ELSE ORIGIN 420,300,0,640,0,400
1520 b=TEST(xg*8,yg*8):IF b=1 OR b=3 THEN 1540
1530 IF xg>3 AND yg>3 THEN IF al=0 THEN 1600
1540 a=a%(hg,xg,yg,0):a$=RIGHT$(BIN$(a,16),6)
1550 FOR n=0 TO 5:P(n)=VAL(MID$(a$,6-n,1)):NEXT n
1560 FOR N=0 TO 3
1570 IF p(hg+4)=1 THEN GOSUB 1610
1580 MOVE XG*8,YG*8:IF P(N)=1 THEN DRAWR AX(N)*4,AY(N)*4,COP
1590 NEXT  
1600 ORIGIN 166,234,16,316,84,384:RETURN
1610 MOVE xg*8-2,yg*8-2:DRAWR 0,4,COP:DRAWR 4,0:DRAWR 0,-4:DRAWR -4,0:RETURN
1620 AFTER 4000 GOSUB 4170
1630 IF pr=0 THEN a%(0,0,0,0)=256+a%(0,0,0,0)
1640 no=1:v=1:GOSUB 1690:no=2:v=2:GOSUB 1690:no=3:v=4:GOSUB 1690:NO=4:v=1:FOR T=1 TO 3:GOSUB 1690:NEXT:NO=5:v=2:GOSUB 1690
1650 V=4:FOR N=1 TO 5:NO=7:GOSUB 1690:NO=6:GOSUB 1690:NEXT:V=1:FOR n=1 TO 10:NO=7:GOSUB 1690:NO=6:GOSUB 1690:NEXT
1660 FOR n=1 TO 5:v=4:GOSUB 1690:NEXT
1670 NO=8:FOR n=1 TO 3:v=1:GOSUB 1690:NEXT
1680 RETURN
1690 IF u=0 THEN ON SQ(1) GOSUB 3140:ON SQ(2) GOSUB 3140:ON SQ(4) GOSUB 3140
1700 ON v GOSUB 1730,1740,1750,1760
1710 a=a%(h,x,y,0):IF a>255 OR a=0 OR MID$(RIGHT$(BIN$(a,6),6),1,1)="1" THEN 1690
1720 a%(h,x,y,0)=a%(h,x,y,0)+no*256:RETURN
1730 x=FIX(RND*10):y=FIX(RND*10):h=FIX(RND*2):RETURN
1740 x=FIX(RND*5+5):y=FIX(RND*5+5):h=FIX(RND*2):RETURN
1750 x=FIX(RND*4):y=FIX(RND*4):h=FIX(RND*2):RETURN
1760 x=FIX(RND*10):y=FIX(RND*10):h=1:RETURN
1770 :
1780 R=0:IF XM+ax(dm(m))=XG THEN IF YM+ay(dm(m))=YG THEN IF HM+ah(dm(m))=HG THEN R=1
1790 RETURN
1800 RP=0:IF A%(HM+AH(DM(M)),XM+AX(DM(M)),YM+AY(DM(M)),0)>=2^14 THEN RP=1:RETURN
1810 IF AT=1 THEN RETURN
1820 GOSUB 1780:RP=R:RETURN
1830 :
1840 IF mb>0 THEN mb=mb-1:RETURN
1850 IF mort(m)=1 THEN RETURN
1860 GOSUB 2800
1870 at=-(mv(m)>=gv):IF mv(m)<mp(m) THEN mv(m)=mv(m)+3
1880 :
1890 A=A%(HM(M),XM(M),YM(M),0):A$=RIGHT$(BIN$(A,16),6):FOR N=0 TO 5:P(N)=VAL(MID$(A$,6-N,1)):NEXT 
1900 HM=HM(M):XM=XM(M):YM=YM(M) 
1910 ODO=A%(HM,XM,YM,1):IF ODO<2 THEN 2090
1920 IF TIM-ODO>ODO(M) THEN 2090
1930 IF at=0 THEN 2090
1940 :
1950 BEST=-1:REP=0
1960 FOR D=0 TO 5
1970 IF P(D)=0 THEN 2000 
1980 VA=A%(HM(M)+ah(d),XM(M)+AX(D),YM(M)+AY(D),1)
1990 IF VA>BEST THEN BEST=VA:DIR=D
2000 NEXT
2010 IF REP=0 THEN 2090
2020 DM(M)=DIR
2030 GOSUB 1800:IF RP=1 THEN 2090
2040 k=A%(HM,XM,YM,0):IF k>2^14 THEN A%(HM,XM,YM,0)=k-2^14
2050 IF odo=0 THEN C=0 ELSE c=3 
2060 HM(M)=HM(M)+AH(DM(M)):XM(M)=XM+AX(DM(M)):YM(M)=YM+AY(DM(M))
2070 k=A%(HM(m),XM(m),YM(m),0):IF k<2^14 THEN A%(HM(m),XM(m),YM(m),0)=k+2^14
2080 RETURN
2090 h=FIX(RND*4):FOR d=1 TO 6:z=VAL(MID$(d$(h),d,1)):IF z<4 THEN dir(d)=(dm(m)+z) MOD 4 ELSE dir(d)=z
2100 IF P(DIR(D))=0 THEN 2120
2110 DM(M)=DIR(D):GOSUB 1800:IF RP=0 THEN 2040
2120 NEXT
2130 RETURN
2140 SX=XG:SY=YG:SH=HG:XG=XM(M):YG=YM(M):HG=HM(M):GOSUB 1500:XG=SX:YG=SY:HG=SH:RETURN
2150 TAG:PLOT 999,999,VAL(MID$(OC$,NO,1)):MOVE -4,-50:PRINT MID$(ol$,no,1);:TAGOFF:RETURN
2160 PRINT CHR$(22)+CHR$(1);:LOCATE 11,17:PEN 2:PRINT hb$(no):LOCATE 11,18:PRINT bb$(no):LOCATE 11,17:PEN 3:PRINT hr$(no):LOCATE 11,18:PRINT br$(no)
2170 PRINT CHR$(22)+CHR$(0);:RETURN
2180 MOVE -2,-15:DRAWR 4,0,VAL(MID$(OC$,NO,1)):DRAWR 0,-4:DRAWR -4,0:DRAWR 0,4:PLOTR 2,-2:RETURN
2190 FOR m=0 TO 4
2200 IF c$(m)="" THEN 2260
2210 IF aHm(m)=1 THEN ORIGIN 550,300,0,640,0,400 ELSE ORIGIN 420,300,0,640,0,400
2220 FOR s=aym(m)*8+2 TO aym(m)*8-2 STEP -2
2230 MOVE axm(m)*8-2,s:DRAW axm(m)*8+2,s,0:NEXT 
2240 FOR P=0 TO 5:P(P)=VAL(MID$(c$(m),6-P,1)):NEXT
2250 IF a%(ahm(m),axm(m),aym(m),1)>0 THEN x1=xg:y1=yg:h1=hg:xg=axm(m):yg=aym(m):hg=ahm(m):cop=3:GOSUB 1500:xg=x1:yg=y1:hg=h1
2260 NEXT:FOR m=0 TO 4
2270 IF MORT(M)=1 THEN 2320
2280 IF Hm(m)=1 THEN ORIGIN 550,300,0,640,0,400 ELSE ORIGIN 420,300,0,640,0,400
2290 FOR s=ym(m)*8+2 TO ym(m)*8-2 STEP -2
2300 MOVE xm(m)*8-2,s:DRAW xm(m)*8+2,s,2:NEXT
2310 axm(m)=xm(m):aym(m)=ym(m):ahm(m)=hm(m):c$(m)=a$:ORIGIN 166,234,16,316,84,384
2320 NEXT
2330 RETURN
2340 FOR m=0 TO 4
2350 A=A%(HM(M),XM(M),YM(M),0):A$=RIGHT$(BIN$(A,16),6):FOR N=0 TO 5:P(N)=VAL(MID$(A$,6-N,1)):NEXT
2360 NEXT
2370 GOSUB 2190
2380 RETURN
2390 a=a%(h,x,y,0):IF a>2^14 THEN a=a-2^14
2400 no=FIX(a/256):a%(h,x,y,0)=a%(h,x,y,0)-256*no:RETURN
2410 a%(h,x,y,0)=a%(h,x,y,0)+no*256:RETURN
2420 IF MID$(RIGHT$(BIN$(a%(hg,xg,yg,0),6),6),1,1)="1" THEN RETURN
2430 x=xg:y=yg:h=hg:GOSUB 2390
2440 ob=obj(obj):obj(obj)=no:no=ob:GOSUB 2410
2450 IF ob=3 THEN IF obj((obj+1)MOD 2)<>3 THEN al=0:GOSUB 2520
2460 IF OB=9 AND CLE=0 THEN SC=SC+150:GOSUB 3680:CLE=1
2470 PEN #2,2:PRINT#obj+2,obj$(obj(obj))
2480 GOSUB 2990
2490 cei=0:IF obj(1)=5 OR obj(0)=5 THEN cei=1
2500 RETURN
2510 obj=(obj+1) MOD 2:PEN 3:LOCATE 26,17+obj:PRINT"->":LOCATE 26,17+(obj+1) MOD 2:PRINT"  ":RETURN
2520 IF al=1 THEN 2540
2530 LOCATE 33,6:PRINT" ":LOCATE 33,7:PRINT" ":RETURN
2540 GOSUB 930:LOCATE 33,6:PEN 3:PRINT CHR$(238):LOCATE 33,7:PEN 2:PRINT CHR$(239):RETURN
2550 b=obj((obj+1) MOD 2)
2560 a=obj(obj):IF a<>2 THEN 2600
2570 IF b<>3 THEN RETURN
2580 al=1:GOSUB 2520
2590 RETURN
2600 IF a<>7 THEN 2660
2610 ENV 1,15,-1,1:SOUND 1,40,-4,15,1:obj(obj)=0:PRINT#2+obj
2620 gf=gf+RND*80+20:IF gf>100 THEN gf=100 
2630 gv=gv-RND*30:IF gv<=0 THEN 3850
2640 PRINT#5,gf/10:PRINT#4,gv/10
2650 RETURN
2660 IF a<>6 THEN 2710
2670 ENT 7,10,-10,10,10,6,50:SOUND 1,100,70,7,0,7:obj(obj)=0:PRINT#2+obj
2680 gf=gf-RND*30:IF gf<=0 THEN 3850
2690 gv=gv+RND*80+20:IF gv>100 THEN gv=100
2700 GOTO 2640
2710 IF a<>4 THEN 2740
2720 ENV 6,5,3,1,15,-1,2:SOUND 1,1100,-6,0,6,0,5:gc=100:gf=gf-RND*RND*30:gv=gv-RND*RND*5:IF gf<=0 OR gv<=0 THEN 3850
2730 PRINT#6,gc/10:NAF=NAF+1:GOTO 2640
2740 IF a<>9 OR xg<>9 OR yg<>9 OR al=0 THEN 2760
2750 GOTO 3760
2760 IF a<>8 THEN RETURN
2770 ENT 6,10,-10,1,10,6,5:SOUND 1,100,70,7,0,6:obj(obj)=0:PRINT#2+obj
2780 gm=100:gf=gf-RND*40:gv=gv-RND*60:IF gf<=0 OR gv<=0 THEN 3850
2790 PRINT#7,gm/10:GOTO 2640
2800 h=hm(m):x=xm(m):y=ym(m)
2810 b=a%(h,x,y,0):IF b>2^14 THEN b=b-2^14
2820 b=FIX(b/256):IF b<=1 THEN RETURN
2830 IF OBJM(M)=0 THEN 2850
2840 IF MID$(pr$,objm(m),1)>=MID$(pr$,b,1) THEN RETURN
2850 GOSUB 2390:no=objm(m):objm(m)=b:GOSUB 2410:RETURN
2860 FOR a=0 TO 4
2870 x=INT(RND*5+5):y=INT(RND*5+5):h=INT(RND*2)
2880 ON SQ(1) GOSUB 3140:ON SQ(2) GOSUB 3140:ON SQ(4) GOSUB 3140
2890 b=a%(h,x,y,0):IF b>2^14 OR b=0 THEN 2870 
2900 a%(h,x,y,0)=b+2^14
2910 xm(a)=x:ym(a)=y:hm(a)=h:NEXT:RETURN
2920 enc=enc-1:LOCATE 36,20:PEN 3:PRINT enc:ti=tim:SOUND 1,0,75,2,0,0,4
2930 FOR t=1 TO 10:FOR n=1 TO 5:x(n)=RND*120-60:y(n)=RND*120-80:t(n)=TEST(x(n),y(n)):PLOT x(n),y(n),FIX(RND*3+1):NEXT:FOR n=1 TO 100:NEXT:FOR n=1 TO 5:PLOT x(n),y(n),t(n):NEXT:NEXT
2940 ENT 6,127,50,1:ENV 6,5,2,5:FOR i=1 TO 5:SOUND 1,100,127,0,6,6,15:NEXT:RETURN
2950 ENV 7,5,2,1:FOR i=1 TO 4:SOUND 1,1500,40,0,7,0,31:SOUND 1,400,15,0,7,0,20:NEXT:RETURN
2960 ENV 1,15,-1,15:ENT -1,5,60,1,5,-60,2:SOUND 129,300,-1,15,1,1:RETURN
2970 ENV 7,10,1,1,1,-9,1:ENT 7,10,-1,1:SOUND 129,100,-10,1,7,7
2980 RETURN
2990 IF al=0 AND xg>3 AND yg>3 THEN RETURN ELSE LOCATE 11,17:PRINT"  ":LOCATE 11,18:PRINT"  "
3000 IF TEST(0,0)=3 THEN FOR t=-100 TO -90:MOVE -10,t:DRAW 26,t,3:NEXT ELSE IF TEST(-79,-100)=1 THEN MOVE 100,-100:DRAW -100,-100,1
3010 IF no=0 THEN RETURN ELSE GOSUB 2160:RETURN
3020 IF gv<30 OR gf<30 THEN POKE &A200,&80:POKE &A201,&93 ELSE POKE &A200,&40:POKE &A201,&8D
3030 IF PEEK(&A202)=10 THEN CLS#1:POKE &A302,0:POKE &A202,69:POKE &A203,0:POKE &A204,2
3040 CALL &A210:CALL &A210:ENV 2,5,1,1,6,-1,1:SOUND 4,0,-1,2,2,0,25:RETURN
3050 CLS#1:POKE &A202,69:GOSUB 3130:cop=3:GOSUB 1500:GOSUB 2340
3060 a%(hg,xg,yg,1)=0:POKE &A302,0:cop=1:GOTO 260
3070 nmo=-1:FOR t=0 TO 5:IF xm(t)=xg AND ym(t)=yg AND hm(t)=hg AND mort(t)=0 THEN nmo=t:RETURN ELSE NEXT:RETURN
3080 ON DG+1 GOSUB 3090,3100,3110,3120:RETURN
3090 FOR T=-70 TO 70 STEP 2:MOVE T,-100:DRAW T,80,3:NEXT:FOR T=-70 TO -40 STEP 2:MOVE T,-20:DRAW T,0,2:NEXT:FOR T=-10 TO -6 STEP 2:MOVE -58,T:DRAWR 6,0,0:NEXT:FOR T=-56 TO -54 STEP 2:MOVE T,-17:DRAW T,-5,0:NEXT:RETURN
3100 FOR T=-114 TO 76 STEP 1.2:MOVE -114,T:DRAW -148,T*1.3,3:NEXT:RETURN
3110 RETURN
3120 FOR T=-114 TO 76 STEP 1.2:MOVE 114,T:DRAW 148,T*1.3,3:NEXT:FOR T=-30 TO -10:MOVE 114,T: