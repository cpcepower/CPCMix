10 '***********************************
20 '*                                 *
30 '*           SOS 100 %             *
40 '*                                 *
50 '* UNE CREATION POUR AMSTRAD 100 % *
60 '*                                 *
70 '* ECRIT PAR : ALAIN  MASSOUMIPOUR *
80 '*                                 *
90 '***********************************
100 '*****************
110 '* REDEFINITIONS *
120 '*****************
130 SYMBOL AFTER 32:MEMORY 19000
140 SYMBOL 65,62,81,81,81,81,95,81,113
150 SYMBOL 67,60,82,80,80,80,80,82,60
160 SYMBOL 69,127,83,80,92,92,80,83,127
170 SYMBOL 73,127,85,20,20,20,20,85,127
180 SYMBOL 74,107,73,28,20,20,84,84,56
190 SYMBOL 77,123,89,85,85,85,81,81,113
200 SYMBOL 78,113,89,89,91,83,83,81,113
210 SYMBOL 79,62,81,81,81,81,81,81,62
220 SYMBOL 80,126,81,81,81,81,94,80,112
230 SYMBOL 83,127,83,80,119,5,5,101,127
240 SYMBOL 85,113,81,81,81,81,81,81,62
250 SYMBOL 255,0,0,63,63,63,63,63,0
260 SYMBOL 254,0,0,254,254,254,254,254,0
270 SYMBOL 253,0,0,255,255,255,255,255,0
280 '**************
290 '* LES ENCRES *
300 '**************
310 DATA 0,14,2,24,20,6,16,15,26,9,13,19,14,2,24,0
320 DATA 14,2,24,13,4,11,24,15,14
330 RESTORE 310:FOR I=0 TO 15:READ A:INK I,A:NEXT
340 FOR I=1 TO 3:FOR J=1 TO 3:READ INC(J,I)
350 NEXT J,I:BORDER 0
360 '***********************
370 '* ENVELOPPES SONNORES *
380 '***********************
390 ENV 1,1,15,1,11,-1,1:ENT 1,1,120,1,12,-10,4
400 ENV 2,13,1,2,16,0,1,15,-1,10:ENT 2,3,7,1,3,-7,1
410 ENV 3,1,15,1,5,-1,4,3,0,1:ENT -3,1,2,1
420 ENV 4,12,-1,16
430 ENV 5,1,12,1,6,-1,2:ENT 5,2,30,1,2,-30,1
440 ENT 6,1,20,1,2,-10,1
450 ENT 7,3,20,1,3,-20,1:ENV 7,1,13,1,6,-2,1,5,0,1
460 ENV 8,1,9,1,9,-1,14:ENT -8,1,-1,1
470 ENV 9,5,2,1,10,-1,4:ENT -9,20,-100,1,20,100,1
480 ENV 10,1,10,1,10,-1,2:ENT 10,4,-40,1,4,40,1
490 ENV 11,15,1,1,15,-1,10
500 ENV 12,5,2,1,10,-1,1
510 '****************
520 '* PRESENTATION *
530 '****************
540 GOSUB 1030
550 DATA 21,20,4E,11,00,C0,01,00,40,ED,B0,C9
560 RESTORE 550:FOR I=40000 TO 40011:READ A$
570 POKE I,VAL("&"+A$):NEXT
580 LOAD"ECRAN1.SOS",20000
590 MODE 0:CALL 40000:GOTO 1300
600 LOAD"ECRAN2.SOS",20000:CALL 40000
610 '**************
620 '* CHARGEMENT *
630 '**************
640 LOAD"SPRITE.SOS":LOAD"PROG.SOS"
650 LOAD"ECRANS.SOS"
660 GOSUB 2180:GOSUB 1870:GOSUB 750:GOSUB 1550
670 '****************
680 '* DEBUT DU JEU *
690 '****************
700 SPEED KEY 1,1:CALL &9095:CALL &BB00
710 GOSUB 750:GOSUB 1550:GOTO 700
720 '****************************
730 '* CHANGEMENT DE PERSONNAGE *
740 '****************************
750 COSMO=COSMO+1:IF PEEK(&95DF)<>20 THEN 770
760 FOR I=1 TO 1000:NEXT:GOTO 860
770 LOCATE 1,1:PRINT CHR$(22)CHR$(1)
780 FOR I=1 TO 3:INK 11+I,INC(I,COSMO):NEXT
790 FOR I=1 TO 3:IF I=COSMO THEN PEN 5 ELSE PEN 2
800 LOCATE 5,18+I*2:PRINT CHR$(255);CHR$(254)
810 NEXT I:PRINT CHR$(22);CHR$(0)
820 IF COSMO<>4 THEN RETURN
830 '********************
840 '* FIN DE LA PARTIE *
850 '********************
860 WINDOW #2,2,16,2,18:PAPER #2,0
870 GOSUB 1800:PEN#1,10:LOCATE#1,2,2
880 PRINT#1,"MISSION     %";
890 PEN#1,0:LOCATE#1,10,2
900 SC=PEEK(&95DF)*5:SC$=STR$(SC)
910 SC$=RIGHT$(SC$,LEN(SC$)-1)
920 IF LEN(SC$)<>3 THEN SC$="0"+SC$:GOTO 920
930 PRINT#1,SC$;:CALL &9934
940 GOSUB 1680::GOTO 660
950 '****************
960 '* DATAS MUSICS *
970 '****************
980 DATA 1,1,1,1,1,0,1,1,0,1,1,0,1,0,1,0
990 DATA 956,804,1204,1432
1000 DATA 80,100,119,100,80,100,134,100
1010 DATA 75,100,119,100,75,89,119,89
1020 DATA 1,2,4,2,1,1,2,2,2,2,1,1,4
1030 DIM RY(16),NO(16):RESTORE 980
1040 FOR I=1 TO 16:READ RY(I):NEXT
1050 FOR I=1 TO 4:READ BAS(I):NEXT
1060 FOR I=1 TO 16:READ NO(I):NEXT
1070 FOR I=1 TO 4:READ DIV(I):NEXT
1080 FOR I=1 TO 9:READ MORS(I):NEXT
1090 '
1100 DATA 716,638,602,536,638,602,451,536,478,536,638,602
1110 '
1120 DIM SO(144),NO2(32)
1130 RESTORE 1100:FOR I=1 TO 4:FOR J=1 TO 4
1140 IF J=4 THEN A=716 ELSE READ A
1150 NO2((I-1)*8+J)=A:NO2((I-1)*8+J+4)=A*2
1160 NEXT J,I
1170 '
1180 DATA 402,478,319,301,268,402,478,319,301,268
1190 DATA 301,358,239,225,201,402,478,319,301,268
1200 DATA 268,319,213,201,179,301,358,239,225,201
1210 '
1220 RESTORE 1180:FOR J=0 TO 5:READ A,B,C,D,E:F=0
1230 FOR I=1 TO 24 STEP 3:SO(I+1+J*24)=A:SO(I+2+J*24)=B
1240 F=F+1:IF F=4 OR F=6 THEN N=D:GOTO 1260
1250 IF F=5 THEN N=E ELSE N=C
1260 SO(I+J*24)=N:NEXT I,J:RETURN
1270 '******************
1280 '* PREMIERE MUSIC *
1290 '******************
1300 CALL &BB03:CALL &BCA7:FOR I=1 TO 9:SOUND 7,30,12*MORS(I),0,1
1310 NEXT I:WHILE SQ(1)<>4:WEND:RY=0:OK=0
1320 GOSUB 1470:EVERY 6 GOSUB 1470
1330 SOUND 5,0,384,0
1340 FOR I=1 TO 2:FOR BAS=1 TO 4:SOUND 4,BAS(BAS)/I,-1,2,2,1
1350 SOUND 1,BAS(BAS)-BAS,-1,2,2,1:NEXT BAS,I
1360 FOR J=1 TO 2:FOR BAS=1 TO 4:FOR I=1 TO 4
1370 SOUND 1,BAS(BAS)/DIV(I),24,0,3:NEXT I
1380 SOUND 4,BAS(BAS)/2,96,15,2,1:NEXT bas,j
1390 FOR J=1 TO 4:FOR BAS=0 TO 3:FOR I=1 TO 4
1400 SOUND 4,BAS(BAS+1)/DIV(I),24,1,3
1410 FOR P=1 TO 2:NO=NO+1:IF NO=5 THEN NO=1
1420 IF J>2 THEN PP=ROUND(I/2) ELSE PP=1
1430 SOUND 1,NO(NO+BAS*4)/PP,12,10,0,2
1440 NEXT P,I,BAS,J:SOUND 1,60,-1,12,4,3
1450 SOUND 4,119,-1,12,4,3:WHILE SQ(1)<>4:WEND
1460 A=REMAIN(0):GOTO 1300
1470 RY=RY+1:IF RY=17 THEN RY=1:OK=1
1480 IF OK=1 THEN RYTH=RY*1.9
1490 SOUND 2,RY(RY)*60,12,0,RY(RY),0,RYTH
1500 IF INKEY(47)<>0 THEN RETURN
1510 A=REMAIN(0):CALL &BCA7:GOTO 600
1520 '******************
1530 '* DEUXIEME MUSIC *
1540 '******************
1550 FO=0:CALL &BB03:CALL 37000
1560 FOR L=1 TO 2:FOR K=1 TO 32
1570 DIV=1:FO=FO+1:IF FO=9 THEN FO=1
1580 IF L=2 AND FO<5 THEN DIV=2
1590 SOUND 1,NO2(K),-1,3,5,5:SOUND 1,956,-1,3,5
1600 SOUND 2,NO2(K)/(DIV*2),-1,3,5,4+DIV:SOUND 2,478,-1,3,5
1610 SOUND 4,NO2(K)/64,13,7:SOUND 4,NO2(K)/32,13,8
1620 IF INKEY(47)=0 THEN 1640
1630 NEXT K,L:FO=0:GOTO 1560
1640 CALL &BCA7:RETURN
1650 '*******************
1660 '* TROISIEME MUSIC *
1670 '*******************
1680 CALL &BB03:FOR J=1 TO 2:F=0:MUL=0:FOR I=1 TO 144:DIV=1
1690 IF J=1 THEN 1710 ELSE IF F=6 THEN MUL=MUL XOR 1
1700 F=F+1:IF F=7 THEN F=1:DIV=4*(MUL+1) ELSE DIV=2
1710 SOUND 1,SO(I)/DIV,11,13,0,7:SOUND 1,(J*SO(I))/16,1,10+J
1720 SOUND 4,SO(I)+1,12,13,0,7
1730 BA=BA+1:IF BA=25 THEN BA=1
1740 SOUND 2,0,-1,2,7,,BA
1750 IF INKEY(47)=0 THEN RETURN
1760 NEXT I,J:GOTO 1680
1770 '************************
1780 '* S/P FENETRE CENTRALE *
1790 '************************
1800 WINDOW #1,2,16,8,12:PAPER #1,8
1810 CLS#1:PLOT 48,278,0:DRAWR 448,0
1820 DRAWR 0,-64:DRAWR -448,0:DRAWR 0,64
1830 RETURN
1840 '***************
1850 '* LES TOUCHES *
1860 '***************
1870 GOSUB 1800:PEN#1,10
1880 LOCATE #1,2,2:PRINT#1,"(J)oy  (C)urs"
1890 CALL &9934
1900 IF INKEY(62)=0 THEN RESTORE 1990:GOTO 1930
1910 IF INKEY(54)=0 THEN 2040
1920 IF INKEY(45)<>0 THEN 1900 ELSE RESTORE 2000
1930 POKE &95E0,102:POKE &95E1,1
1940 POKE &95DF,0:PEN 0:LOCATE 12,23
1950 PRINT CHR$(22)CHR$(1);CHR$(255);STRING$(6,253);
1960 PRINT CHR$(254);CHR$(22);CHR$(0);
1970 FOR I=0 TO 4:READ A:POKE &91E0+I*5,A:NEXT I
1980 CALL &90AD:RETURN
1990 DATA 240,241,242,243,32
2000 DATA 11,10,8,9,88
2010 '**********
2020 '* BALADE *
2030 '**********
2040 XMI=0:YMI=0:XMA=56:YMA=84
2050 X=42:Y=14:GOTO 2120
2060 IF INKEY(8)=0 AND X<>XMI THEN X=X-1:GOTO 2120
2070 IF INKEY(1)=0 AND X<>XMA THEN X=X+1:GOTO 2120
2080 IF INKEY(0)=0 AND Y<>YMI THEN Y=Y-1:GOTO 2120
2090 IF INKEY(2)=0 AND Y<>YMA THEN Y=Y+1:GOTO 2120
2100 IF INKEY(47)=0 THEN 2140
2110 GOTO 2060
2120 SHG=22000+X*2+Y*142:S1=INT(SHG/256):S2=SHG-S1*256
2130 POKE &9185,S2:POKE &9186,S1:CALL &90AD:GOTO 2060
2140 POKE &9185,8:POKE &9186,94:CALL &90AD:GOTO 1870
2150 '******************
2160 '* INITIALISATION *
2170 '******************
2180 WINDOW #2,2,16,2,18:PAPER #2,0
2190 RESTORE 2220:FOR K=1 TO 4:READ P1(K),P2(K):NEXT
2200 FOR K=1 TO 4:TY=P2(K):FOR P=1 TO P1(K):READ I,J
2210 GOSUB 2300:NEXT P,K:COSMO=0:CLS#2:RETURN
2220 DATA 20,13,22,28,11,27,6,26
2230 DATA 4,5,7,11,10,26,14,21,16,21,23,21,25,26,32,16,36,17,37,17
2240 DATA 38,25,48,9,55,7,58,7,55,14,56,25,52,25,61,19,63,14,18,21
2250 DATA 18,4,10,20,6,43,34,25,37,40,25,50,57,19,55,43,51,50,65,24
2260 DATA 19,68,18,89,12,95,25,55,25,68,33,89,55,62,49,75,54,90,63,95
2270 DATA 66,68,66,75
2280 DATA 52,14,20,14,47,35,53,35,10,50,8,68,10,62,59,55,26,62,65,75,61,90
2290 DATA 38,40,22,55,25,62,58,55,12,14,66,6
2300 TYP=20000+(TY-1)*32
2310 T1=INT(TYP/256):T2=TYP-T1*256
2320 ADR=22000+I*2+(J+1)*71*2
2330 POKE ADR,T2:POKE ADR+1,T1
2340 RETURN