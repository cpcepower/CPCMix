10 '*****************
20 '*** FRAG-QUIZ ***
30 '***  written  ***
40 '*** by M.S.P. ***
50 '***   (CC)    ***
60 '*****************
70 CALL &BB4E:CALL &BC02:pp=0:OUT &BC00,1:OUT &BD00,0
80 PEN 1:PAPER 0:MODE 1:DEFINT a-y
90 ON BREAK GOSUB 1810
100 IF PEEK(6)=&80 THEN cpc=-1:stell=&B28F:bu=&B091 ELSE stell=&B72F:bu=&B075
110 SYMBOL AFTER 256:IF PEEK(bu)<>4 THEN OPENOUT"a":MEMORY HIMEM-1:CLOSEOUT
120 SYMBOL AFTER 32:GOSUB 1140:fr$(1)="":an$(1)="":rn(1)=0
130 ERASE fr$,an$,rn:WINDOW 3,30,3,18:DIM fr$(50),an$(50),rn(50):PEN 1
140 FOR a=1 TO 4:richti(a)=0:pu(a)=0:oft(a)=0:NEXT:s=-1
150 WHILE NOT pp:WEND:FOR a=0 TO 40:OUT &BC00,1:OUT &BD00,a:CALL &BD19:NEXT
160 IF getkey=-1 THEN WHILE INKEY$<>"":WEND:CALL &BB06:getkey=0:CLS
170 ret=-1:WINDOW SWAP 0,1:GOSUB 1510:WINDOW SWAP 0,1:LOCATE 3,2:PRINT"Wie viele Spieler nehmen"
180 LOCATE 4,3:PRINT"teil (1-4) ?  1":sp=1
190 LOCATE 18,3:PRINT USING"#";sp;
200 GOSUB 2630:sp=sp+re
210 IF sp=0 THEN sp=4
220 IF sp=5 THEN sp=1
230 IF NOT fe THEN 190
240 IF sp<4 THEN LOCATE#1,2,24:PRINT#1,STRING$(30,"-");
250 IF sp<3 THEN LOCATE#1,2,23:PRINT#1,STRING$(30,"-");
260 IF sp<2 THEN LOCATE#1,2,22:PRINT#1,STRING$(30,"-");
270 LOCATE 6,6:PRINT"Wie spaet ist es"
280 LOCATE 8,7:PRINT"jetzt ?  0: 0";SPACE$(8);:t=0:m=0
290 LOCATE 16,7:PRINT USING"##:##";t,m;
300 GOSUB 2630:m=m+ob:IF m=60 THEN m=0
310 IF m<0 THEN m=59
320 t=t+re:IF t<0 THEN t=23
330 IF t=24 THEN t=0
340 IF NOT fe THEN 290
350 stu=t:minu=m:LOCATE#1,34,23:PRINT#1,USING"##:##";t,m;
360 WHILE INKEY$<>"":WEND:EVERY 3000,2 GOSUB 2760
370 CLS:FOR a=1 TO sp:PRINT"Spieler Nr."STR$(a)","
380 INPUT"Name ";a$
390 IF LEN(a$)>9 THEN PRINT:PRINT"Nur 9 Zeichen !":PRINT:GOTO 380
400 sp$(a+4)=a$+","
410 IF LEN(a$)<9 THEN a$=a$+" ":GOTO 410
420 sp$(a)=a$:LOCATE#1,2,20+a:PRINT#1,sp$(a):PRINT:NEXT
430 CLS:PEN 1:LOCATE 4,10:PRINT"Welche Fragen laden ?":fr=1:fr$="0A"
440 LOCATE 12,12:PRINT USING"##";fr;:PRINT"/";fr$;
450 GOSUB 2630:fr=fr+re:IF fr<1 THEN fr=30
460 IF fr>30 THEN fr=1
470 IF ob=1 THEN fr$="0B"ELSE IF ob=-1 THEN fr$="0A"
480 IF NOT fe THEN 440
490 u$=MID$(STR$(fr),2):IF LEN(u$)<2 THEN u$="0"+u$
500 n$=MID$(fr$,2)
510 n$="fragquiz."+u$+n$:GOSUB 1720
520 LOCATE#1,34,20:PRINT#1,USING"##";fr;:PRINT#1,"/";fr$;
530 '*** Menue ***
540 PEN 1:CLS:LOCATE(28-LEN(ub1$))/2,2:PRINT ub1$:LOCATE(28-LEN(ub2$))/2,3:PRINT ub2$
550 ub=MAX(LEN(ub1$),LEN(ub2$)):LOCATE(28-ub)/2,4:PRINT STRING$(ub,"-")
560 GOSUB 2440:PEN 3:GOSUB 790:PEN 1:FOR a=1 TO 5:ON a GOSUB 800,810,820,830,840:NEXT:q=1:qq=2
570 PEN 1:ON qq GOSUB 790,800,810,820,830,840:PEN 3:ON q GOSUB 790,800,810,820,830,840:qq=q
580 GOSUB 2630:q=q-ob:IF q<1 THEN q=6
590 IF q>6 THEN q=1
600 IF fe THEN 630
610 IF xxx=0 THEN GOSUB 2440
620 IF q<>qq THEN 570 ELSE 580
630 xxx=45:pr=REMAIN(1):GOSUB 2580:PEN 2:ON q GOSUB 860,430,660,1840,2700,2600
640 GOTO 540
650 '*** Zeit ***
660 LOCATE 7,3:PRINT"Wieviel Zeit pro"
670 LOCATE 6,4:PRINT"Frage ? ";z$;SPACE$(14);:za=zei/50:mi=INT(za/60):se=za MOD 60
680 LOCATE 14,4:PRINT USING"##:##";mi,se;
690 GOSUB 2630:mi=mi+ob:IF mi=100 THEN IF se>0 THEN mi=0 ELSE mi=1
700 IF mi<0 THEN mi=99
710 se=se+re:IF se=60 THEN IF mi>0 THEN se=0 ELSE se=1
720 IF se<0 THEN se=59
730 IF NOT fe THEN 680
740 IF cpc THEN z$=DEC$((mi,"##")+":"+DEC$((se,"##")ELSE z$=DEC$(mi,"##")+":"+DEC$(se,"##")
750 zei=(60*mi+se)*50
760 LOCATE#1,34,17:PRINT#1,z$
770 RETURN
780 '*** Sub - Menuezeilen ***
790 LOCATE 2,6:PRINT"(1) --------------- Weiter":RETURN
800 LOCATE 2,7:PRINT"(2) --------- Fragen laden":RETURN
810 LOCATE 2,8:PRINT"(3) ------ Zeit einstellen":RETURN
820 LOCATE 2,9:PRINT"(4) --------- Sound an/aus":RETURN
830 LOCATE 2,10:PRINT"(5) --------- Programmende":RETURN
840 LOCATE 2,11:PRINT"(6) ------------- Neustart":RETURN
850 '*** Abfragen ***
860 i=i+1:IF i>50 THEN CLS:LOCATE 4,3:PRINT"Neue Fragen laden !":WHILE INKEY$<>"":WEND:CALL &BB06:CLS:GOTO 430
870 zon=956:zs=zon/(zei/2)
880 spi=spi+1:IF spi>sp THEN spi=1
890 LOCATE 2,2:PRINT sp$(spi+4)
900 PRINT fr$(rn(i)):FOR a=1 TO 500:NEXT
910 AFTER zei,3 GOSUB 1120
920 flag=0:WHILE flag=0:zon=MAX(zon,1)
930 IF s THEN SOUND 2,zon,4,15
940 IF INKEY(9)=-1 AND INKEY(76)=-1 THEN zon=zon-zs:WEND
950 re=REMAIN(3):PRINT
960 PRINT" Richtige Antwort:"
970 PRINT an$(rn(i)):PRINT
980 PRINT TAB(6);"Hast Du richtig"
990 PRINT TAB(7);"geantwortet ?"
1000 PRINT:te$="NEIN"
1010 CALL &BD19:PRINT TAB(11);te$;CHR$(11);
1020 GOSUB 2630:IF re=-1 THEN te$="NEIN"
1030 IF re=1 THEN te$=" JA "
1040 IF NOT fe THEN 1010
1050 IF te$=" JA "THEN richti(spi)=richti(spi)+1:pu(spi)=pu(spi)+1
1060 oft(spi)=oft(spi)+1:GOSUB 1930
1070 IF te$=" JA "THEN spi=spi-1:ja=-1 ELSE ja=0
1080 IF NOT s THEN RETURN
1090 IF ja THEN FOR a=956 TO 1 STEP-4:SOUND 2,a,1,15:NEXT
1100 IF NOT ja THEN FOR a=956 TO 1911 STEP 4:SOUND 2,a,1,15:NEXT
1110 FOR a=1 TO 2000:NEXT:GOSUB 2580:RETURN
1120 flag=1:RETURN
1130 '*** Maskenaufbau ***
1140 getkey=-1:RESTORE 1570:FOR a=1 TO 6:READ b,c,d
1150 LOCATE b,c:PRINT STRING$(d,CHR$(154));
1160 NEXT:FOR a=1 TO 7:READ b,c,d
1170 FOR e=0 TO d-1:LOCATE b,c+e
1180 PRINT CHR$(149);:NEXT e,a
1190 FOR a=1 TO 14:READ b,c,d:LOCATE b,c
1200 PRINT CHR$(d);:NEXT
1210 GOSUB 1970
1220 LOCATE 2,2:PRINT CHR$(150);STRING$(28,154);CHR$(156);
1230 FOR a=3 TO 18:LOCATE 2,a:PRINT CHR$(149):LOCATE 31,a:PRINT CHR$(149):NEXT
1240 LOCATE 2,19:PRINT CHR$(147);STRING$(28,154);CHR$(153);
1250 LOCATE 33,15:PRINT CHR$(150);STRING$(5,154);CHR$(156);
1260 LOCATE 33,16:GOSUB 1700
1270 LOCATE 33,17:GOSUB 1700
1280 LOCATE 33,18:PRINT CHR$(151);STRING$(5,154);CHR$(157);
1290 LOCATE 33,19:GOSUB 1700:LOCATE 33,20:GOSUB 1700
1300 LOCATE 33,21:PRINT CHR$(151);STRING$(5,154);CHR$(157);
1310 LOCATE 33,22:GOSUB 1700:LOCATE 33,23:GOSUB 1700
1320 LOCATE 33,24:PRINT CHR$(147);STRING$(5,154);CHR$(153);
1330 LOCATE 33,6:PRINT STRING$(7,154);
1340 LOCATE 33,10:PRINT STRING$(7,154);
1350 wort$="FRAG":xx=526:yy=382
1360 bx=1:by=2:grx=3:gry=4
1370 f=1:s=-2:GOSUB 1620
1380 xx=90:yy=365:bx=5:by=8:grx=10:gry=16:f=2:s=0:GOSUB 1620
1390 wort$="QUIZ":xx=526:yy=348
1400 bx=1:by=2:grx=3:gry=4
1410 f=2:s=-2:GOSUB 1620
1420 xx=90:yy=240:bx=5:by=8:grx=10:gry=16:f=3:s=0:GOSUB 1620
1430 wort$="M.S.P.":xx=524:yy=240
1440 bx=1:by=2:grx=2:gry=3
1450 f=3:s=-1:GOSUB 1620
1460 POKE stell,109
1470 LOCATE 33,7:PRINT"written"
1480 LOCATE 33,8:PRINT"in 1988"
1490 LOCATE 34,9:PRINT CHR$(164)" by:"
1500 LOCATE 34,13:PRINT"-CC-"
1510 FOR a=1 TO 4:LOCATE 2,20+a:PRINT"Spieler"+STR$(a);
1520 PRINT": Punkte:    0 -   0%":NEXT:IF ret THEN RETURN
1530 LOCATE 34,16:PRINT"Zeit:":LOCATE 34,17:z$=" 0:30":PRINT z$:zei=1500
1540 LOCATE 34,19:PRINT"Frg.:":LOCATE 35,20:PRINT"0/0A"
1550 LOCATE 34,22:PRINT"Uhr:":LOCATE 34,23:PRINT" 0: 0"
1560 WINDOW SWAP 0,1:RETURN
1570 DATA 2,1,30,33,1,7,33,14,7,2,20,30,2,25,30,33,25,7
1580 DATA 1,2,18,1,21,4,32,2,12,32,15,5,32,21,4,40,2,12,40,15,10
1590 DATA 1,1,150,1,20,151,1,25,147,32,1,158,32,14,151
1600 DATA 32,20,157,32,25,155,40,1,156,40,14,157,40,25,153,32,6,151,32,10,151,40,6,157,40,10,157
1610 '*** Multi-Script ***
1620 FOR a=1 TO LEN(wort$)
1630 wz=ASC(MID$(wort$,a,1))
1640 FOR b=1 TO 8:byte(b)=PEEK(HIMEM+(wz-32)*8+b):NEXT
1650 FOR c=7 TO 0 STEP-1
1660 FOR d=1 TO 8
1670 IF byte(d)>=2^c THEN byte(d)=byte(d)-2^c:FOR y1=0 TO by STEP 2:PLOT xx+a*8*grx-c*grx+d*s,yy-d*gry+y1,f:DRAWR bx,0:NEXT
1680 NEXT:NEXT
1690 NEXT:RETURN
1700 PRINT CHR$(149);SPACE$(5);CHR$(149);:RETURN
1710 '*** Fragen laden ***
1720 CLS:LOCATE 4,2:PRINT"Bitte Fragen-Diskette"
1730 LOCATE 5,3:PRINT"einlegen, dann eine"
1740 LOCATE 7,4:PRINT"Taste druecken !"
1750 WHILE INKEY$<>"":WEND:CALL &BB06
1760 LOCATE 4,7:PRINT"Bitte warten - laden !"
1770 PRINT:OPENIN""+n$:LINE INPUT#9,ub1$:LINE INPUT#9,ub2$:FOR a=1 TO 50
1780 LINE INPUT#9,fr$(a):LINE INPUT#9,an$(a):NEXT
1790 CLOSEIN:GOSUB 1890:i=0:RETURN
1800 '*** Programmende ***
1810 FOR a=40 TO 0 STEP-1:OUT &BC00,1:OUT &BD00,a:CALL &BD19:NEXT
1820 MODE 2:PEN 1:PAPER 0:OUT &BC00,1:OUT &BD00,40:CLEAR:END
1830 '*** Sound an/aus ***
1840 IF s THEN s=0 ELSE s=-1
1850 CLS:LOCATE 7,3:PRINT"Sound ist ";
1860 IF s THEN PRINT"an !"ELSE PRINT"aus !"
1870 WHILE INKEY$<>"":WEND:CALL &BB06:RETURN
1880 '*** Fragen mischen ***
1890 RANDOMIZE TIME/zei:FOR a=1 TO 50
1900 rn(a)=a:NEXT:FOR a=1 TO 50:k=CINT(RND*49+1)
1910 t=rn(a):rn(a)=rn(k):rn(k)=t:NEXT:RETURN
1920 '*** Punkte ***
1930 LOCATE#1,21,20+spi:PRINT#1,USING"####";pu(spi);
1940 pro(spi)=100/oft(spi)*richti(spi):LOCATE#1,28,20+spi:PRINT#1,USING"###";pro(spi);:RETURN
1950 NEXT:RETURN
1960 '*** Titelmusik ***
1970 ENV 1,5,-1,5,10,-1,20
1980 ENV 2,6,1,4,10,1,20:RESTORE 2030
1990 READ bob,cob:SOUND 1,bob,cob,15,1:xxx=xxx+1
2000 SOUND 4,bob*2,cob,120/cob,2
2010 IF xxx<197 THEN AFTER cob/2.2,1 GOSUB 1990:RETURN
2020 xxx=0:rema=REMAIN(1):pp=-1:RETURN
2030 DATA 1,80,159,20,127,20,106,20,80,20,142,20,84,20
2040 DATA 80,40,159,10,1,30,159,10,1,30
2050 DATA 159,20,127,20,106,20,80,20,142,20,84,20
2060 DATA 80,40,159,10,1,30,159,10,1,30
2070 DATA 95,30,1,10,95,30,1,10,95,20,80,20
2080 DATA 106,10,1,30,106,10,1,30,106,20,80,20
2090 DATA 119,40,106,20,119,20,127,20,119,20
2100 DATA 142,120
2110 DATA 159,20,127,20,106,20,80,20,142,20,84,20
2120 DATA 80,40,159,10,1,30,159,10,1,30
2130 DATA 159,20,127,20,106,20,80,20,142,20,84,20
2140 DATA 80,40,159,10,1,30,159,10,1,30
2150 DATA 95,40,106,20,119,20,127,20,142,20
2160 DATA 106,40,119,20,127,20,142,20,159,20
2170 DATA 142,20,127,20,119,40,1,40
2180 DATA 169,40,159,120,1,80
2190 DATA 159,20,142,20,127,20,142,20,159,20,169,20
2200 DATA 159,40,190,10,1,30,190,10,1,30
2210 DATA 80,20,84,20,95,20,80,20,84,20,95,20
2220 DATA 84,40,127,10,1,30,127,10,1,30
2230 DATA 80,20,84,20,95,20,80,20,84,20,95,20
2240 DATA 84,40,127,10,1,30,95,40
2250 DATA 84,20,80,20,71,20,1,20,100,40
2260 DATA 95,40,100,20,95,20,84,40
2270 DATA 80,30,1,10,80,20,84,20,95,20,106,20
2280 DATA 95,30,1,10,95,20,106,20,119,20,127,20
2290 DATA 119,30,1,10,119,20,127,20,142,20,159,20
2300 DATA 169,40,190,20,169,20,213,40
2310 DATA 142,40,213,10,1,30,213,10,1,30
2320 DATA 127,40,213,10,1,30,213,10,1,30
2330 DATA 119,40,106,20,119,20,95,20,106,20
2340 DATA 142,120
2350 DATA 159,20,127,20,106,20,80,20,142,20,84,20
2360 DATA 80,40,159,10,1,30,159,10,1,30
2370 DATA 159,20,127,20,106,20,80,20,142,20,84,20
2380 DATA 80,40,159,10,1,30,159,10,1,30
2390 DATA 95,40,106,20,119,20,127,20,142,20
2400 DATA 106,40,119,20,127,20,142,20,159,20
2410 DATA 142,20,127,20,119,40,1,40
2420 DATA 169,40,159,120
2430 '*** Menue-Sound ***
2440 RESTORE 2490:xxx=0:IF NOT s THEN RETURN
2450 READ bob,cob:SOUND 1,bob,cob,15,1:xxx=xxx+1
2460 SOUND 4,bob*2,cob,120/cob,2
2470 IF xxx<46 THEN AFTER 20,1 GOSUB 2450:RETURN
2480 xxx=0:rema=REMAIN(1):RETURN
2490 DATA 1,80,106,80,127,20,95,20,106,80,127,20,80,20
2500 DATA 84,80,95,20,84,20,80,80,84,20,95,20
2510 DATA 106,80,127,20,95,20,106,80,127,20,80,20
2520 DATA 84,80,95,20,84,20,80,100,1,20
2530 DATA 80,80,84,20,95,20,106,80,119,20,127,20
2540 DATA 142,80,127,20,119,20,127,100,1,20
2550 DATA 80,80,84,20,95,20,106,80,119,20,127,20
2560 DATA 142,80,127,20,142,20,159,100,1,120
2570 '*** Sub - Tonende ***
2580 SOUND 135,0,1,1:CLS:RETURN
2590 '*** Neustart ***
2600 FOR a=40 TO 0 STEP-1:OUT &BC00,1:OUT &BD00,a:CALL &BD19:NEXT
2610 FOR a=1 TO 500:NEXT:GOTO 130
2620 '*** Tastatur-Abfrage ***
2630 FOR a=1 TO 100:NEXT:re=0:IF INKEY(74)>-1 OR INKEY(8)>-1 THEN re=-1
2640 IF INKEY(75)>-1 OR INKEY(1)>-1 THEN re=1
2650 ob=0:IF INKEY(72)>-1 OR INKEY(0)>-1 THEN ob=1
2660 IF INKEY(73)>-1 OR INKEY(2)>-1 THEN ob=-1
2670 IF INKEY(9)=-1 AND INKEY(76)=-1 THEN fe=0 ELSE fe=-1
2680 RETURN
2690 '*** Gewinner anzeigen ***
2700 FOR a=1 TO sp:help(a)=sp:NEXT:FOR a=1 TO sp-1:FOR b=a+1 TO sp
2710 IF richti(a)*5+pro(a)<richti(b)*5+pro(b)THEN help(b)=help(b)-1 ELSE help(a)=help(a)-1
2720 NEXT:NEXT
2730 CLS:FOR a=1 TO sp:PRINT:PRINT USING" #.  ";a;:FOR b=1 TO sp:IF help(b)=a THEN PRINT sp$(b)": "richti(b)*5+pro(b)"Punkte"ELSE NEXT
2740 PRINT:NEXT:CALL &BB00:CALL &BB03:CALL &BB06:GOTO 1810
2750 '*** Zeit ***
2760 minu=minu+1:IF minu=60 THEN minu=0:stu=stu+1:IF stu=24 THEN stu=0
2770 LOCATE#1,34,23:PRINT#1,USING"##:##";stu,minu;:RETURN