10 REM Le Mans
20 REM By R.A.Waddilove
30 REM(c)Amstrad Semanal
40 GOSUB 1290:REM Inicializa
50 GOSUB 2020:REM Instrucciones
60 WHILE dead.interested
70 GOSUB 2300:REM Parrilla de Salida
80 GOSUB 920:REM Pantalla
90 AFTER 2000,0 GOSUB 600
100 WHILE lives
110 WHILE ok
120 GOSUB 320:REM Pista
130 GOSUB 260:REM Tu coche
140 GOSUB 360:REM Coche 1
150 GOSUB 450:REM Coche 2
160 GOSUB 540:REM Marchas
170 GOSUB 320:REM Pista
180 GOSUB 260:REM Tu coche
190 GOSUB 540:REM Marchas
200 WEND
210 GOSUB 750:REM Choque
220 WEND
230 IF score>hiscore(10) THEN GOSUB 2420:REM Max.puntuacion
240 WEND
250 END
260 REM --------- Mueve coche ---------
270 SOUND 129,960,500,8+gear,0,1:SOUND 130,1205,500,8+gear,0,1:ax=x+(INKEY(left)>-1)-(INKEY(right)>-1):IF ax<4 THEN ax=4 ELSE IF ax>16 THEN ax=16
280 IF RND*dif<0.6 THEN RETURN ELSE POKE &A034,16:CALL &BD19:CALL &A000,x,22,ax,22,&A100:x=ax
290 IF b>21 THEN IF ABS(x-a)<3 THEN ok=NOT ok:RETURN
300 IF d>21 THEN IF ABS(x-c)<3 THEN ok=NOT ok
310 RETURN
320 REM --------- Pista ---------
330 g=(g+1)MOD 3:IF g=0 THEN CALL &BD19:INK 0,9:INK 1,19:INK 2,21:INK 4,13:INK 5,13:INK 6,26:RETURN
340 IF g=1 THEN CALL &BD19:INK 0,21:INK 1,9:INK 2,19:INK 4,26:INK 5,13:INK 6,13:RETURN
350 CALL &BD19:INK 0,19:INK 1,21:INK 2,9:INK 4,13:INK 5,26:INK 6,13:RETURN
360 REM ----- Mueve coche 1 ----------
370 IF b=23 THEN LOCATE a,b:PRINT "  ":a=0:b=0:score=score+gear:LOCATE 8,25:PRINT MID$(STR$(score),2):RETURN
380 f=(f+1)MOD (dif+1):POKE &A034,8
390 IF a=0 THEN a=10:b=12:CALL &A000,a,b,a,b,gp(0):SOUND 132,900,500,10,0,1:RETURN
400 IF f=0 THEN aa=a+(x<a)-(x>a) ELSE aa=a-(b>20)*(x<a)+(b>20)*(x>a)
410 size=(b-12)\4
420 CALL &A000,a,b,aa,b+1,gp(size):SOUND 132,900,500,10+size*2,0,1
430 a=aa:b=b+1
440 RETURN
450 REM ----- Mueve coche 2 ----------
460 IF d=23 THEN LOCATE c,d:PRINT "  ":c=0:d=0:score=score+gear:LOCATE 8,25:PRINT MID$(STR$(score),2):RETURN
470 h=(h+1)MOD dif:POKE &A034,8
480 IF c=0 THEN c=10:d=12:CALL &A000,c,d,c,d,gp(0):SOUND 132,900,500,10,0,1:RETURN
490 IF h=0 THEN cc=c+(x<c)-(x>c) ELSE cc=c-(d>20)*(x<c)+(d>20)*(x>c)
500 size=(d-12)\4
510 CALL &A000,c,d,cc,d+1,gp(size):SOUND 132,900,500,10+size*2,0,1
520 c=cc:d=d+1
530 RETURN
540 REM ------ Cambia marcha ---------
550 IF gear<5 THEN gear=gear-(INKEY(up)>-1)
560 IF gear>1 THEN gear=gear+(INKEY(down)>-1)
570 LOCATE 19,25:PRINT MID$(STR$(gear),2,1)
580 FOR i=1 TO 550-gear*100:NEXT
590 RETURN
600 REM -------- noche -------------
610 INK 15,13:INK 3,11:dif=dif-1
620 AFTER 2000,0 GOSUB 640
630 RETURN
640 REM ----------------------------
650 INK 15,0:INK 3,1:dif=dif-1
660 AFTER 2000,0 GOSUB 680
670 RETURN
680 REM ----------------------------
690 INK 15,13:INK 3,11:dif=dif-1
700 AFTER 2000,0 GOSUB 720
710 RETURN
720 REM ----------------------------
730 INK 15,11:INK 3,20:dif=dif-1
740 RETURN
750 REM --------- Choque --------
760 PRINT CHR$(30);CHR$(22);CHR$(1)
770 FOR i=0 TO 30
780 SOUND 129,10+INT(RND*1000),10,15,0,0,15
790 PEN 7+INT(RND*4):LOCATE x+INT(RND*2),23-INT(RND*2):PRINT CHR$(216+INT(RND*8))
800 FOR delay=1 TO 100:NEXT
810 NEXT
820 PRINT CHR$(22);CHR$(0)
830 SOUND 130,0,0,0:SOUND 132,0,0,0
840 lives=lives-1
850 IF lives=0 THEN RETURN
860 FOR i=30 TO 610 STEP 4
870 MOVE i,20:DRAW 320,250,14
880 NEXT
890 f=0:a=10:b=12:c=10:d=16:h=0:gear=1:ok=-1
900 PEN 7
910 RETURN
920 REM -------- Pantalla ----------
930 PRINT CHR$(23);CHR$(0):INK 8,15:INK 9,6:INK 10,12:INK 11,3
940 MODE 0:INK 14,0:INK 3,20:INK 7,2:BORDER 1
950 INK 15,11:PAPER 15:CLS
960 ORIGIN 1000,1000,1000,2000,3000,4000:ORIGIN 0,0,0,640,0,400:CLG 15:PLOT -10,-10,3:FOR j=1 TO 10:x=RND*640:y=252+RND*150:TAG:FOR i=1 TO 10:MOVE x+RND*32,y+RND*16:PRINT CHR$(231);:NEXT:TAGOFF:NEXT
970 INK 12,4:INK 13,8
980 y=254:j=0
990 PLOT -10,-10,j MOD 3
1000 FOR i=y TO y-j STEP -2
1010 MOVE 0,i:DRAW 638,i
1020 NEXT
1030 j=j+1:y=y-j
1040 IF y>0 THEN 990
1050 FOR i=1 TO 10
1060 x=640*RND:y=280+RND*20:PLOT -10,-10,13:r=0-4*INT(RND*3)
1070 FOR j=-20-4*(INT(RND*4)) TO 20+4*(INT(RND*4))
1080 MOVE x,y:DRAW x+j,252
1090 IF j=r THEN PLOT -10,-10,12
1100 NEXT
1110 NEXT
1120 x=320:PLOT -10,-10,14
1130 FOR i=0 TO 640 STEP 4
1140 MOVE i,0:DRAW x,252
1150 IF i=320 THEN x=x+4
1160 NEXT
1170 x=316:PRINT CHR$(23);CHR$(3)
1180 FOR i=-32 TO 0 STEP 4
1190 MOVE i,0:DRAW x,252,4
1200 IF i=320 THEN x=x+8
1210 NEXT
1220 FOR i=640 TO 672 STEP 4
1230 MOVE i,0:DRAW 324,252
1240 NEXT
1250 PRINT CHR$(23);CHR$(0):ORIGIN 1000,1000,1000,2000,3000,4000:CLG 14:ORIGIN 0,0,0,640,0,400:PLOT -10,-10,11
1260 PEN 7:PAPER 14:LOCATE 2,25:PRINT "Score:0     Gear:1"
1270 f=0:a=10:b=12:c=14:d=18:h=0:gear=1:ok=-1:x=8:score=0:lives=3:dif=6
1280 RETURN
1290 REM ------- Inicializa ------
1300 MEMORY &9FFF
1310 DEFINT a-z
1320 dead.interested=-1
1330 RESTORE
1340 ENT 1,5,2,1,5,-1,1
1350 DIM gp(3),name$(10),hiscore(10):gp(0)=&A200:gp(1)=&A1C0:gp(2)=&A180
1360 FOR i=1 TO 10:name$(i)="The A Team":hiscore(i)=600-i*50:NEXT
1370 a=&A000
1380 FOR i=1 TO 11
1390 sum=0:READ a$,b$
1400 FOR j=1 TO 21 STEP 2
1410 k=VAL("&"+MID$(a$,j,2)):POKE a,k
1420 sum=sum+k:a=a+1
1430 NEXT
1440 IF sum<>VAL("&"+b$) THEN PRINT "Error in data...":STOP
1450 NEXT
1460 DATA DD7E003257A0DD7E013258,46A
1470 DATA A026C0DD7E043D87876F11,4B0
1480 DATA 5000DD4602051910FDE526,3AB
1490 DATA C0DD7E083D87876F115000,43E
1500 DATA DD4606051910FD111008ED,36A
1510 DATA 5379A043F3C53A7AA047E5,5E7
1520 DATA 363F2310FBE17CC6086730,465
1530 DATA 040150C009C110E7E11100,3C8
1540 DATA 003A79A047C53A7AA047E5,4DF
1550 DATA 1A77231310FAE17CC60867,463
1560 DATA 30040150C009C110E6FBC9,4C9
1570 FOR i=0 TO 319:READ j:POKE &A100+i,j:NEXT
1580 RETURN
1590 REM Carrera de coches
1600 REM Filas=16/Columnas=8
1610 DATA 63,3,63,195,195,63,3,63,63,3,107,207,207,151,3,63,63,3,75,139,71,135
1620 DATA 3,63,3,3,107,139,71,151,3,3,23,3,199,199,203,203,3,43,23,23,195,203
1630 DATA 199,195,43,43,23,23,199,75,135,203,43,43,23,23,199,143,79,203,43,43
1640 DATA 23,67,15,15,15,15,131,43,23,7,207,143,79,207,11,43,23,67,199,79,143
1650 DATA 203,131,43,23,23,195,195,195,195,43,43,23,23,107,195,195,151,43,43
1660 DATA 23,23,63,63,63,63,43,43,23,23,63,63,63,63,43,43,3,23,63,63,63,63,43
1670 DATA 3
1680 REM  Corredor bueno
1690 REM Filas=8/Columnas=8
1700 DATA 63,3,63,131,67,63,3,63,3,3,67,195,195,131,3,3,23,3,199,79,143,203
1710 DATA 3,43,71,23,199,143,79,203,43,139,23,3,15,15,15,15,3,43,71,23,199,143
1720 DATA 79,203,43,139,23,23,107,195,195,151,43,43,3,23,63,63,63,63,43,3
1730 REM Corredor medio
1740 REM Filas=8/Columnas=8
1750 DATA 63,63,63,63,63,63,63,63,63,43,23,131,67,43,23,63,63,3,3,195,195,3
1760 DATA 3,63,63,3,107,15,15,151,3,63,63,3,71,143,79,139,3,63,63,3,107,195
1770 DATA 195,151,3,63,63,3,63,63,63,63,3,63,63,63,63,63,63,63,63,63
1780 REM Corredor bajo
1790 REM Filas=8/Columnas=8
1800 DATA 63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,43,43,23,23
1810 DATA 63,63,63,63,23,195,195,43,63,63,63,63,7,15,15,11,63,63,63,63,23,63
1820 DATA 63,43,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63
1830 REM -------- musica --------
1840 WHILE INKEY(47)<0 AND INKEY(76)<0
1850 RESTORE 1960:READ pitch:SOUND 129,213,200,12:SOUND 130,253,2000,12:SOUND 1,127,2000,12
1860 WHILE pitch>0 AND INKEY(47)<0 AND INKEY(76)<0
1870 SOUND 4,pitch,10,14:SOUND 4,159,10,14:READ pitch
1880 WEND
1890 READ pitch:SOUND 129,319,200,13:SOUND 1,213,200,13:SOUND 1,159,200,13
1900 WHILE pitch>0 AND INKEY(47)<0 AND INKEY(76)<0
1910 SOUND 4,pitch,12,15:READ pitch
1920 WEND
1930 WEND
1940 IF INKEY(47)>-1 THEN up=0:down=2:left=8:right=1 ELSE up=72:down=73:left=74:right=75
1950 RETURN
1960 DATA 142,127,119,106,119,127,142,127,119,106,119,127,127,119,106,95,106,119,127,119,106,95,106,119,119,106,95,84,95,106,119,106,95,84,95,106
1970 DATA 0
1980 DATA 80,84,95, 84,95,106, 95,106,119, 106,119,127
1990 DATA 80,84,95, 84,95,106, 95,106,119, 106,119,127
2000 DATA 142,127,119, 127,119,106, 119,106,95, 106,95,84,80
2010 DATA 119,127,142,159,169,190,213,239,253,284,319,253,284,319,239,253,284,213,239,253,190,213,239,169,190,213,190,179,169,159,142,159,0
2020 REM ----- instrucciones ------
2030 MODE 1:CALL &BB4E:CALL &BC02
2040 INK 0,13:BORDER 13:INK 1,18:INK 2,1:INK 3,13
2050 WINDOW #1,11,31,1,3:PAPER #1,2:CLS #1
2060 WINDOW #1,10,30,2,4:PAPER #1,1:CLS #1
2070 PEN 3:LOCATE 1,25:PRINT "Le  Mans":PLOT -10,-10,3
2080 FOR x=0 TO 128 STEP 2:FOR y=2 TO 14 STEP 2
2090 IF TEST(x,y) THEN PLOT x+230,y+y+344:PLOT x+230,y+y+346
2100 NEXT:NEXT:PEN #1,2:INK 3,6
2110 WINDOW #1,2,40,5,24:PAPER #1,3:CLS #1
2120 WINDOW #1,1,39,6,25:PAPER #1,1:CLS #1
2130 PRINT #1
2140 PRINT #1," Rugen los motores en linea de salida."
2150 PRINT #1," Los coches son rapidamente montados    por pilotos y copilotos."   
2160 PRINT #1," Y alla van..!"  
2170 PRINT #1
2180 PRINT #1," Necesitaras ser habil,atrevido y tener rapidos reflejos de experto campeon si quieres ser el ganador del Grand Prix"
2190 PRINT #1
2200 PRINT #1," Y conseguir la fama y el dinero."   
2210 PRINT #1
2220 PRINT #1," Usa las teclas  izquierda  y  derecha" 
2230 PRINT #1," del cursor para mover el coche,arriba"
2240 PRINT #1," y abajo para cambiar de marcha "
2250 PRINT #1:PRINT #1:PRINT #1,SPC(11)"O usa Joystick"
2260 PEN #1,1:PAPER #1,2:LOCATE #1,6,19:PRINT #1," Pulsa ESPACIO o  FUEGO para empezar ":PAPER #1,0
2270 WHILE INKEY$<>"":WEND
2280 GOSUB 1830
2290 RETURN
2300 REM ------- Parrilla de Salida ----
2310 i=REMAIN(0)
2320 MODE 1:BORDER 1:INK 0,13:INK 1,20:INK 2,6:INK 3,26
2330 DRAW 0,398,1:DRAW 638,398:DRAW 638,0:DRAW 0,0
2340 PAPER 2:PEN 3:LOCATE 11,2:PRINT "   Parrilla de Salida   ":PAPER 0
2350 FOR i=1 TO 10
2360 LOCATE 11+10*(i AND 1),2+i*2:PEN 1:PRINT name$(i)
2370 NEXT
2380 PAPER 3:PEN 2:LOCATE 8,24:PRINT " Pulsa ESPACIO o FUEGO para empezar "
2390 WHILE INKEY$<>"":WEND:GOSUB 1830
2400 SOUND 129,0:SOUND 130,0:SOUND 132,0
2410 RETURN
2420 REM ------- Max.Puntos -------
2430 MODE 1:INK 0,0:INK 1,24:INK 2,20:INK 3,6
2440 DRAW 0,398,1:DRAW 638,398:DRAW 638,0:DRAW 0,0
2450 PEN 1:PAPER 0:LOCATE 7,5:PRINT "Este es el nuevo record"
2460 LOCATE 10,10:PEN 3:PRINT "Escribe tu nombre"
2470 LOCATE 14,20:PAPER 2:PEN 3:PRINT " ?.......... "
2480 LOCATE 16,20:k$="":name$(10)=""
2490 WHILE INKEY$<>"":WEND
2500 WHILE k$<>CHR$(13)
2510 IF k$>CHR$(31) AND k$<"z" AND LEN(name$(10))<10 THEN name$(10)=name$(10)+k$:PRINT k$;
2520 IF k$=CHR$(127) AND LEN(name$(10)) THEN name$(10)=LEFT$(name$(10),LEN(name$(10))-1):PRINT CHR$(8);CHR$(16);
2530 k$=INKEY$
2540 WEND
2550 hiscore(10)=score
2560 FOR i=10 TO 2 STEP -1
2570 IF hiscore(i)>hiscore(i-1) THEN k$=name$(i):name$(i)=name$(i-1):name$(i-1)=k$:score=hiscore(i):hiscore(i)=hiscore(i-1):hiscore(i-1)=score
2580 NEXT
2590 RETURN