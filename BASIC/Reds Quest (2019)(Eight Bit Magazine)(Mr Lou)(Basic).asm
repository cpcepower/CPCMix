10 REM Reds Quest - An extension of Red Meets The Grumpy Grumbles
20 REM By Ross Simpson aka Out Bush (because I work out in the Bush)
30 REM Music By Roald Strauss aka mr_lou
101 DEFINT a-z:MODE 0:BORDER 0:INK 0,0:FOR i=1 TO 6:INK i,0:NEXT i:d=0:c=2:GOSUB 110:d=1:c=1:GOSUB 110:GOSUB 1000:PEN 1:CALL &7CC0,1:INK 1,24:INK 2,2:FOR d=1 TO 2000:NEXT d
102 LOCATE 5,16:PRINT"By Ross Simpson":LOCATE 8,18:PRINT"Music By":LOCATE 6,19:PRINT"Roald Strauss"
103 WHILE INKEY$<>"":WEND:GOTO 3000
110 RESTORE 150:FOR n=1 TO 8:READ a$:g=0:FOR j=1 TO LEN(a$):WHILE MID$(a$,j,1)="1":a$=CHR$(0):c$=BIN$(ASC(a$)):WEND:b$=a$
120 IF b$<>CHR$(0) THEN c$=BIN$(ASC(MID$(b$,j,1)),8)
130 FOR l=1 TO 8:PEN c:LOCATE l+d+g,n+5:IF MID$(c$,l,1)="1" THEN PRINT CHR$(143);
140 NEXT l:g=g+8:NEXT j:PRINT:NEXT n:RETURN
150 DATA "Jäà","ªŠ@","ªˆ@","ªÄ@","ª‚@","ªŠ@","Nä@"," 11"
1000 i=2:WHILE i<>6
1010 IF i=2 THEN RESTORE 2000 ELSE IF i=3 THEN RESTORE 2010 ELSE IF i=4 THEN RESTORE 2020 ELSE IF i=5 THEN RESTORE 2030
1020 DIM t(10)
1030 FOR p=1 TO 10
1040   READ t(p)
1050 NEXT p
1060 p=1:i=i+1
1070 PLOT t(p),t(p+1),i
1080 FOR p=3 TO 9 STEP 2
1090   DRAWR t(p),t(p+1)
1100 NEXT p
1101 ERASE t
1102 CALL &7CC0,2:INK i,6
1103 IF i=6 THEN FOR d=1 TO 1000:NEXT d
1110 WEND
1120 RETURN
2000 DATA 288,366,0,32,12,-12,-12,-10,12,-10
2010 DATA 308,366,32,8,-16,8,-16,-16,32,-8
2020 DATA 352,366,0,32,16,-16,-20,-16,4,32
2030 DATA 388,398,-16,-14,16,-4,-16,-14,0,6
2999 REM Title Screen Music
3000 RELEASE 7
3010 tempo%=15:' Smaller = faster
3020 ENV 1,15,0,15:ENV 2,15,-1,4:ENV 3,15,-1,4:ENV 4,15,-1,4:ENV 5,5,-1,3:ENV 6,5,-1,6:ENV 7,5,-1,5:ENV 8,5,-1,4:ENV 9,5,-1,3:ENV 10,0,-4,1,2,-1,1:ENV 11,0,-4,1,2,-1,1:ENV 12,0,-11,1
3030 c%=0:RESTORE 3090
3040 DIM tone%(11):itt%=9
3050 DIM sequence1%(8):DIM sequence2%(8):DIM sequence3%(8)
3060 FOR n%=1 TO 8:READ sequence1%(n%):NEXT
3070 FOR n%=1 TO 8:READ sequence2%(n%):NEXT
3080 FOR n%=1 TO 8:READ sequence3%(n%):NEXT
3090 DATA 5,6,3,3,7,8,3,9
3100 DATA 1,1,2,0,0,0,2,0
3110 DATA 10,0,4,0,11,0,4,0
3120 WHILE INKEY$=""
3130 ON SQ(1) GOSUB 3160
3140 WEND:CLEAR
3150 GOTO 4010
3160 IF itt%=9 THEN FOR n%=1 TO 11:READ tone%(n%):NEXT:itt%=1:c%=c%+1:IF c%=17 THEN sequence2%(4)=2 ELSE IF c%=33 THEN sequence2%(5)=1 ELSE IF c%=52 THEN RESTORE 3280:c%=0:sequence3%(2)=10:sequence3%(6)=11
3170 s1%=tone%(sequence1%(itt%)):s2%=tone%(sequence2%(itt%)):s3%=tone%(sequence3%(itt%))
3180 IF s1%>0 THEN v1%=15:e1%=sequence1%(itt%) ELSE IF r1%>0 THEN s1%=r1%:e1%=12 ELSE v1%=0
3190 IF s2%>0 THEN v2%=15:e2%=sequence2%(itt%) ELSE IF r2%>0 THEN s2%=r2%:e2%=12 ELSE v2%=0
3200 IF s3%>0 THEN v3%=15:e3%=sequence3%(itt%) ELSE IF r3%>0 THEN s3%=r3%:e3%=12 ELSE v3%=0
3210 SOUND 1,s1%,tempo%,v1%,e1%
3220 SOUND 2,s2%,tempo%,v2%,e2%
3230 SOUND 4,s3%,tempo%,v3%,e3%
3240 IF s1%>0 THEN r1%=s1%
3250 IF s2%>0 THEN r2%=s2%
3260 IF s3%>0 THEN r3%=s3%
3270 itt%=itt%+1:RETURN
3280 DATA 851,426,358,284,0,0,0,0,0,0,0
3290 DATA 1276,536,426,319,0,0,0,0,0,0,0
3300 DATA 1136,478,379,284,0,0,0,0,0,0,0
3310 DATA 1276,536,426,319,0,0,0,0,0,0,0
3320 DATA 851,426,358,284,0,0,0,0,0,0,0
3330 DATA 1276,536,426,319,0,0,0,0,0,0,0
3340 DATA 1136,478,379,284,0,0,0,0,0,0,0
3350 DATA 1136,568,478,379,0,0,0,0,0,0,0
3360 DATA 851,426,358,284,0,0,0,0,0,106,95
3370 DATA 1276,536,426,319,0,0,0,0,0,89,80
3380 DATA 1136,478,379,284,0,0,0,0,0,95,0
3390 DATA 1276,536,426,319,0,0,0,0,0,0,0
3400 DATA 851,426,358,284,0,0,0,0,0,106,95
3410 DATA 1276,536,426,319,0,0,0,0,0,89,80
3420 DATA 1136,478,379,284,0,0,0,0,0,95,0
3430 DATA 1136,568,478,379,0,0,0,0,0,0,0
3440 DATA 851,426,358,284,106,0,106,119,0,0,0
3450 DATA 1276,536,426,319,142,0,142,159,0,0,0
3460 DATA 1136,478,379,284,142,0,142,119,0,0,0
3470 DATA 1276,536,426,319,142,0,142,119,0,0,0
3480 DATA 851,426,358,284,106,0,106,119,0,0,0
3490 DATA 1276,536,426,319,142,0,142,159,0,0,0
3500 DATA 1136,478,379,284,142,0,142,159,0,0,0
3510 DATA 1136,568,478,379,190,0,142,119,0,0,0
3520 DATA 851,426,358,284,106,0,106,119,0,53,47
3530 DATA 1276,536,426,319,142,0,142,159,0,45,40
3540 DATA 1136,478,379,284,142,0,142,119,0,47,0
3550 DATA 1276,536,426,319,142,0,142,119,0,0,0
3560 DATA 851,426,358,284,106,0,106,119,0,53,47
3570 DATA 1276,536,426,319,142,0,142,159,0,45,40
3580 DATA 1136,478,379,284,142,0,142,159,0,47,0
3590 DATA 1136,568,478,379,190,0,142,119,0,60,0
3600 DATA 851,426,358,284,106,0,106,119,0,53,47
3610 DATA 1276,536,426,319,142,0,142,159,0,45,40
3620 DATA 1136,478,379,284,142,0,142,119,0,47,60
3630 DATA 1276,536,426,319,142,0,142,119,0,71,60
3640 DATA 851,426,358,284,106,0,106,119,0,53,47
3650 DATA 1276,536,426,319,142,0,142,159,0,45,40
3660 DATA 1136,478,379,284,142,0,142,159,0,47,0
3670 DATA 1136,568,478,379,190,0,142,119,0,0,0
3680 DATA 851,426,358,284,106,0,106,119,0,53,47
3690 DATA 1276,536,426,319,142,0,142,159,0,45,40
3700 DATA 1136,478,379,284,142,0,142,119,0,47,60
3710 DATA 1276,536,426,319,142,0,142,119,0,71,60
3720 DATA 851,426,358,284,106,0,106,119,0,53,47
3730 DATA 1276,536,426,319,142,0,142,159,0,45,40
3740 DATA 1136,478,379,284,142,0,142,159,0,47,0
3750 DATA 1136,568,478,379,190,0,142,119,0,47,0
3760 DATA 851,568,426,358,0,0,0,0,0,1703,1703
3770 DATA 851,568,426,358,0,0,0,0,0,1703,1703
3780 DATA 851,568,426,358,0,0,0,0,0,1703,1703
3790 DATA 851,568,426,358,0,0,0,0,0,1703,1703
4000 ' Setup Screen, Inks & Pen
4010 CALL &BC02:MODE 0:PEN 1:INK 0,3:INK 1,3:INK 8,9:INK 9,18:INK 10,15:INK 14,12:INK 15,10:BORDER 3
4020 ' Setup Variables & Gfx
4030 DEFINT a-z:DIM m$(17,17),f(4),g(4),h(4),tp(4)
4050 SYMBOL 252,64,184,168,64
4060 SYMBOL 253,56,68,68,56
4070 SYMBOL 254,0,56,56
4080 SYMBOL 255,0,0,0,0,16,16,16
4110 ' Draw Maze
4120 IF sc=0 THEN RESTORE 5050
4130 IF sc=1 THEN RESTORE 5230
4140 IF sc=2 THEN RESTORE 5410
4150 IF sc=3 THEN RESTORE 5590
4160 IF sc=4 THEN RESTORE 5770
4170 IF sc=5 THEN RESTORE 5950
4180 IF sc=6 THEN RESTORE 6130
4190 FOR y=1 TO 17
4200   READ a$
4210   FOR x=1 TO 17
4220     m$(x,y)=MID$(a$,x,1)
4230     IF m$(x,y)="1" THEN i=8:z=x:w=y:GOSUB 4849
4240   NEXT x
4250   PRINT
4260 NEXT y
4270 sc=sc+1
4280 GOSUB 6390
4290 ' Setup Positon of Red
4300 z=2:w=2:c=1:GOSUB 4940
4310 ' Setup Positions of Grumpy Grumbles and Directional Control
4320 IF sc=1 THEN RESTORE 6310
4330 IF sc=2 THEN RESTORE 6320
4340 IF sc=3 THEN RESTORE 6330
4350 IF sc=4 THEN RESTORE 6340
4360 IF sc=5 THEN RESTORE 6350
4370 IF sc=6 THEN RESTORE 6360
4380 IF sc=7 THEN RESTORE 6370
4390 READ f(1),g(1),tp(1),h(1),f(2),g(2),tp(2),h(2),f(3),g(3),tp(3),h(3),f(4),g(4),tp(4),h(4),kx,ky,ex,ey
4400 PEN 1:LOCATE kx,ky:PRINT CHR$(252);:INK 1,26
4410 ' Main Game Loop
4420 q=0:tx=444:ty=110:s=0
4430 IF INKEY(74)=0 THEN IF m$(z-1,w)="0" THEN c=0:GOSUB 4940:c=1:z=z-1:GOSUB 4940
4440 IF INKEY(75)=0 THEN IF m$(z+1,w)="0" THEN c=0:GOSUB 4940:c=1:z=z+1:GOSUB 4940
4450 IF INKEY(72)=0 THEN IF m$(z,w-1)="0" THEN c=0:GOSUB 4940:c=1:w=w-1:GOSUB 4940
4460 IF INKEY(73)=0 THEN IF m$(z,w+1)="0" THEN c=0:GOSUB 4940:c=1:w=w+1:GOSUB 4940
4470 ' Move Grumpy Grumbles & Check Collisions
4480 FOR p=1 TO 4
4500 IF z=f(p) THEN IF w=g(p) THEN PEN 3:GOSUB 5000
4510 IF q=1 THEN GOTO 4640
4520 x=f(p):y=g(p):c=0:GOSUB 4970
4530 f(p)=f(p)+h(p):x=f(p):c=tp(p):GOSUB 4970
4540 IF m$(f(p)+1,g(p))="1" THEN h(p)=-1
4550 IF m$(f(p)-1,g(p))="1" THEN h(p)=1
4560 IF z=f(p) THEN IF w=g(p) THEN PEN 3:GOSUB 5000
4570 NEXT p
4580 s=(s+1) MOD 3:IF s=0 THEN GOSUB 6490
4590 IF z=kx THEN IF w=ky THEN x=ex:y=ey:GOSUB 4982:c=0:m$(ex,ey)="0":GOSUB 4970
4600 IF z=1 THEN IF w=15 THEN IF sc<7 THEN CLS:GOTO 4120:ELSE IF z=1 THEN IF w=15 THEN IF sc=7 THEN CALL &7BF0:ENT 1,200,-2,2:SOUND 1,142,140,15,,1:q=1
4610 IF q=0 THEN IF tx>158 THEN GOTO 4430
4620 IF tx<158 THEN ENT 1,200,2,2:SOUND 1,142,140,15,,1:LOCATE 7,22:PEN 3:PRINT"TIMES UP!":q=2
4630 IF q=2 THEN LOCATE 9,20:PEN 8:PRINT"GAME":PEN 11:LOCATE 9,21:PRINT"OVER"
4640 CALL &BB03 ' Flush Keyboard Buffer
4650 CALL &BB18 ' Wait for Keypress
4660 CLEAR
4670 GOTO 101
4848 ' Draw Tree
4849 PRINT CHR$(22)+CHR$(1) ' Turn on Transparent Mode
4850 FOR c=253 TO 255
4860 PEN i
4870 LOCATE z,w
4880 PRINT CHR$(c);
4890 i=i+1
4900 NEXT c
4910 PRINT CHR$(22)+CHR$(0) ' Turn off Transparent Mode
4920 RETURN
4930 ' Display Sprite - c = Sprite Number, z = xpos, w = ypos
4940 SOUND 1,200,1,15,,,31:CALL &7D00,c,z,w
4950 RETURN
4960 ' As above but this uses x & y for xpos and ypos
4970 CALL &7D00,c,x,y
4980 RETURN
4981 ' Has key been reached?
4982 IF m$(ex,ey)="1" THEN ENV 1,127,3,4:SOUND 1,3255,30,7,1
4983 RETURN
4990 ' A Collision has occurred
5000 LOCATE z,w:ENT 1,200,-2,2:SOUND 1,1000,50,15,,1,2
5010 PRINT CHR$(238);
5020 q=2
5030 RETURN
5040 ' Screen 1
5050 DATA 11111111111111111
5060 DATA 10101010100000001
5070 DATA 10101010111011101
5080 DATA 10000000000010001
5090 DATA 10111011111111101
5100 DATA 10001000000000101
5110 DATA 10111111111011101
5120 DATA 10100000100010001
5130 DATA 11101110101111101
5140 DATA 10000010001000101
5150 DATA 11101111101110101
5160 DATA 10101000000010001
5170 DATA 10111011111110111
5180 DATA 10001010001000001
5190 DATA 01101010101111101
5200 DATA 10000000101000001
5210 DATA 11111111111111111
5220 ' Screen 2
5230 DATA 11111111111111111
5240 DATA 10101010101000101
5250 DATA 10101010101011101
5260 DATA 10000000101000001
5270 DATA 10101010101110101
5280 DATA 10101010000000101
5290 DATA 11101111101110111
5300 DATA 10000000101000001
5310 DATA 11101111111101101
5320 DATA 10101000100000101
5330 DATA 10111010111010101
5340 DATA 10000010000010101
5350 DATA 10111110101110101
5360 DATA 10101000101000101
5370 DATA 01001011111010111
5380 DATA 10101010000010001
5390 DATA 11111111111111111
5400 ' Screen 3
5410 DATA 11111111111111111
5420 DATA 10101010000000101
5430 DATA 10101010111110101
5440 DATA 10001010100000101
5450 DATA 10111010111110101
5460 DATA 10100000001010001
5470 DATA 10101110111010101
5480 DATA 10001010101000101
5490 DATA 11111011101010111
5500 DATA 10000010000010101
5510 DATA 10111010111111101
5520 DATA 10100010001010001
5530 DATA 10111010111011101
5540 DATA 10001010000000101
5550 DATA 01101110111110101
5560 DATA 10100000100000001
5570 DATA 11111111111111111
5580 ' Screen 4
5590 DATA 11111111111111111
5600 DATA 10101010001000001
5610 DATA 10101011101011111
5620 DATA 10000000001000001
5630 DATA 10111011101010101
5640 DATA 10001010100010101
5650 DATA 11101110111010101
5660 DATA 10100000001010101
5670 DATA 10111110111010111
5680 DATA 10001010100010001
5690 DATA 11101011111010101
5700 DATA 10001010001010101
5710 DATA 10111010111011111
5720 DATA 10000010001000001
5730 DATA 00101010111110111
5740 DATA 10101010000000001
5750 DATA 11111111111111111
5760 ' Screen 5
5770 DATA 11111111111111111
5780 DATA 10000000101000001
5790 DATA 11101110101010101
5800 DATA 10000010000010101
5810 DATA 11111011111111101
5820 DATA 10000010100010101
5830 DATA 10111010101110101
5840 DATA 10101010000000001
5850 DATA 11101110111111111
5860 DATA 10000010101010001
5870 DATA 10111011101010101
5880 DATA 10101000001000101
5890 DATA 10101111101010111
5900 DATA 10000010100010001
5910 DATA 00111010111111101
5920 DATA 10000010000000001
5930 DATA 11111111111111111
5940 ' Screen 6
5950 DATA 11111111111111111
5960 DATA 10100000000010001
5970 DATA 10111110111111101
5980 DATA 10001000001000001
5990 DATA 10101111101011101
6000 DATA 10100000000010101
6010 DATA 10101110101110101
6020 DATA 10101010101000101
6030 DATA 10101010111110111
6040 DATA 10101000100000001
6050 DATA 11111111101011111
6060 DATA 10000000101000101
6070 DATA 10111110101011101
6080 DATA 10001000001000001
6090 DATA 00111010111010111
6100 DATA 10000010100010001
6110 DATA 11111111111111111
6120 ' Screen 7
6130 DATA 11111111111111111
6140 DATA 10000000000010101
6150 DATA 11101010101010101
6160 DATA 10001010101000001
6170 DATA 11111111111111101
6180 DATA 10100000100010001
6190 DATA 10111010101110111
6200 DATA 10001010001010001
6210 DATA 10101110111010111
6220 DATA 10101000100010001
6230 DATA 11101011101010101
6240 DATA 10000000101010101
6250 DATA 10101110111010111
6260 DATA 10100010000010001
6270 DATA 00111011111110111
6280 DATA 10000010000000001
6290 DATA 11111111111111111
6300 ' Data positions for Grumbles
6310 DATA 12,6,2,1,7,12,3,1,8,16,4,-1,14,14,5,-1,12,16,2,15
6320 DATA 4,4,2,1,7,8,3,-1,9,6,4,1,8,12,5,1,4,10,2,15
6330 DATA 5,6,2,1,16,6,3,-1,12,14,4,1,14,12,5,1,16,10,2,15
6340 DATA 9,4,2,-1,12,4,3,1,14,14,4,-1,3,14,5,1,16,8,7,14
6350 DATA 4,4,2,-1,10,4,3,1,12,8,4,-1,5,14,5,-1,2,8,8,11
6360 DATA 8,6,2,1,10,10,3,1,3,14,4,-1,5,16,5,-1,6,8,16,9
6370 DATA 12,2,2,-1,12,4,3,1,10,6,4,1,4,12,5,1,16,6,13,6
6380 ' Print Time Bar 
6390 LOCATE 1,19
6400 PRINT"TIME:"
6410 LOCATE 6,19
6420 PAPER 3
6430 PRINT SPACE$(2);
6440 PAPER 4
6450 PRINT SPACE$(7)
6460 PAPER 0
6470 RETURN
6480 ' Reduce Time Remaining
6490 PLOT tx,ty,0
6500 DRAW tx,ty-16
6510 tx=tx-4
6520 RETURN