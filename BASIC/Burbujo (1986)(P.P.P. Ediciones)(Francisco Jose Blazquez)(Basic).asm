10 '************************************
20 '************************************ 
30 '************            ************
40 '***            BURBUJO           ***
50 '************            ************
60 '************            ************
70 '************            ************
80 '
90 '   ** POR FCO.J.BLAZQUEZ (c)1986 ** 
100 '
110 ' ************* INICIO *******
120 ON BREAK GOSUB 2880   
130 INK 3,25:INK 2,19:INK 1,24
140 CLEAR:MODE 1:INK 0,0:BORDER 0
150 DIM MALACOSA(20):DIM botella(10)
160 DIM n(100):DIM d(100)
170 DIM popode(20):DIM muritov(12)  
180 DIM posicion$(12,12):bubu=100:bobo=192
190 RESTORE 3160:FOR k=1 TO 98:READ n,d:LET n(k)=n:d(k)=d:ON BREAK GOSUB 2880 
200 NEXT
210 GOTO 3040
220 FOR gg=1 TO 4:LET defensores(gg)=gg+6:NEXT
230 FOR l=1 TO 5:LET boteh(l)=INT(RND(1)*12)+1:LET botev(l)=INT(RND(1)*12)+1:NEXT
240 FOR l=4 TO 8:LET rayah(l)=11:LET rayav(l)=l:NEXT     
250 FOR l=1 TO 5:LET ladrilloh(l)=l:LET ladrillov(l)=13-l:NEXT
260 GOSUB 810
270 dh=RND(1)*400:dv=RND(1)*200:kks=10
280 RESTORE 2430:FOR k=1 TO 12:FOR j=1 TO 12:READ posicion$(k,j):NEXT:NEXT  
290 FOR j=1 TO 12
300 LET malacosa(j)=11
310 muritov(j)=j  
320 NEXT:i=320:ii=200    
330 MODE 0:fuerzah=INT(RND(1)*12)+1:fuerzav=INT(RND(1)*12)+1 
340 FOR j=12 TO 1 STEP-1
350 LET popode(j)=j
360 NEXT:si=320:sii=200     
370 INK 0,0:INK 4,6,3:INK 6,9:INK 11,26,24:INK 8,14:INK 5,0,6   
380 INK 1,25:INK 2,2:INK 3,18,24:BORDER 0:en=30000     
390 planta=INT(RND(1)*12)+1:cuadro=INT(RND(1)*12)+1   
400 fff=300:x=100:y=300:GOSUB 500   
410 '********  BUCLE DE JUEGO *****
420 TAG:ORIGIN -1,-1:PLOT 0,0,1:IF INKEY(18)=0 THEN GOSUB 1350:GOSUB 500:ORIGIN -1,-1:PLOT 0,0,1   
430 IF INKEY(47)=0 AND INKEY(17)=0 THEN LIST
440 GOSUB 1550
450 SOUND 2,5,1,14
460 en=en-5:IF en<2000 THEN BORDER 1
470 IF en<500 THEN BORDER 3
480 IF en<0 THEN 2880
490 GOTO 420   
500 CLG:' ****** CAMBIO DE CUADRANTE **
510 TAG:primerbi=0
520 FOR l=1 TO 5:IF (boteh(l)=cuadro AND botev(l)=planta) AND botella(l)=0 THEN PLOT 900,900,3:ORIGIN 100,100:PRINT CHR$(200);CHR$(201);:MOVE 0,-16:PRINT CHR$(202);CHR$(203);:
530 NEXT:IF cuadro=1 THEN SOUND 1,200,1,1:FOR kl=1 TO 400 STEP 32:ORIGIN 0,kl:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT  
540 FOR k=9 TO 12:IF (planta=2 OR planta=3) AND k=cuadro THEN FOR h=1 TO 40:PLOT 1000,0,10:TAG:ORIGIN RND(1)*640,400*RND(1):PRINT CHR$(244);:MOVE 0,16:PRINT CHR$(245);:NEXT:PLOT 1000,1,1 
550 NEXT
560 IF planta=10 THEN FOR h=1 TO 40:PLOT 1000,0,5:TAG:ORIGIN RND(1)*640,400*RND(1):PRINT CHR$(184);:MOVE 0,16:PRINT CHR$(185);:NEXT:PLOT 1000,1,1   
570 IF (fuerzah=cuadro AND fuerzav=planta) AND gastada=0 THEN PLOT 900,900,4:ORIGIN 500,300:PRINT CHR$(130);CHR$(131);:MOVE 0,-16:PRINT CHR$(132);CHR$(133);: 
580 IF cuadro=12 THEN SOUND 1,200,1,1:FOR kl=1 TO 400 STEP 32:ORIGIN 607,kl:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT     
590 IF planta=12 THEN SOUND 1,200,1,1:FOR kl=1 TO 640 STEP 32:ORIGIN kl,383:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT  
600 IF planta=1 THEN SOUND 1,200,1,1:FOR kl=1 TO 640 STEP 32:ORIGIN kl,16:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT
610 IF posicion$(cuadro,planta)="b" THEN GOSUB 2040
620 IF posicion$(cuadro,planta)="c" THEN GOSUB 2080:GOSUB 3320
630 IF posicion$(cuadro,planta)="d" THEN GOSUB 2110
640 IF posicion$(cuadro,planta)="e" THEN GOSUB 2150
650 IF posicion$(cuadro,planta)="f" THEN GOSUB 2190
660 IF posicion$(cuadro,planta)="g" THEN GOSUB 2230
670 IF posicion$(cuadro,planta)="h" THEN GOSUB 2260
680 IF posicion$(cuadro,planta)="i" THEN GOSUB 2300
690 IF posicion$(cuadro,planta)="j" THEN GOSUB 2340
700 IF posicion$(cuadro,planta)="k" THEN GOSUB 2380:GOSUB 3360
710 IF posicion$(cuadro,planta)="a" THEN GOSUB 2000
720 RETURN
730 '******* VIENE UN EXTRAGNO ****
740 LET hh=(x-i)/8:LET hv=(y-ii)/8
750 IF primerbi=0 THEN GOSUB 2750:primerbi=1
760 LET i=i+hh:LET ii=ii+hv   
770 PLOT 650,400,2:ORIGIN i,ii:PRINT CHR$(199)+CHR$(198);:MOVE 0,-16:PRINT CHR$(197)+CHR$(196);:PLOT 650,400,1:RETURN
780 '********* PUERTAS *************
790 FOR kl=1 TO 145 STEP 32:ORIGIN 304,kl:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:ORIGIN 304,400-kl:PRINT CHR$(222);CHR$(222);:MOVE 0,-16:PRINT CHR$(223);CHR$(223);:NEXT:RETURN
800 '****** DEF CARACTERES GRAFICOS **
810 SYMBOL AFTER 32
820 SYMBOL 179,218,138,218,80,218,138,218,80
830 SYMBOL 168,24,60,126,231,195,0,24,60
840 SYMBOL 169,255,231,0,0,24,255,255,0
850 SYMBOL 244,124,60,60,60,28,26,8:SYMBOL 245,0,0,16,26,62,124,124,254
860 SYMBOL 180,17,31,29,13,63,102,194,128:SYMBOL 181,136,248,184,176,252,102,67,1
870 SYMBOL 255,56,124,214,214,254,198,108,0
880 SYMBOL 182,254,126,60,60,28,24,16,16:SYMBOL 183,16,16,16,16,16,56,56,16
890 SYMBOL 150,0,7,28,48,32,96,64,64
900 SYMBOL 184,126,231,231,126,24,24,60,231:SYMBOL 185,231,60,24,24,126,231,231,126
910 SYMBOL 158,255
920 SYMBOL 156,0,224,56,12,4,6,2,2
930 SYMBOL 151,128,128,128,128,128,128,128,128
940 SYMBOL 159,66,231,231,165,165,165,231,66    
950 SYMBOL 157,1,1,1,1,1,1,1,1
960 SYMBOL 147,64,64,96,32,48,28,7,0
970 SYMBOL 155,0,0,0,0,0,0,0,255
980 SYMBOL 153,2,2,6,4,12,56,224,0
990 SYMBOL 199,192,255,121,121,108,230,194,218
1000 SYMBOL 198,3,255,158,158,54,103,67,91
1010 SYMBOL 197,218,194,255,240,99,38,60,16
1020 SYMBOL 196,91,67,255,15,198,100,60,8
1030 SYMBOL 200,0,60,126,127,126,127,126,127
1040 SYMBOL 201,0,60,254,126,254,126,254,126
1050 SYMBOL 202,132,127,126,127,126,127,126,0
1060 SYMBOL 203,254,126,254,126,254,126,254,0
1070 SYMBOL 130,15,7,7,7,15,31,63,127 
1080 SYMBOL 131,240,160,160,160,176,232,244,250 
1090 SYMBOL 132,127,127,127,127,127,127,63,31   
1100 SYMBOL 133,250,250,250,250,250,250,244,248
1110 SYMBOL 137,60,126,255,147,147,255,126,60
1120 SYMBOL 138,60,24,24,126,255,255,255,126
1130 SYMBOL 139,102,255,137,145,137,145,255
1140 SYMBOL 222,0,126,254,254,254,254,254,126:SYMBOL 223,0,199,239,239,239,239,239,199
1150 SYMBOL 229,231,195,165,24,24,165,195,231
1160 RETURN
1170 ' **** HE TOCADO ALGO ****  
1180 ORIGIN x,y:IF NOT TESTR(8,18)=0 THEN GOSUB 2550      
1190 ORIGIN x,y:IF NOT TESTR(-20,-8)=0 THEN GOSUB 2550   
1200 ORIGIN x,y:IF NOT TESTR(48,-8)=0 THEN GOSUB 2550 
1210 ORIGIN x,y:IF NOT TESTR(8,-32)=0 THEN GOSUB 2550
1220 RETURN
1230 '****** QUE COSA TOQUE ****
1240 FOR kl=200 TO 190 STEP-2:ENT 1,100,5,5:INK 2,8,4:BORDER 8,4:SOUND 1,kl,20,15,1,1:NEXT:INK 2,2:BORDER 0:en=en-3000 
1250 RETURN
1260 FOR kl=40 TO 10 STEP-2:ENT 1,100,1,1:SOUND 1,kl,1,15,10,1,1:NEXT:en=en-2000:RETURN
1270 FOR kl=400 TO 100 STEP-1:INK 1,24,6:BORDER 8,4:SOUND 1,kl,1,15,2,8,10:NEXT:INK 1,25:BORDER 0:en=en-3000     
1280 RETURN
1290 FOR kl=1 TO 400:BORDER 15:SOUND 1,kl,1,14:SOUND 2,kl*2,1,14:NEXT:BORDER 0
1300 FOR l=1 TO 5:IF (boteh(l)=cuadro AND botev(l)=planta) THEN botella(l)=1:FINALLISTA=FINALLISTA+1:IF FINALLISTA=5 AND gastada=1 THEN GOTO 2880
1310 NEXT:en=en+5000:score=score+15:GOTO 500 
1320 FOR kl=1 TO 26:BORDER kl:SOUND 1,kl,10,14:SOUND 4,30-kl,10,14:NEXT:gastada=1:score=score+25:en=20000:BORDER 0:IF FINALLISTA=5 AND gastada=1 THEN GOTO 2880  
1330 GOTO 500
1340 '****** MAPA ORIENTATIVO **** 
1350 MODE 0:CLG:CLS:CALL 22012:ORIGIN 100,100:DRAW 0,150,10:DRAWR 277,0:DRAWR 0,-150:DRAWR -277,0    
1360 INK 2,11:INK 5,0:INK 7,2:INK 8,3:INK 10,24:INK 14,1:INK 15,6:INK 9,0:INK 1,0:INK 3,0:BORDER 3
1370 FOR l=1 TO FINALLISTA:TAG:PLOT 0,1000,6:ORIGIN 100+(l*50),80:PRINT CHR$(200);CHR$(201);:MOVE 0,-16:PRINT CHR$(202);CHR$(203);:NEXT     
1380 RESTORE 2430:TAG:FOR k=1 TO 12:FOR j=1 TO 12:PLOT 1000,0,10:ORIGIN 100+((k-1)*(45.833333)/2),100+(j*12.5):IF k=cuadro AND j=planta THEN PLOT 1000,0,2:ORIGIN 100+((k-1)*(45.833333)/2),100+(j*12.5)
1390 IF posicion$(k,j)="a" THEN MOVER 0,-(12.55)/2:DRAWR (45.8333333)/2,0:MOVER -(45.8333333)/4,0:DRAWR 0,(-12.55)/2
1400 IF posicion$(k,j)="b" THEN MOVER 2,(-12.55)/2:DRAWR (45.8333333)/4,0:DRAWR 0,(-12.55)/2
1410 IF posicion$(k,j)="c" THEN MOVER 0,(-12.55)/2:DRAWR ((45.8333333)/2)+1,0
1420 IF posicion$(k,j)="d" THEN MOVER 0,(-12.55)/2:DRAWR (45.8333333)/6,0:MOVER (45.8333333)/6,0:DRAWR (45.8333333)/6,0 
1430 IF posicion$(k,j)="e" THEN MOVER 2,(-12.55)/2:DRAWR (45.8333333)/4,0:DRAWR 0,(12.555)/2    
1440 IF posicion$(k,j)="f" THEN MOVER 2,(-12.55)/2:DRAWR (45.8333333)/4,0:MOVER 0,(-12.555)/2:DRAWR 0,(25.196)/2  
1450 IF posicion$(k,j)="g" THEN MOVER ((45.8333333)/4)+2,(-25.196)/2:DRAWR 0,(25.196)/2   
1460 IF posicion$(k,j)="h" THEN MOVER ((45.8333333)/4)+2,(-25.196)/2:DRAWR 0,(25.196)/8:MOVER 0,(25.196)/4:DRAWR 0,(25.196)/8
1470 IF posicion$(k,j)="i" THEN MOVER ((45.8333333)/4)+2,(-25.196)/2:DRAWR 0,(25.196)/2:MOVER 0,-(25.196)/4:DRAWR (45.8333333)/4,0  
1480 IF posicion$(k,j)="j" THEN MOVER 0,(-12.55)/2:DRAWR (45.8333333)/2,0:MOVER -(45.8333333)/4,-(25.196)/4:DRAWR 0,(25.196)/2
1490 IF posicion$(k,j)="k" THEN MOVER 0,(-12.55)/2:DRAWR (45.8333333)/2,0:MOVER -(45.8333333)/4,0:DRAWR 0,(12.55)/2    
1500 IF posicion$(k,j)="o" THEN DRAWR (45.8333333)/2,0:DRAWR 0,(-25.196)/2:DRAWR -45.8333333/2,0:DRAWR 0,25.196/2
1510 NEXT:NEXT
1520 IF INKEY(18)=0 THEN MODE 0:TAG:INK 0,0:INK 4,6,3:INK 6,9:INK 11,26,24:INK 8,14:INK 5,0,6:INK 1,25:INK 2,2:INK 3,18,24:BORDER 0:INK 9,16:RETURN
1530 en=en-0.5:TAG:PLOT 1000,1,6:ORIGIN 130,30:PRINT en;:GOTO 1520  
1540 '******* BURBUJA MOVIL ****
1550 IF INKEY(jk4)=0 THEN x=x+15:ORIGIN x-32,y+16:PRINT " ";:ORIGIN x-32,y:PRINT " ";:ORIGIN x-32,y-16:PRINT " ";:CALL &BD19    
1560 IF INKEY(jk1)=0 THEN y=y+15:ORIGIN x-16,y-32:PRINT "  ";:CALL &BD19  
1570 IF INKEY(jk3)=0 THEN x=x-15:ORIGIN x+32,y+16:PRINT " ";:ORIGIN x+32,y:PRINT " ";:ORIGIN x+32,y-16:PRINT " ";:CALL &BD19     
1580 IF INKEY(jk2)=0 THEN y=y-15:ORIGIN x-16,y+32:PRINT "  ";:CALL &BD19 
1590 TAG:ORIGIN x-16,y+16:PRINT CHR$(150);CHR$(156);:ORIGIN x-16,y:PRINT CHR$(151);CHR$(157);:ORIGIN x-16,y-16:PRINT CHR$(147);CHR$(153); 
1600 TAG:PLOT 1000,0,6:ORIGIN x,y:PRINT CHR$(159);
1610 GOSUB 1180
1620 IF arango=1 THEN GOSUB 1920
1630 IF bichos=1 THEN GOSUB 2670
1640 IF popofe=1 THEN GOSUB 1920
1650 IF defensa=1 THEN GOSUB 2670:GOSUB 740  
1660 IF murito=1 THEN GOSUB 3220
1670 IF rayitta=1 THEN GOSUB 2830
1680 IF ladrillitos=1 THEN GOSUB 2860
1690 IF arango=1 THEN GOSUB 1920 
1700 IF x<35 OR x>600 THEN GOSUB 1730
1710 IF y>365 OR y<33 THEN GOSUB 1730
1720 RETURN
1730 '******* FUERA DE PANTALLA ****
1740 popofe=0:bichos=0:defensa=0:dv=200:dh=320:rayitta=0:ladrillitos=0:murito=0:arango=0
1750 IF x<32 AND cuadro>1 THEN CLS:cuadro=cuadro-1:x=600:CLS:GOSUB 500 
1760 IF y<32 AND planta>1 THEN CLS:planta=planta-1:y=365:CLS:GOSUB 500 
1770 IF y>365 AND planta<12 THEN CLS:planta=planta+1:y=35:CLS:GOSUB 500 
1780 IF x>600 AND cuadro<12 THEN CLS:cuadro=cuadro+1:x=33:CLS:GOSUB 500 
1790 FOR k=1 TO 12:IF malacosa(k)=planta AND cuadro=k THEN bichos=1
1800 IF muritov(k)=cuadro AND planta=4 THEN murito=1
1810 NEXT
1820 FOR l=4 TO 8:IF cuadro=11 AND planta=rayav(l) THEN rayitta=1   
1830 NEXT
1840 FOR l=1 TO 5:IF cuadro=ladrilloh(l) AND planta=ladrillov(l) THEN ladrillitos=1    
1850 NEXT
1860 FOR gg=7 TO 10:IF planta=6 AND cuadro=gg THEN defensa=1
1870 NEXT
1880 FOR k=12 TO 1 STEP-1:IF popode(k)=planta AND cuadro=k THEN popofe=1
1890 NEXT
1900 IF planta=7 THEN arango=1
1910 RETURN
1920 '******* VIENE UN EXTRAGNO2 ****
1930 kuk$=CHR$(255)
1940 IF arango=1 THEN kuk$=CHR$(180)+CHR$(181) 
1950 PLOT 650,400,0:ORIGIN si,sii:PRINT kuk$;:PLOT 650,400,1:  
1960 LET shh=(x-si)/10:LET shv=(y-sii)/10
1970 ENT 1,10,10,1:SOUND 4,14,5,14,1,1 
1980 LET si=si+shh:LET sii=sii+shv
1990 PLOT 650,400,9:ORIGIN si,sii:PRINT kuk$;:PLOT 650,400,1:RETURN 
2000 '******** POSICION A ********
2010 FOR kl=1 TO 200 STEP 32:ORIGIN 304,kl:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT
2020 FOR kl=1 TO 640 STEP 32:ORIGIN kl,192:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT   
2030 RETURN
2040 '******** POSICION B ******** 
2050 FOR kl=1 TO 200 STEP 32:ORIGIN 304,kl:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT     
2060 FOR kl=1 TO 320 STEP 32:ORIGIN kl,192:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT    
2070 RETURN 
2080 '******** POSICION C ********
2090 FOR kl=1 TO 640 STEP 32:ORIGIN kl,192:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT   
2100 RETURN 
2110 '******** POSICION D ********
2120 FOR kl=1 TO 220 STEP 32:ORIGIN kl,192:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT
2130 FOR kl=1 TO 220 STEP 32:ORIGIN 640-kl,192:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT     
2140 RETURN
2150 '******** POSICION E ******** 
2160 FOR kl=1 TO 320 STEP 32:ORIGIN kl,192:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT     
2170 FOR kl=200 TO 400 STEP 32:ORIGIN 304,kl:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT      
2180 RETURN
2190 '******** POSICION F ******** 
2200 FOR kl=1 TO 400 STEP 32:ORIGIN 304,kl:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT     
2210 FOR kl=1 TO 320 STEP 32:ORIGIN kl,192:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT     
2220 RETURN  
2230 '******** POSICION G ******** 
2240 FOR kl=1 TO 400 STEP 32:ORIGIN 304,kl:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT    
2250 RETURN   
2260 '******** POSICION H ******** 
2270 FOR kl=1 TO 160 STEP 32:ORIGIN 304,kl:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT            
2280 FOR kl=1 TO 160 STEP 32:ORIGIN 304,400-kl:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT     
2290 RETURN    
2300 '******** POSICION I ********  
2310 FOR kl=320 TO 640 STEP 32:ORIGIN kl,192:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT    
2320 FOR kl=1 TO 400 STEP 32:ORIGIN 304,400-kl:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT     
2330 RETURN    
2340 '******** POSICION j ********  
2350 FOR kl=1 TO 640 STEP 32:ORIGIN kl,192:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT     
2360 FOR kl=1 TO 400 STEP 32:ORIGIN 304,400-kl:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT            
2370 RETURN    
2380 '******** POSICION K ******** 
2390 FOR kl=1 TO 640 STEP 32:ORIGIN kl,192:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT    
2400 FOR kl=200 TO 400 STEP 32:ORIGIN 304,kl:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);:NEXT    
2410 RETURN       
2420 '********** PLANO ***********
2430 DATA h,a,c,d,d,j,g,h,g,a,d,c
2440 DATA h,b,c,c,c,e,i,i,g,g,f,h
2450 DATA g,a,c,c,k,a,d,k,g,g,i,a 
2460 DATA g,g,d,c,c,c,c,d,j,j,j,c 
2470 DATA h,g,a,c,d,e,a,e,g,g,g,b  
2480 DATA h,g,a,d,k,g,j,i,i,h,g,g
2490 DATA g,g,a,c,c,o,c,d,j,g,i,j
2500 DATA i,i,d,c,c,o,c,c,e,g,d,c 
2510 DATA d,c,c,c,c,o,d,k,h,g,a,c
2520 DATA c,c,c,c,d,o,c,k,i,h,a,c  
2530 DATA c,c,c,c,e,a,c,c,c,j,c,d
2540 DATA c,d,c,e,g,f,f,h,f,g,f,f 
2550 a=TESTR(0,0)
2560 IF a=2 THEN GOSUB 1240  
2570 IF a=14 THEN GOSUB 1240 
2580 IF a=5 THEN GOSUB 1240  
2590 IF a=9 THEN GOSUB 1260
2600 IF a=3 THEN GOSUB 1290
2610 IF a=1 THEN GOSUB 1270    
2620 IF a=4 THEN GOSUB 1320
2630 IF a=10 THEN GOSUB 1240
2640 IF a=11 THEN GOSUB 1240   
2650 IF a=8 THEN GOSUB 1240
2660 RETURN
2670 '********* DEFENSAS *******
2680 SOUND 1,4,10,13
2690 LET hj=INT(RND(1)*27)-INT(RND(1)*27)
2700 LET vj=INT(RND(1)*27)-INT(RND(1)*27)    
2710 LET dh=dh+hj:LET dv=dv+vj
2720 ORIGIN dh,dv:PLOT 0,0,14:PRINT CHR$(229);  
2730 ENT 1,100,10,1:SOUND 1,2000,2,15,1,1
2740 RETURN
2750 '******** FORMACION BICHO ****
2760 FOR kl=160 TO 1 STEP-16:PLOT 1000,0,2
2770 ORIGIN i-kl,ii-kl:PRINT CHR$(197);
2780 ORIGIN i+kl,ii-kl:PRINT CHR$(196); 
2790 ORIGIN i+kl,ii+kl:PRINT CHR$(198); 
2800 ORIGIN i-kl,ii+kl:PRINT CHR$(199);    
2810 ORIGIN i-kl,ii-kl:PRINT " ";:ORIGIN i+kl,ii-kl:PRINT " ";:ORIGIN i+kl,ii+kl:PRINT " ";:ORIGIN i-kl,ii+kl:PRINT " ";
2820 ENT 1,100,10,1:SOUND 1,kl/3,15,14,1,1:NEXT:RETURN      
2830 '********* RAYITTA *****
2840 hgt=hgt+1:IF hgt=6 THEN LET tg=-(RND(1)*600):LET stg=(RND(1)*400):ORIGIN 640,0:DRAW tg,stg,11:ENT 1,100,10,1:SOUND 1,1200,20,13,1,1:hgt=0  
2850 RETURN
2860 '********** ladrillitos *******
2870 lad=INT(RND(1)*600):ladv=INT(RND(1)*400):TAG:PLOT 0,1000,8:ORIGIN lad,ladv:PRINT CHR$(222);CHR$(223);:SOUND 3,2400,10,11,1,1:MOVE 0,-16:PRINT CHR$(223);CHR$(222);:RETURN  
2880 '****** FINAL JUEGO ******
2890 ON BREAK GOSUB 2880  
2900 INK 1,26:INK 2,24:INK 3,25
2910 FOR k=0.5 TO 13
2920 FOR d=1 TO 40 STEP 0.1*k:OUT &BD00,d:NEXT     
2930 FOR d=40 TO 1 STEP-0.1*k:OUT &BD00,d:NEXT  
2940 NEXT
2950 kikj=1:ggg=100:BORDER 0
2960 TAG:PLOT 0,1000,0:ORIGIN 10,ggg:PRINT " REALIZADO EL ";score;"%"; 
2970 ggg=ggg+(10*kikj)
2980 TAG:PLOT 0,1000,1:ORIGIN 10,ggg:PRINT " REALIZADO EL ";FINALLISTA*20;"%";
2990 IF ggg>300 THEN kikj=-1
3000 IF ggg<100 THEN kikj=1
3010 IF INKEY(18)=0 THEN CLEAR:GOTO 140
3020 SOUND 1,ggg*2,1,13
3030 GOTO 2960
3040 '*******  ELECCION ****
3050 MODE 1:CLS:CLG
3060 TAGOFF:LOCATE 1,12:PEN 2:PRINT"      OPCION JOYSTICK/TECLADO  "
3070 PEN 3:LOCATE 1,23:PRINT " PULSA T,J PARA OPCION,<ENTER> JUGAR  " 
3080 PEN 1:LOCATE 1,25:PRINT "        FCO.JOSE BLAZQUEZ ";CHR$(164);" 1986 "
3090 IF INKEY(51)=0 THEN jk1=69:jk2=71:jk3=15:jk4=7:INK 3,14:PEN 3:LOCATE 15,18:PRINT " TECLADO "   
3100 IF INKEY(45)=0 THEN jk1=72:jk2=73:jk3=74:jk4=75:INK 3,14:PEN 3:LOCATE 15,18:PRINT "JOYSTICK"   
3110 ON BREAK GOSUB 2880
3120 kdd=kdd+1:IF kdd=98 THEN kdd=1 
3130 ENT 1,100,10,1:SOUND 1,n(kdd)*0.4,d(kdd)/1.2,15,1,1:SOUND 4,n(kdd)*0.4,d(kdd)/1.2,15,1,10:SOUND 1,1,1,1:SOUND 4,1,1,1:ENT 4,100,10,1   
3140 IF INKEY(18)=0 AND NOT jk1=0 THEN GOTO 220
3150 GOTO 3090
3160 DATA 319, 45, 319, 67, 239, 22, 239, 45,253, 45, 253, 85, 358, 45, 358, 67,284, 22, 284, 45, 319, 45, 319, 85,379, 45, 284, 45, 319, 45, 319, 45
3170 DATA 338, 45, 358, 85, 358, 45, 379, 45,426, 45, 284, 45, 319, 85, 319, 45,319, 67, 239, 22, 239, 45, 253, 45,253, 85, 358, 45, 358, 67, 284, 22
3180 DATA 284, 45, 319, 45, 319, 85, 379, 45,284, 45, 319, 45, 319, 45, 338, 45,358, 85, 358, 45, 379, 45, 426, 45,284, 45, 319, 85, 190, 45, 213, 45,239, 45
3190 DATA 253, 45, 284, 45, 213, 85, 213, 45,239, 45, 284, 45, 338, 45, 319, 45,239, 85, 190, 45, 239, 45, 239, 45,319, 45, 319, 45, 379, 45, 358, 45
3200 DATA 213, 45, 213, 85, 213, 45, 284, 67,253, 22, 213, 45, 239, 85, 190, 45,213, 45, 239, 45, 253, 45, 284, 45,213, 85, 213, 45, 239, 45, 284, 45
3210 DATA 338, 45, 319, 45, 239, 85, 190, 45,239, 45, 239, 45, 319, 45, 319, 45,379, 45, 358, 45, 213, 45, 213, 85,213, 45, 284, 67, 253, 22, 213, 45,239, 85
3220 '************ MURITO LINDO *****
3230 czz=czz+1:IF NOT czz=3 THEN RETURN
3240 TAG
3250 ORIGIN 262,fff:PLOT 0,0,0:PRINT CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);  
3260 fff=fff+3*kks
3270 IF fff<10 THEN kks=10
3280 IF fff>390 THEN kks=-10   
3290 ORIGIN 210,fff:PLOT 0,0,2:PRINT CHR$(222);CHR$(222);CHR$(222);CHR$(222);CHR$(222);:MOVE 0,16:PRINT CHR$(223);CHR$(223);CHR$(223);CHR$(223);CHR$(223);
3300 SOUND 3,(fff/2)*10,2,14,1,1 
3310 PLOT 1000,0,1:czz=0:RETURN 
3320 '************ MAS ADORNOS ******
3330 IF planta>6 THEN de$=CHR$(179)+CHR$(179):de1$=CHR$(179)+CHR$(179)
3340 IF planta<7 THEN de$=CHR$(168)+CHR$(168):de1$=CHR$(169)+CHR$(169)
3350 FOR kl=64 TO 516 STEP 64:ORIGIN kl,222:PLOT 0,0,11:PRINT de$;:MOVE 0,16:PRINT de1$;:NEXT:RETURN  
3360 '************ MAS ADORNOS2 ******
3370 FOR kl=64 TO 516 STEP 64:ORIGIN kl,180:PLOT 0,0,10:PRINT CHR$(182);CHR$(182);:MOVE 0,16:PRINT CHR$(183);CHR$(183);:NEXT:RETURN