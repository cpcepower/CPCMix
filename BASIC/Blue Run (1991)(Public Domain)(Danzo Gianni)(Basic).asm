10 ' **************************
20 ' BLUE-RUN 
30 '         02-91
40 ' Realise par DANZO GIANNI
50 '             7860 LESSINES 
60 '             BELGIQUE 
70 ' MERCI L.M.C pour les cours et la                    routine d'affichage.
80 '**************************
90 MEMORY &8FFF
100 LOAD "SPRI1.bin",&9000 
110 LOAD "routine.bin",&A000
120 DEFINT a-z:CALL &BBFF
130 DIM sp(12),a1$(11),game(21,13) 
140 MODE 0:BORDER 0:INK 0,0:INK 1,26:INK 2,13:INK 3,24:INK 4,6:INK 5,16:INK 6,18:INK 7,9:INK 8,2:INK 9,11:INK 10,14:INK 11,8:INK 12,4:INK 13,3:INK 14,1,24:INK 15,16,11
150 DEF FN po(x,y)=&C000+(y-1)*80+(x-1)*4
160 FOR h=0 TO 11:sp(h+1)=&9000+(h*64):NEXT     
170 GOSUB 2400  
180 WINDOW 1,20,1,25
190 vie=9:ox=180:fin=0:sc=0  
200 GOTO 280
210 LOCATE 1,1:PEN 4:PRINT"VIE:9 OXY:180 SC:" 
220 SOUND 1,400,150,4,1:SOUND 2,405,150,4,1  
230 FOR h=1 TO 20:CALL &A00D,FN po(h,24),sp(2):CALL &A00D,FN po(h,2),sp(2):NEXT  
240 FOR h=4 TO 22 STEP 2:CALL &A00D,FN po(1,h),sp(2):CALL &A00D,FN po(20,h),sp(2):NEXT 
250 FOR g=2 TO 21:game(g,2)=10:game(g,13)=10:NEXT  
260 FOR g=1 TO 13:game(2,g)=10:game(21,g)=10:NEXT 
270 RETURN
280 ON ta GOTO 290,300,310,320,330,340,350
290 GOSUB 220:RESTORE 1280:GOTO 390
300 GOSUB 220:RESTORE 1330:GOTO 390
310 GOSUB 220:RESTORE 1380:GOTO 390
320 GOSUB 220:RESTORE 1430:GOTO 390
330 GOSUB 220:RESTORE 1480:GOTO 390 
340 GOSUB 220:RESTORE 1530:GOTO 390 
350 GOSUB 220:RESTORE 1580:GOTO 390
360 LOCATE 1,1:PEN 4:PRINT"VIE:":LOCATE 5,1:PRINT USING "#";vie
370 LOCATE 7,1:PRINT"OXY:150 SC:"
380 LOCATE 18,1:PRINT USING "###";SC:GOTO 650
390 'boucle placement
400 FOR h=1 TO 10:READ a1   
410 a1$(h)=BIN$(a1,10):NEXT 
420 FOR h=1 TO 10:IF a1$(h)="000000000" THEN 470 
430 FOR g=1 TO 10
440 b1$=MID$(a1$(h),g,1):b1=VAL(b1$)
450 IF b1=1 THEN CALL &A00D,FN po(g,(h*2)+2),sp(2):game(g+1,h+2)=1 
460 NEXT g
470 SOUND 1,300,5,15:NEXT h 
480 FOR h=1 TO 10:READ a1
490 a1$(h)=BIN$(a1,9):NEXT
500 FOR h=1 TO 10:IF a1$(h)="000000000" THEN 550   
510 FOR g=1 TO 9
520 b1$=MID$(a1$(h),g,1):b1=VAL(b1$) 
530 IF b1=1 THEN CALL &A00D,FN po(g+10,(h*2)+2),sp(2):game(g+11,h+2)=1 
540 NEXT g
550 SOUND 1,300,5,15:NEXT h 
560 FOR t=1 TO 4:READ ja,jb:CALL &A00D,FN po(ja,jb),sp(4):game(ja+1,(jb+2)/2)=4:NEXT 
570 FOR t=1 TO 2:READ ca,cb:CALL &A00D,FN po(ca,cb),sp(6):game(ca+1,(cb+2)/2)=6:NEXT 
580 READ HA,Hb:CALL &A0F5,FN po(ha,hb),sp(3):w=1
590 READ nm:IF nm=1 THEN 620
600 READ mx,my:CALL &A0F5,FN po(mx,my),sp(7)
610 m1=1:game(mx+1,(my+2)/2)=14
620 READ nx,ny:CALL &A0F5,FN po(nx,ny),sp(1)
630 n1=1:game(nx+1,(ny+2)/2)=14
640 GOTO 360
650 EVERY 100,1 GOSUB 2090
660 IF n1=1 THEN GOSUB 1630 
670 IF m1=1 THEN GOSUB 1860
680 IF fin=1 THEN 2120  
690 IF INKEY(ga)=0 THEN 740
700 IF INKEY(da)=0 THEN 870
710 IF INKEY(ht)=0 THEN 1020 
720 IF INKEY(bs)=0 THEN 1150 
730 GOTO 660
740 IF w<>1 THEN CALL &A00D,FN po (ha,hb),sp(5):CALL &A0F5,FN po (ha,hb),sp(3)
750 w=1
760 ha1=ha:hb1=hb 
770 ha=ha-1:IF game(ha+1,(hb+2)/2)=10 OR game(ha+1,(hb+2)/2)=1 THEN ha=ha+1:GOTO 660 
780 IF game(ha+1,(hb+2)/2)=4 THEN GOTO 2630  
790 IF game(ha+1,(hb+2)/2)=6 THEN GOTO 2680
800 CALL &A0F5,FN po(ha1,hb1),sp(3)
810 game(ha1+1,(hb1+2)/2)=0
820 CALL &A0F5,FN po(ha,hb),sp(3) 
830 SOUND 1,4000,1,5
840 game(ha+1,(hb+2)/2)=3  
850 IF cl=2 GOTO 2230
860 GOTO 660
870 IF w<>2 THEN CALL &A00D,FN po (ha,hb),sp(5):CALL &A0F5,FN po (ha,hb),sp(10)
880 w=2
890 ha1=ha:hb1=hb 
900 ha=ha+1:IF game(ha+1,(hb+2)/2)=10 OR game(ha+1,(hb+2)/2)=1 THEN ha=ha-1:GOTO 660 
910 IF game(ha+1,(hb+2)/2)=14 THEN 2120
920 IF game(ha+1,(hb+2)/2)=4 THEN GOTO 2630 
930 IF game(ha+1,(hb+2)/2)=6 THEN GOTO 2680  
940 CALL &A0F5,FN po(ha1,hb1),sp(10)
950 game(ha1+1,(hb1+2)/2)=0
960 CALL &A0F5,FN po(ha,hb),sp(10)
970 SOUND 1,4000,1,5
980 game(ha+1,(hb+2)/2)=3        
990 IF cl=2 THEN 2230
1000 w=2
1010 GOTO 660
1020 IF w<>3 THEN CALL &A00D,FN po (ha,hb),sp(5):CALL &A0F5,FN po (ha,hb),sp(11)
1030 w=3
1040 ha1=ha:hb1=hb 
1050 hb=hb-2:IF game(ha+1,(hb+2)/2)=10 OR game(ha+1,(hb+2)/2)=1 THEN hb=hb+2:w=3:GOTO 660  
1060 IF game(ha+1,(hb+2)/2)=4 THEN GOTO 2630  
1070 IF game(ha+1,(hb+2)/2)=6 THEN GOTO 2680  
1080 CALL &A0F5,FN po(ha1,hb1),sp(11)
1090 game(ha1+1,(hb1+2)/2)=0
1100 CALL &A0F5,FN po(ha,hb),sp(11)
1110 SOUND 1,4000,1,5 
1120 game(ha+1,(hb+2)/2)=3
1130 IF cl=2 THEN 2230
1140 GOTO 660 
1150 IF w<>4 THEN CALL &A00D,FN po (ha,hb),sp(5):CALL &A0F5,FN po (ha,hb),sp(9)
1160 w=4  
1170 ha1=ha:hb1=hb 
1180 hb=hb+2:IF game(ha+1,(hb+2)/2)=10 OR game(ha+1,(hb+2)/2)=1 THEN hb=hb-2:w=4:GOTO 660    
1190 IF game(ha+1,(hb+2)/2)=4 THEN GOTO 2630   
1200 IF game(ha+1,(hb+2)/2)=6 THEN GOTO 2680   
1210 CALL &A0F5,FN po(ha1,hb1),sp(9)
1220 game(ha1+1,(hb1+2)/2)=0
1230 CALL &A0F5,FN po(ha,hb),sp(9)
1240 SOUND 1,4000,1,5
1250 game(ha+1,(hb+2)/2)=3
1260 IF cl=2 THEN 2230
1270 GOTO 660
1280 DATA 65,155,160,46,14,46,160,155,65,0
1290 DATA 260,434,10,232,224,232,10,434,260,0
1300 DATA 2,4,19,4,2,22,19,22  
1310 DATA 9,4,12,4,19,12
1320 DATA 1,2,8
1330 DATA 0,229,237,5,79,79,5,237,229,0
1340 DATA 0,334,366,320,484,484,320,366,334,0
1350 DATA 9,10,12,10,9,16,12,16
1360 DATA 2,4,19,22,15,10
1370 DATA 2,19,12,6,12
1380 DATA 273,86,324,341,81,148,132,49,325,273
1390 DATA 273,212,69,85,276,338,66,280,325,273
1400 DATA 9,4,12,4,4,14,17,14
1410 DATA 2,4,19,4,11,6
1420 DATA 2,7,18,14,18
1430 DATA 33,148,69,32,149,149,32,69,148,33
1440 DATA 264,82,324,8,338,338,8,324,82,264
1450 DATA 6,10,6,16,15,10,15,16
1460 DATA 5,14,16,14,10,20
1470 DATA 2,7,4,14,4
1480 DATA 81,16,342,20,21,16,30,320,9,64
1490 DATA 4,0,293,0,240,16,336,85,208,20
1500 DATA 9,10,12,18,2,14,19,14
1510 DATA 2,4,19,22,10,6
1520 DATA 2,6,18,15,10
1530 DATA 257,129,121,1,474,472,1,121,129,257
1540 DATA 257,258,316,256,55,183,256,316,258,257
1550 DATA 3,4,2,6,19,20,18,22
1560 DATA 2,20,19,6,12,4
1570 DATA 2,8,12,16,14
1580 DATA 132,21,49,19,271,399,275,49,21,132
1590 DATA 66,336,280,401,483,481,400,280,336,66
1600 DATA 5,6,16,6,5,20,16,20  
1610 DATA 2,4,19,22,14,10
1620 DATA 2,11,4,10,22
1630 nx1=nx:ny1=ny
1640 ON sm GOTO 1650,1730,1780,1820 
1650 nx=nx+1:IF game(nx+1,(ny+2)/2)=3 THEN fin=1:RETURN 
1660 IF game(nx+1,(ny+2)/2)=0 THEN 1690
1670 nx=nx-1
1680 sm=INT(RND*4)+1:IF sm=1 OR sm=3 THEN 1680 ELSE RETURN
1690 CALL &A0F5,FN po(nx1,ny1),sp(1)
1700 game(nx1+1,(ny1+2)/2)=0 
1710 CALL &A0F5,FN po(nx,ny),sp(1) 
1720 game(nx+1,(ny+2)/2)=14:RETURN
1730 ny=ny+2:IF ny=23 THEN 1760
1740 IF game(nx+1,(ny+2)/2)=3 THEN fin=1:RETURN
1750 IF game(nx+1,(ny+2)/2)=0 THEN 1690
1760 ny=ny-2
1770 sm=INT(RND*4)+1:IF sm=2 OR sm=4 THEN 1770 ELSE RETURN 
1780 nx=nx-1:IF game(nx+1,(ny+2)/2)=3 THEN fin=1:RETURN 
1790 IF game(nx+1,(ny+2)/2)=0 THEN 1690 
1800 nx=nx+1
1810 sm=INT(RND*4)+1:IF sm=3 OR sm=1 THEN 1810 ELSE RETURN 
1820 ny=ny-2:IF game(nx+1,(ny+2)/2)=3 THEN fin=1:RETURN
1830 IF game(nx+1,(ny+2)/2)=0 THEN 1690 
1840 ny=ny+2
1850 sm=INT(RND*4)+1:IF sm=4 OR sm=2 THEN 1850 ELSE RETURN 
1860 mx1=mx:my1=my
1870 ON sn GOTO 1880,1960,2010,2050 
1880 mx=mx+1:IF game(mx+1,(my+2)/2)=3 THEN fin=1:RETURN 
1890 IF game(mx+1,(my+2)/2)=0 THEN 1920
1900 mx=mx-1 
1910 sn=INT(RND*4)+1:IF sn=1 OR sn=3 THEN 1910 ELSE RETURN 
1920 CALL &A0F5,FN po(mx1,my1),sp(7)
1930 game(mx1+1,(my1+2)/2)=0 
1940 CALL &A0F5,FN po(mx,my),sp(7)
1950 game(mx+1,(my+2)/2)=14:RETURN 
1960 my=my+2:IF my=23 THEN 1990 
1970 IF game(mx+1,(my+2)/2)=3 THEN fin=1:RETURN
1980 IF game(mx+1,(my+2)/2)=0 THEN 1920
1990 my=my-2
2000 sn=INT(RND*4)+1:IF sn=2 OR sn=4 THEN 2000 ELSE RETURN 
2010 mx=mx-1:IF game(mx+1,(my+2)/2)=3 THEN fin=1:RETURN  
2020 IF game(mx+1,(my+2)/2)=0 THEN 1920
2030 mx=mx+1 
2040 sn=INT(RND*4)+1:IF sn=3 OR sn=1 THEN 2040 ELSE RETURN 
2050 my=my-2:IF game(mx+1,(my+2)/2)=3 THEN fin=1:RETURN   
2060 IF game(mx+1,(my+2)/2)=0 THEN 1920
2070 my=my+2 
2080 sn=INT(RND*4)+1:IF sn=4 OR sn=2 THEN 2080 ELSE RETURN
2090 DI:ox=ox-5:LOCATE 11,1:PRINT USING "###";ox:SOUND 1,100,1   
2100 IF ox<5 THEN fin =1
2110 EI:RETURN
2120 mu=REMAIN(1):fin=0:BORDER 26:vie=vie-1
2130 LOCATE 5,1:PRINT USING"#";vie
2140 OUT 255,1:FOR i=1 TO 10:BORDER 6:OUT 256,255*RND:FOR j=1 TO 40:NEXT:BORDER 26:OUT 256,40:NEXT
2150 ENV 2,15,-1,6:SOUND 7,0,0,0,2,0,30 
2160 FOR t=1 TO 1500:NEXT
2170 ENT 2,230,1,1:ENV 2,5,1,10,3,0,10,100,-1,1:SOUND 1,50,200,10,2,2 
2180 IF SQ(1)>127 THEN 2180
2190 FOR t=1 TO 3000:NEXT 
2200 ERASE game:ERASE a1$:DIM game(21,13),a1$(11)
2210 ox=180:IF vie=0 THEN CLS:m1=0:n1=0:ta=1::BORDER 0:GOTO 170 
2220 CLS:CL=0:BORDER 0:GOTO 280 
2230 mu=REMAIN(1):fin=0:cl=0:TA=TA+1
2240 FOR t=1 TO 200:NEXT
2250 SOUND 1,95,15,15:SOUND 1,80,15,15:SOUND 1,95,15,15:SOUND 1,119,15,15:SOUND 1,159,15,15
2260 SOUND 49,253,30,15:SOUND 42,201,30,15:SOUND 28,142,30,15:SOUND 49,239,30,15:SOUND 42,190,30,15:SOUND 28,119,30,15:SOUND 1,1,30,15:SOUND 17,478,15,15:SOUND 10,239,15,15  
2270 FOR t=1 TO 3000:NEXT 
2280 ERASE game:ERASE a1$:DIM game(21,13),a1$(11)
2290 ox=150:CLS:IF ta>7 THEN 2310 
2300 GOTO 280
2310 LOCATE 2,4:PRINT "Votre recompense !"
2320 IF sc<140 THEN PEN 3:LOCATE 8,10:PRINT "RIEN":PEN 5:LOCATE 1,12:PRINT"14 COEURS MINIMUM !":GOTO 2350 
2330 CALL &A00D,FN po(10,10),sp(12)
2340 FOR t=1 TO 1000:NEXT:ENT 1,20,-6,1,1,120,1,20,-3,1,40,3,1:SOUND 1,119,81,15,,1     
2350 LOCATE 5,20:PRINT "UNE AUTRE ? O/N"
2360 a$=INKEY$:IF A$="O" OR A$="o"THEN CLS:ta=1:m1=0:n1=0:GOTO 170   
2370 IF A$="N" OR A$="n"THEN CALL 0
2380 GOTO 2360
2390 END
2400 PEN 1:LOCATE 7,10:PRINT "BLUE RUN"
2410 FOR h=6 TO 15:CALL &A00D,FN po(h,12),sp(2):NEXT   
2420 LOCATE 6,18:PEN 3:PRINT"CLAVIER[C]"
2430 LOCATE 8,20:PEN 4:PRINT"JOY [J]" 
2440 LOCATE 6,22:PEN 5:PRINT"REGLES [R]"
2450 GOTO 2740
2460 a$=INKEY$:IF a$="" THEN 2460
2470 IF a$="c" OR a$="C" THEN ga=8:da=1:ht=0:bs=2:fe=9:TA=1:GOSUB 2590:RETURN    
2480 IF a$="j" OR a$="J" THEN ga=74:da=75:ht=72:bs=73:fe=76:TA=1:GOSUB 2590:RETURN  
2490 IF a$="r" THEN GOSUB 2510 
2500 GOTO 2460
2510 CLS:PEN 6:LOCATE 6,2:PRINT"BLUE RUN" 
2520 LOCATE 5,4:PRINT"**********"
2530 PRINT:PRINT "Reflechissez vite!"
2540 PRINT:PRINT"Cueillez les coeurs.":PRINT:PRINT"Evitez les MONSTRES." 
2550 PRINT:PRINT"2 CLEFS pour sortir."
2560 PRINT:PRINT"OXYGENE limite."
2570 PRINT:PRINT:PRINT"BREF, DU CLASSIQUE !"
2580 a$=INKEY$:IF a$="" THEN 2580 ELSE CLS:GOTO 170
2590 WINDOW 4,16,6,23  
2600 SOUND 1,500,130,5,1:SOUND 2,505,130,5,1     
2610 FOR x=1 TO 16:PRINT:PRINT:PRINT:NEXT 
2620 RETURN 
2630 SOUND 1,80,2,7:FOR t=1 TO 100:NEXT:SOUND 1,160,2,7:CALL &A00D,FN po(ha,hb),sp (5):game(ha+1,(hb+2)/2)=0:sc=sc+10:LOCATE 18,1:PRINT USING "###";sc 
2640 IF w=1 THEN GOTO 800
2650 IF w=2 THEN GOTO 940
2660 IF w=3 THEN GOTO 1080
2670 IF w=4 THEN GOTO 1210 
2680 SOUND 1,180,2,7:FOR t=1 TO 100:NEXT:SOUND 1,90,2,7:CALL &A00D,FN po(ha,hb),sp (5):game(ha+1,(hb+2)/2)=0 
2690 cl=cl+1
2700 IF w=1 THEN GOTO 800 
2710 IF w=2 THEN GOTO 940  
2720 IF w=3 THEN GOTO 1080 
2730 IF w=4 THEN GOTO 1210 
2740 '
2750 e=1:h=5:j=1:g=18   
2760 ENV 1,4,-1,1:SOUND 1,95,24,15,1:SOUND 1,119,24,15,1:FOR a=1 TO 3:g=g-3:RESTORE 2770:FOR b=1 TO 3:READ n,m:SOUND 1,n,m,g,1:NEXT b:NEXT a
2770 DATA 95,12,89,12,106,24
2780 FOR a=1 TO 1000:NEXT
2790 ENV 2,4,0,1,7,-1,1:ENV 3,24,-1.25,0.5:FOR a=1 TO h:RESTORE 2880:FOR b=0 TO 15:READ c,d  
2800 IF d=1 THEN g=12 ELSE g=15 
2810 IF d=1 THEN ENV 3,3,0,1,1,-12,1
2820 SOUND 1,c,12,15,2:SOUND 2+16,0,12,g,3,,d
2830 IF d=31 OR d=8 THEN g=15
2840 IF j=2 THEN 2860 ELSE GOTO 2850
2850 NEXT b:NEXT a
2860 IF e=1 THEN GOTO 2880
2870 RETURN
2880 DATA 638,1,638,1,319,1,319,1,638,31,638,1,319,1,319,1,638,1,638,1,426,1,426,1,358,31,379,1,426,1,506,1
2890 FOR k=1 TO 450:NEXT k 
2900 RESTORE 2970:FOR u=1 TO 32:READ v,w,x
2910 IF w=1 THEN y=12 ELSE y=15
2920 IF w=1 THEN ENV 3,3,0,1,1,-12,1
2930 ENV 5,4,0,1,8,-1,1
2940 SOUND 1,v,12,15,2:SOUND 2+16,0,12,y,3,,w:SOUND 4+32,x,12,14,5
2950 IF w=31 THEN y=15
2960 NEXT u
2970 DATA 638,1,0,638,1,0,319,1,119,319,1,0,638,31,106,638,1,0,319,1,119,319,1,0,638,1,127,638,1,0,426,1,159,426,1,0,358,31,127,379,1,0,426,1,159,506,1,0
2980 DATA 638,1,95,638,1,106,319,1,89,319,1,106,638,31,0,638,1,0,319,1,0,319,1,0,638,1,0,638,1,0,426,1,0,426,1,0,358,31,0,379,1,0,426,1,0,506,1,0
2990 e=2:h=3:GOSUB 2790:e=1
3000 j=2
3010 FOR t=1 TO 3000:NEXT:GOTO 2460
3020 A$=INKEY$:WHILE A$<>"":GOTO 2460:WEND     
3030 GOTO 2740