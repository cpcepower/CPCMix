1 ' &17D
10 MODE 1:SYMBOL AFTER 97:INK 0,0:INK 1,0:INK 2,20:INK 3,6:BORDER 0:LOCATE 1,24:PRINT STRING$(40," "):PEN 2:LOCATE 11,24:PRINT"CHARGEMENT EN COURS":MEMORY &6FFF:OUT &7F00,&C4:LOAD"3DSNASCR.IPL",&7000:CALL &7000:OUT &7F00,&C0
15 MEMORY &9CFF:FOR h=&9D00 TO &9E7E:READ a$:POKE h,VAL("&"+a$):NEXT
20 DATA 0,0,0,10,80,0,0,0,0,0,0,71,E8,0,0,0,0,0,10,F7,FE,80,0,0,0,0,71,FF,FF,E8,0,0,0,10,F7,FF,FF,FE,80,0,0,71,FF,FF,FF,FF,E8,0,10,F7,FF,FF,FF
30 DATA FF,FE,80,71,FF,FF,FF,FF,FF,FF,E8,F7,FF,FF,FF,FF,FF,FF,FE,71,FF,FF,FF,FF,FF,FF,E8,10,F7,FF,FF,FF,FF,FE,80,0,71,FF,FF,FF,FF,E8,0,0,10,F7,FF,FF,FE,80,0,0,0
40 DATA 71,FF,FF,E8,0,0,0,0,10,F7,FE,80,0,0,0,0,0,71,E8,0,0,0,0,0,0,0,0,0,0,0,0,80,0,0,0,0,0,0,0,86,0,0,0,0,0,0,0,87,8,0,0,0,0
50 DATA 0,0,87,E,0,0,0,0,0,0,87,F,8,0,0,0,0,0,87,F,E,0,0,0,0,0,87,F,F,8,0,0,0,0,61,F,F,1E,0,0,0,0,10,87,F,1E,0,0,0,0,0,61,F
60 DATA 1E,0,0,0,0,0,10,87,1E,0,0,0,0,0,0,61,1E,0,0,0,0,0,0,10,96,0,0,0,0,0,0,0,70,0,0,0,0,0,0,0,10,0,0,0,0
70 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,56,0,0,0,0,0,0,1,BE,0,0,0,0,0,0,57,5E,0,0,0,0,0,1,AF,BE,0,0,0,0
80 DATA 0,57,5F,5E,0,0,0,0,01,AF,AF,BE,0,0,0,0,57,5F,5F,68,0,0,0,0,AF,AF,BE,80,0,0,0,0,5F,5F,68,0,0,0,0,0,AF,BE,80,0,0,0,0,0,5F,68,0,0,0,0,0,0,BE,80,0,0,0,0,0,0,68,0,0,0,0,0,0,0,80:FOR h=&9E7F TO &9FFF
90 POKE h,0:NEXT:REM Gestion de la balle
100 REM technique des masques
110 FOR H=&A000 TO &A1DD:READ A$:POKE H,VAL("&"+A$):NEXT:DATA C3,F0,A0,C3,2D,A1,C3,D8,A1,0,0,0,0,0,0,0,0,F,F0,3F,FC,F7,FF,F7,FF,F5,FF,3D,FC,0F,F0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3A   
120 DATA D,A0,A1,57,79,2F,5F,DD,21,11,A0,6,7,C5,D5,E5,6,8,3E,4,B8,20,2,DD,23,7E,A3,4F,7A,DD,CB,0,6,30,6,DD,CB,0,6,18,8,3E,0,DD,CB,0,6,30,2,B1,77,CB,A
130 DATA CB,B,38,9,CB,A,CB,A,CB,A,CB,A,23,10,CE,DD,23,E1,7C,C6,8,67,30,B,7C,D6,40,67,7D,C6,50,6F,30,1,24,D1,C1,10,B1,C9,0,0,0,0,0,0,22,F,A0,11,1F,A0,6
140 DATA 7,E5,E,3,7E,12,23,13,D,20,F9,E1,7C,C6,8,67,30,B,7C,D6,40,67,7D,C6,50,6F,30,1,24,10,E2,C9,0,0,0,0,0,0,0,11,1F,A0,6,7,E5,E,3,1A,77,23,13,D,20
150 DATA F9,E1,7C,C6,8,67,30,B,7C,D6,40,67,7D,C6,50,6F,30,1,24,10,E2,C9,0,0,0,0,0,0,6,0,DD,7E,0,CB,47,28,2,6,F0,CB,4F,28,4,78,F6
160 DATA F,47,78,32,D,A0,DD,6E,2,DD,66,3,DD,5E,4,DD,56,5,ED,53,B,A0,22,9,A0,CD,1D,BC,E5,C5,CD,98,A0,C1,E1,CD,34,A0,C9,0,0,0,0,0,3E,1,0,ED,4B,9,A0,ED,5B
170 DATA B,A0,F5,CB,67,20,9,3E,9,CD,C7,A1,3E,0,28,2,3E,FF,32,E,A0,3E,1,CD,C7,A1,20,6,F1,CB,5F,F5,28,9,21,37,1,CD,CF,A1,28,1,13,3E,2,CD,C7,A1,20,6,F1,CB,4F
180 DATA F5,28,6,79,FE,7,28,1,B,3E,8,CD,C7,A1,20,6,F1,CB,57,F5,28,5,7B,B2,28,1,1B,3E,0,CD,C7,A1,20,7,F1,CB,47,28,9,18,1,F1,79,FE,C7,28,1,3,60,69,22,9,A0
190 DATA ED,53,B,A0,CD,1D,BC,C5,E5,2A,F,A0,CD,19,BD,CD,C6,A0,E1,E5,CD,98,A0,E1,C1,CD,34,A0,C9,0,0,0,0,0,0,0,0,0,0,C5,CD,1E,BB,C1,C9,0,0,7C,92,C0,7D,93,C9,0,0,0,2A,F,A0,C3,C6,A0:REM RSX SPRIT
200 FOR h=&A300 TO &A36D:READ a$:POKE h,VAL("&"+a$):NEXT:POKE &A33B,&C9:CALL &A300:DATA 1,9,A3,21,14,A3,C3,D1,BC,E,A3,C3,18,A3,53,50,52,49,D4,0,14,A3,9,A3,3E,1,CD,9F,BB,DD,5E,0,DD,56,1,DD,6E,2,DD  
210 DATA 66,3,CD,50,A3,D5,DD,6E,2,DD,66,3,11,50,0,19,D1,CD,50,A3,D5,DD,6E,2,DD,66,3,11,A0,0,19,D1,CD,50,A3,C9,0,0,0,0,0,6,8,C5,6,7,1A,B6,77,13,23,10,F9,1A,B6,77,13,D5,11,F9,7,19,D1,C1,10,E9,0,0,0,0,C9:RESTORE 360
220 EVERY 20,2 GOSUB 340:TAGOFF
230 PEN 1:t$="":WHILE INKEY$<>"":WEND:PEN 2:A$="[1]-REGLES [2]-JEU [1]-REGLES [2]-JEU  ":WHILE T$="":B$=LEFT$(A$,1):LOCATE 1,24:PRINT A$:T$=INKEY$:A$=RIGHT$(A$,LEN(A$)-1)+B$:WEND:IF T$="1"THEN 260
240 IF T$="2"THEN 320
250 T$="":GOTO 230
260 MODE 1:LOCATE 16,1:INK 1,24:PEN 1:PRINT"3D SNAKES":PEN 2:LOCATE 16,2:PRINT"---------":PEN 3:LOCATE 1,4:PRINT"    La chasse aux serpents vient d'etre ouverte sur la 3eme galaxie (2eme feu a gauche en sortant,juste avant l'asile defous).":LOCATE 1,9
270 PRINT"    Vous etes invite a y participer .   Votre terrain de chasse couvre 49 KOPS. Le Kops est une unite de mesure dans la 3eme galaxie.":LOCATE 1,14:PRINT"     Vous avez huit POUNZS de munitions.Ne les gaspillez pas.":LOCATE 1,17
280 PRINT"     Ce jeu se joue au JOYSTICK.Les de- placements se font au pixel pres.":LOCATE 32,22:PEN 1:PRINT"<ENTER>":WHILE INKEY$="":WEND:CLS:LOCATE 16,1:PEN 1:PRINT"3D SNAKES":PEN 2:LOCATE 16,2:PRINT"---------":PEN 2:LOCATE 1,4
290 PRINT"    Quelques conseils":LOCATE 5,5:PRINT STRING$(17,"="):PEN 3:LOCATE 1,7:PRINT"    Pour sauter il faut prendre de      l'elan et appuyez sur [FIRE].Attention ane pas avoir trop d'elan car sinon ...":LOCATE 1,11
300 PRINT"    Les cases avec un cercle servent de transfert.Parfois utile parfois nefaste car vous ne savez jamais ou vous allez  vous retrouver.":LOCATE 1,16:
310 PRINT"    49 tableaux a visiter.Vous avez du  pain sur la planche aussi commencez toutde suite.":PEN 1:LOCATE 27,22:PRINT"BONNE CHANCE":GOTO 230
320 '
330 RUN 390
340 DI:IF(SQ(1)AND 7)=0 THEN EI:RETURN ELSE READ p,d:IF p=-1 THEN RESTORE 360:GOTO 340
350 SOUND 1,p,d,4:GOTO 340
360 DATA 319,25,338,25,379,25,338,55,426,25,319,25,338,25,379,25,338,55,426,25,319,25,338,25,319,25,284,80,0,10,284,60,451,55,338,25,319,70,426,60,319,25,338,25,379,25,338,55,426,25,319,25,338,25,426,25,379,70,319,25,338,25,379,25,426,80,0,10    
370 DATA 213,60,190,60,213,30,169,80,213,55,190,55,213,30,169,30,190,25,213,25,169,25,190,25,213,25,169,25,190,25,213,25,0,6,213,60,0,10,213,60,190,60,213,30,169,70,159,25,169,25,159,25,142,80,0,6    
380 DATA 190,25,213,25,190,60,169,25,190,80,284,25,253,25,225,25,213,80,319,25,338,25,379,25,426,90,-1,-1   
390 SYMBOL 115,0,56,64,56,4,120,0,0:SYMBOL 99,0,60,64,64,64,60,0,0:SYMBOL 104,0,68,68,124,68,68,0,0:SYMBOL 105,0,56,16,16,16,56,0,0:SYMBOL 108,0,64,64,64,64,124,0,0:SYMBOL 101,0,124,64,124,64,124,0,0:SYMBOL 118,0,68,68,68,40,16,0,0
400 SYMBOL 116,0,124,16,16,16,16,0,0:SYMBOL 109,0,40,84,84,84,84,0,0:SYMBOL 111,0,124,68,68,68,124,0,0:SYMBOL 97,0,124,68,124,68,68,0,0:SYMBOL 252,0,0,0,7,10,21,42,53:SYMBOL 253,0,0,0,224,176,88,172,84:SYMBOL 254,42,48,16,8,7,0,0,0
410 SYMBOL 255,172,20,8,16,224,0,0,0:SYMBOL 250,0,7,15,7,0,0,0,0:SYMBOL 251,0,224,240,224,0,0,0:SYMBOL 249,0,0,0,0,60,56,60,35:SYMBOL 248,0,0,0,0,60,28,60,196:SYMBOL 247,196,60,28,60,0,0,0,0:SYMBOL 246,35,60,56,60,0,0,0,0:SYMBOL 245,0,0,0,0,15,15,15,15
420 SYMBOL 241,0,0,0,0,3,7,0,7:SYMBOL 242,0,0,0,0,128,192,96,96:SYMBOL 243,12,39,16,15,0,0,0,0:SYMBOL 244,192,160,96,192,0,0,0,0:SYMBOL 240,0,0,0,0,240,240,240,240:SYMBOL 239,0,60,110,94,94,126,60,0:SYMBOL 238,255,129,129,129,129,129,129,255
430 SYMBOL 237,15,15,15,15,15,15,15,15:SYMBOL 236,240,240,240,240,240,240,240,240:SYMBOL 235,0,0,0,0,7,31,120,96:SYMBOL 234,0,0,0,0,224,248,30,6:SYMBOL 233,96,120,31,7,0,0,0,0:SYMBOL 232,6,30,248,224,0,0,0,0:SYMBOL 230,6,3,59,102,61,67,62,0
440 SYMBOL 216,238,238,238,238,238,238,238,0:REM les sprites
450 REM variables de base
460 rec=0:sc=0:tr$=CHR$(22)+CHR$(1):nr$=CHR$(22)+CHR$(0):eff$=CHR$(245)+CHR$(240)+CHR$(8)+CHR$(8)+CHR$(10)+CHR$(213)+CHR$(212):trou$=CHR$(252)+CHR$(253)+CHR$(8)+CHR$(8)+CHR$(10)+CHR$(254)+CHR$(255):trou1$=CHR$(250)+CHR$(251)
470 nk$=CHR$(241)+CHR$(242)+CHR$(8)+CHR$(8)+CHR$(10)+CHR$(243)+CHR$(244):TRAN$=CHR$(235)+CHR$(234)+CHR$(8)+CHR$(8)+CHR$(10)+CHR$(233)+CHR$(232)
480 DEF FNpo(x,y)=&C000+(y-1)*80+(x-1)*2:DIM plan(23,4):RESTORE 490:FOR g=1 TO 4:FOR h=1 TO 23:READ p:plan(h,g)=p:NEXT h,g
490 DATA 1,1,1,4,1,0,0,0,1,1,1,4,1,1,1,4,1,1,1,4,1,0,1,1,0,0,0,1,0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,1,0,0,1,0,0,0,1,0,1,0,1,0,1,0,1,1,1,0,0,1,0,1,0,0,0,1,1,1,4,1,1,1,0,1,1,1,0,1,0,0,0,0,1,0:MODE 1:INK 0,1:INK 1,24:INK 2,20:INK 3,6
500 BORDER 1:PAPER 0:CLS:WINDOW#1,1,40,1,19:x=308:y=246:sens=1:ENT 3,30,3,5:ENT 2,15,-1,3:ENV 2,15,-1,3:CLEAR INPUT:serp=49:ba=8:cent=0:DIM a(40,25):DIM spt(49):temps=12:RANDOMIZE TIME:depart=INT(RND*6)+1:ON depart GOTO 510,520,530,540,550,560
510 ta=1:GOTO 570
520 ta=9:GOTO 570
530 ta=16:GOTO 570
540 ta=26:GOTO 570
550 ta=34:GOTO 570
560 ta=44
570 GOSUB 580:EVERY 3000,2 GOSUB 2250:GOTO 620:REM tab.des scores
580 PEN 2:LOCATE 4,23:PRINT"sc                      ";CHR$(230);"    ta":LOCATE 4,24:PRINT"hi                      time":PEN 1:LOCATE 30,23:PRINT tr$;"      0":GOSUB 1370:GOSUB 1410:LOCATE 29,23:PRINT tr$;serp:PEN 3:LOCATE 32,24:PRINT CHR$(216)+CHR$(216)
590 PEN 1:LOCATE 34,24:PRINT"ииии":PLOT 44,12,1:DRAW 44,52:DRAW 196,52:DRAW 196,12:DRAW 44,12:PLOT 428,12:DRAW 428,52:DRAW 596,52:DRAW 596,12:DRAW 428,12:FOR h=12 TO 52:PLOT 208,h:DRAW 416,h:NEXT h::PEN 3:LOCATE 15,23
600 PRINT"3D SNAKES II":FOR h=17 TO 23:LOCATE h,24:PRINT tr$;CHR$(239):NEXT:RETURN:REM changement de tab.
610 IF ta>21 THEN GOTO 630
620 ON ta GOTO 660,670,680,690,700,710,720,730,740,750,760,770,780,790,800,810,820,830,840,850,860
630 IF ta>42 THEN GOTO 650
640 ta1=ta-21:ON ta1 GOTO 870,880,890,900,910,920,930,940,950,960,970,980,990,1000,1010,1020,1030,1040,1050,1060,1070
650 ta2=ta-42:ON ta2 GOTO 1080,1090,1100,1110,1120,1130,1140
660 plan(1,4)=2:RESTORE 2350:GOSUB 1150:p0=2:p1=0:p2=0:p3=0:GOSUB 1280:GOTO 1450
670 plan(1,3)=2:RESTORE 2360:GOSUB 1150:p0=4:p1=3:p2=1:p3=0:GOSUB 1280:GOTO 1450
680 plan(2,3)=2:RESTORE 2370:GOSUB 1150:p0=0:p1=0:p2=0:p3=2:GOSUB 1280:GOTO 1450
690 plan(1,2)=2:RESTORE 2380:GOSUB 1150:p0=5:p1=0:p2=2:p3=0:GOSUB 1280:GOTO 1450
700 plan(1,1)=2:RESTORE 2390:GOSUB 1150:p0=0:p1=6:p2=4:p3=0:GOSUB 1280:GOTO 1450
710 plan(2,1)=2:RESTORE 2400:GOSUB 1150:p0=0:p1=7:p2=0:p3=5:GOSUB 1280:GOTO 1450
720 plan(3,1)=2:RESTORE 2410:GOSUB 1150:p0=0:p1=8:p2=0:p3=6:GOSUB 1280:GOTO 1450
730 plan(5,1)=2:RESTORE 2420:GOSUB 1150:p0=0:p1=0:p2=9:p3=7:GOSUB 1280:GOTO 1450
740 plan(5,2)=2:RESTORE 2430:GOSUB 1150:p0=8:p1=0:p2=10:p3=0:GOSUB 1280:GOTO 1450
750 plan(5,3)=2:RESTORE 2440:GOSUB 1150:p0=9:p1=0:p2=11:p3=0:GOSUB 1280:GOTO 1450
760 plan(5,4)=2:RESTORE 2450:GOSUB 1150:p0=10:p1=12:p2=0:p3=0:GOSUB 1280:GOTO 1450
770 plan(6,4)=2:RESTORE 2460:GOSUB 1150:p0=0:p1=13:p2=0:p3=11:GOSUB 1280:GOTO 1450
780 plan(7,4)=2:RESTORE 2470:GOSUB 1150:p0=0:p1=14:p2=0:p3=12:GOSUB 1280:GOTO 1450
790 plan(9,4)=2:RESTORE 2480:GOSUB 1150:p0=19:p1=15:p2=0:p3=13:GOSUB 1280:GOTO 1450
800 plan(10,4)=2:RESTORE 2490:GOSUB 1150:p0=0:p1=16:p2=0:p3=14:GOSUB 1280:GOTO 1450
810 plan(11,4)=2:RESTORE 2500:GOSUB 1150:p0=17:p1=0:p2=0:p3=15:GOSUB 1280:GOTO 1450
820 plan(11,3)=2:RESTORE 2510:GOSUB 1150:p0=18:p1=0:p2=16:p3=0:GOSUB 1280:GOTO 1450
830 plan(11,2)=2:RESTORE 2520:GOSUB 1150:p0=0:p1=0:p2=17:p3=0:GOSUB 1280:GOTO 1450
840 plan(9,3)=2:RESTORE 2530:GOSUB 1150:p0=20:p1=0:p2=14:p3=0:GOSUB 1280:GOTO 1450
850 plan(9,2)=2:RESTORE 2540:GOSUB 1150:p0=21:p1=0:p2=19:p3=0:GOSUB 1280:GOTO 1450
860 plan(9,1)=2:RESTORE 2550:GOSUB 1150:p0=0:p1=22:p2=20:p3=0:GOSUB 1280:GOTO 1450
870 plan(10,1)=2:RESTORE 2560:GOSUB 1150:p0=0:p1=23:p2=0:p3=21:GOSUB 1280:GOTO 1450
880 plan(11,1)=2:RESTORE 2570:GOSUB 1150:p0=0:p1=24:p2=0:p3=22:GOSUB 1280:GOTO 1450
890 plan(13,1)=2:RESTORE 2580:GOSUB 1150:p0=0:p1=33:p2=25:p3=23:GOSUB 1280:GOTO 1450
900 plan(13,2)=2:RESTORE 2590:GOSUB 1150:p0=24:p1=0:p2=26:p3=0:GOSUB 1280:GOTO 1450
910 plan(13,3)=2:RESTORE 2600:GOSUB 1150:p0=25:p1=0:p2=27:p3=0:GOSUB 1280:GOTO 1450
920 plan(13,4)=2:RESTORE 2610:GOSUB 1150:p0=26:p1=28:p2=0:p3=0:GOSUB 1280:GOTO 1450
930 plan(14,4)=2:RESTORE 2620:GOSUB 1150:p0=30:p1=0:p2=0:p3=28:GOSUB 1280:GOTO 1450
940 plan(15,4)=2:RESTORE 2630:GOSUB 1150:p0=30:p1=0:p2=0:p3=28:GOSUB 1280:GOTO 1450
950 plan(15,3)=2:RESTORE 2640:GOSUB 1150:p0=31:p1=0:p2=29:p3=0:GOSUB 1280:GOTO 1450
960 plan(15,2)=2:RESTORE 2650:GOSUB 1150:p0=32:p1=0:p2=30:p3=0:GOSUB 1280:GOTO 1450
970 plan(15,1)=2:RESTORE 2660:GOSUB 1150:p0=0:p1=32:p2=31:p3=33:GOSUB 1280:GOTO 1450
980 plan(14,1)=2:RESTORE 2670:GOSUB 1150:p0=0:p1=32:p2=0:p3=24:GOSUB 1280:GOTO 1450
990 plan(17,1)=2:RESTORE 2680:GOSUB 1150:p0=0:p1=42:p2=35:p3=32:GOSUB 1280:GOTO 1450
1000 plan(17,2)=2:RESTORE 2690:GOSUB 1150:p0=34:p1=0:p2=36:p3=0:GOSUB 1280:GOTO 1450
1010 plan(17,3)=2:RESTORE 2700:GOSUB 1150:p0=35:p1=38:p2=37:p3=0:GOSUB 1280:GOTO 1450
1020 plan(17,4)=2:RESTORE 2710:GOSUB 1150:p0=36:p1=0:p2=0:p3=0:GOSUB 1280:GOTO 1450
1030 plan(18,3)=2:RESTORE 2720:GOSUB 1150:p0=0:p1=39:p2=0:p3=36:GOSUB 1280:GOTO 1450
1040 plan(19,3)=2:RESTORE 2730:GOSUB 1150:p0=40:p1=0:p2=0:p3=38:GOSUB 1280:GOTO 1450
1050 plan(19,2)=2:RESTORE 2740:GOSUB 1150:p0=41:p1=0:p2=39:p3=0:GOSUB 1280:GOTO 1450
1060 plan(19,1)=2:RESTORE 2750:GOSUB 1150:p0=0:p1=43:p2=40:p3=42:GOSUB 1280:GOTO 1450
1070 plan(18,1)=2:RESTORE 2760:GOSUB 1150:p0=0:p1=41:p2=0:p3=34:GOSUB 1280:GOTO 1450
1080 plan(21,1)=2:RESTORE 2770:GOSUB 1150:p0=0:p1=0:p2=44:p3=41:GOSUB 1280:GOTO 1450
1090 plan(21,2)=2:RESTORE 2780:GOSUB 1150:p0=43:p1=45:p2=0:p3=0:GOSUB 1280:GOTO 1450
1100 plan(22,2)=2:RESTORE 2790:GOSUB 1150:p0=0:p1=46:p2=48:p3=44:GOSUB 1280:GOTO 1450
1110 plan(23,2)=2:RESTORE 2800:GOSUB 1150:p0=47:p1=0:p2=0:p3=45:GOSUB 1280:GOTO 1450
1120 plan(23,1)=2:RESTORE 2810:GOSUB 1150:p0=0:p1=0:p2=46:p3=0:GOSUB 1280:GOTO 1450
1130 plan(22,3)=2:RESTORE 2820:GOSUB 1150:p0=45:p1=0:p2=49:p3=0:GOSUB 1280:GOTO 1450
1140 plan(22,4)=2:RESTORE 2830:GOSUB 1150:p0=48:p1=0:p2=0:p3=0:GOSUB 1280:GOTO 1450:REM dessin des tab.
1150 ERASE a:DIM a(40,25):FOR h=1 TO 9:READ a1:a1$(h)=BIN$(a1,9):NEXT:FOR h=1 TO 9:FOR g=1 TO 9:b1$=MID$(a1$(h),g,1):b1=VAL(b1$):IF b1=1 THEN 1170
1160 NEXT g,h:GOTO 1210
1170 ax=(g*2)+(h*2)-1:by=(11+h)-g:|SPRIT,FNpo(ax,by),&9D00:c1$=MID$(a1$(h),g-1,1):c1=VAL(c1$):IF c1=1 THEN 1190
1180 |SPRIT,FNpo(ax,by+1),&9D81
1190 d1$=MID$(a1$(h+1),g,1):d1=VAL(d1$):IF d1=1 THEN 1160
1200 |SPRIT,FNpo(ax,by+1),&9E02:GOTO 1160
1210 READ tr:IF tr=0 THEN 1230
1220 FOR h=1 TO tr:READ a1,b1:PEN 2:LOCATE a1,b1:PRINT tr$;trou$:PEN 0:LOCATE a1,b1+1:PRINT trou1$:NEXT
1230 READ tra:IF tra=0 THEN 1250
1240 FOR h=1 TO tra:READ a1,b1:PEN 2:LOCATE a1,b1:PRINT tr$;tran$::READ cas:a(a1,b1)=cas:a(a1+1,b1)=cas:a(a1,b1+1)=cas:a(a1+1,b1+1)=cas:NEXT h
1250 IF spt(ta)=1 THEN 1270
1260 READ a1,b1:PEN 2:LOCATE a1,b1:PRINT tr$;nk$:a(a1,b1)=120:a(a1+1,b1)=120:a(a1,b1+1)=120:a(a1+1,b1+1)=120:sx=a1:sy=b1
1270 RETURN:REM sorties
1280 IF p0=0 THEN 1300
1290 PEN 1:LOCATE 12,7:PRINT tr$;CHR$(249):a(12,7)=p0:a(11,7)=p0:a(12,6)=p0:a(11,6)=p0
1300 IF p1=0 THEN 1320
1310 PEN 1:LOCATE 27,6:PRINT tr$;CHR$(248):a(27,6)=p1:a(28,6)=p1:a(27,5)=p1:a(28,5)=p1
1320 IF p2=0 THEN 1340
1330 PEN 1:LOCATE 27,15:PRINT tr$;CHR$(247):a(27,15)=p2:a(28,15)=p2:a(27,16)=p2:a(28,16)=p2
1340 IF p3=0 THEN 1360
1350 PEN 1:LOCATE 12,14:PRINT tr$;CHR$(246):a(12,14)=p3:a(11,14)=p3:a(12,15)=p3:a(11,15)=p3
1360 RETURN:REM gestion des scores
1370 PEN 1:IF sc=0 THEN LOCATE 7,23:PRINT nr$;"000000":RETURN
1380 IF sc<1000 THEN LOCATE 10,23:PRINT nr$;"   ":LOCATE 9,23:PRINT tr$;sc:RETURN
1390 IF sc<10000 THEN LOCATE 9,23:PRINT nr$;"    ":LOCATE 8,23:PRINT tr$;sc:RETURN
1400 IF sc>10000 THEN LOCATE 8,23:PRINT nr$;"     ":LOCATE 7,23:PRINT tr$;sc:RETURN
1410 PEN 1:LOCATE 7,24:PRINT nr$;"000000":IF rec=0 THEN RETURN
1420 IF rec<1000 THEN LOCATE 10,24:PRINT nr$;"   ":LOCATE 9,24:PRINT tr$;rec:RETURN
1430 IF rec<10000 THEN LOCATE 9,24:PRINT nr$;"    ":LOCATE 8,24:PRINT tr$;rec:RETURN
1440 IF rec>10000 THEN LOCATE 8,24:PRINT nr$;"     ":LOCATE 7,24:PRINT tr$;rec:RETURN
1450 PEN 0:LOCATE 36,23:PRINT CHR$(143)+CHR$(143):IF ta<10 THEN 1460 ELSE 1470
1460 PEN 1:LOCATE 36,23:PRINT"0":LOCATE 36,23:PRINT tr$;ta:GOTO 1520
1470 PEN 1:LOCATE 35,23:PRINT tr$;ta:GOTO 1520
1480 serp=serp-1:PEN 0:LOCATE 30,23:PRINT CHR$(143)+CHR$(143):IF serp<10 THEN 1500 ELSE 1490
1490 PEN 1:LOCATE 29,23:PRINT tr$;serp:RETURN
1500 PEN 1:LOCATE 30,23:PRINT"0":LOCATE 30,23:PRINT tr$;serp:IF serp=32 OR serp=22 OR serp=12 OR serp=2 AND temps<12 THEN temps=temps+1
1510 RETURN:REM routine pple
1520 CALL &A000,(x/2)-4,(y/2)+7,2:LOCATE 1,1:PRINT nr$:sh=0:sb=0:sg=0:sd=0
1530 IF fin=1 THEN tps=REMAIN(2):fin=0:GOTO 2100
1540 IF JOY(0)=16 THEN 1880
1550 IF JOY(0)=1 THEN sh=sh+2:sb=0:sd=0:sg=0:GOTO 1640
1560 IF JOY(0)=2 THEN sb=sb+2:sh=0:sd=0:sg=0:GOTO 1650
1570 IF JOY(0)=4 THEN sg=sg+2:sb=0:sd=0:sh=0:GOTO 1660
1580 IF JOY(0)=8 THEN sd=sd+2:sb=0:sh=0:sg=0:GOTO 1670
1590 IF sh>0 THEN 1640
1600 IF sb>0 THEN 1650
1610 IF sg>0 THEN 1660
1620 IF sd>0 THEN 1670
1630 GOTO 1530
1640 POKE &A12E,8:CALL &A003:CALL &A003:POKE &A12E,1:CALL &A003:sh=sh-1:x=x+4:y=y+2:GOTO 1680
1650 POKE &A12E,4:CALL &A003:CALL &A003:POKE &A12E,2:CALL &A003:sb=sb-1:x=x-4:y=y-2:GOTO 1680
1660 POKE &A12E,4:CALL &A003:CALL &A003:POKE &A12E,1:CALL &A003:sg=sg-1:x=x-4:y=y+2:GOTO 1680
1670 POKE &A12E,8:CALL &A003:CALL &A003:POKE &A12E,2:CALL &A003:sd=sd-1:x=x+4:y=y-2:GOTO 1680:REM test des couleurs
1680 IF TEST(x,y)=0 OR TEST(x,y)=2 THEN GOTO 1690 ELSE 1530
1690 xt=INT((x-1)/16)+1:yt=25-INT(y-1)/16:IF a(xt,yt)=0 THEN 1710 ELSE 1790
1700 REM balle tombe
1710 ENT 1,100,-4,2:SOUND 5,400,0,9,0,1:POKE &A12E,2:FOR h=y TO 60 STEP-2:IF TEST(x,h)<>0 AND TEST(x,h-2)<>0 THEN POKE &A03E,0:POKE &A03F,&9F:CALL &A003:GOTO 1730
1720 POKE &A03E,&11:POKE &A03F,&A0:CALL &A003
1730 NEXT:FOR h=1 TO 500:NEXT:CALL &A1D8:ba=ba-1:IF ba=0 THEN 2100
1740 PEN 1:LOCATE 16+ba,24:PRINT CHR$(143):ON dep GOTO 1750,1760,1770,1780
1750 x=416:y=168:GOTO 1520
1760 x=192:y=188:GOTO 1520
1770 x=412:y=299:GOTO 1520
1780 x=188:y=282:GOTO 1520:REM chang de tab.
1790 IF a(xt,yt)>100 THEN 1850
1800 CLS#1:ta=a(xt,yt):GOSUB 2290:IF x<200 AND y>230 THEN x=416:y=168:dep=1:GOTO 620
1810 IF x>200 AND y>230 THEN x=192:y=188:dep=2:GOTO 620
1820 IF x<200 AND y<230 THEN x=412:y=299:dep=3:GOTO 620
1830 IF x>200 AND y<230 THEN x=188:y=282:dep=4:GOTO 620
1840 GOTO 620:REM serpent touche
1850 IF a(xt,yt)>200 THEN 1870
1860 SOUND 1,40,5:FOR g=0 TO 5:ge=40+g:SOUND 1,ge,5:NEXT g:CALL &A1D8:PEN 3:LOCATE sx,sy:PRINT tr$;eff$:CALL &A098:GOSUB 1480:spt(ta)=1:sc=sc+100:GOSUB 1370:a(sx,sy)=0:a(sx+1,sy)=0:a(sx,sy+1)=0:a(sx+1,sy+1)=0:GOTO 1520:REM transfert
1870 SOUND 1,250,15,7,0,0,5:FOR t=1 TO 500:NEXT:cas=a(xt,yt):CALL &A1D8:x=16*(INT(cas/100)):y=394-((cas MOD 100)*16):GOTO 1520:REM saut
1880 SOUND 2,200,45,15,2,2:IF sh>0 THEN 1930
1890 IF sb>0 THEN 1970
1900 IF sd>0 THEN 2010
1910 IF sg>0 THEN 2050
1920 GOTO 1530
1930 IF sh>26 THEN sh=26
1940 POKE &A12E,1:FOR h=1 TO 4:CALL &A003:NEXT:FOR h=1 TO sh:IF x>610 OR y>370 THEN 1960
1950 POKE &A12E,8:CALL &A003:CALL &A003:POKE &A12E,1:CALL &A003:x=x+4:y=y+2
1960 NEXT:POKE &A12E,2:FOR h=1 TO 4:CALL &A003:NEXT:sh=INT(sh/2):GOTO 2090
1970 IF sb>26 THEN sb=26
1980 POKE &A12E,1:FOR h=1 TO 4:CALL &A003:NEXT:FOR h=1 TO sb:IF x<30 OR y<60 THEN 2000
1990 POKE &A12E,4:CALL &A003:CALL &A003:POKE &A12E,2:CALL &A003:x=x-4:y=y-2
2000 NEXT:POKE &A12E,2:FOR h=1 TO 4:CALL &A003:NEXT:sb=INT(sb/2):GOTO 2090
2010 IF sd>26 THEN sd=26
2020 POKE &A12E,1:FOR h=1 TO 4:CALL &A003:NEXT:FOR h=1 TO sd:IF x>610 OR y<60 THEN 2040
2030 POKE &A12E,8:CALL &A003:CALL &A003:POKE &A12E,2:CALL &A003:x=x+4:y=y-2
2040 NEXT:POKE &A12E,2:FOR h=1 TO 4:CALL &A003:NEXT:sd=INT(sd/2):GOTO 2090
2050 IF sg>26 THEN sg=26
2060 POKE &A12E,1:FOR h=1 TO 4:CALL &A003:NEXT:FOR h=1 TO sg:IF x<30 OR y>370 THEN 2080
2070 POKE &A12E,4:CALL &A003:CALL &A003:POKE &A12E,1:CALL &A003:x=x-4:y=y+2
2080 NEXT:POKE &A12E,2:FOR h=1 TO 4:CALL &A003:NEXT:sg=INT(sg/2):GOTO 2090
2090 WHILE INKEY$<>"":WEND:GOTO 1680:REM PERDU/GAGNE
2100 ENT 4,20,3,5:SOUND 4,20,100,15,0,4:FOR t=1 TO 2000:NEXT:BORDER 6:INK 0,6:INK 1,6:INK 2,6:INK 3,6:tps=REMAIN(2):CALL &A1D8:IF sc>rec THEN rec=sc
2110 WINDOW#7,5,36,1,25:FOR h=1 TO 5:LOCATE#7,1,1:PRINT#7,CHR$(11):NEXT:WINDOW#6,1,40,1,8:PAPER#6,3:WINDOW#5,1,5,1,25:PAPER#5,3:WINDOW#4,36,40,1,25:PAPER#4,3:WINDOW#3,5,36,24,25:PAPER#3,3::CLS#3:CLS#4:CLS#5:CLS#6:WINDOW#6,6,35,9,9:PAPER#6,2
2120 WINDOW#5,6,35,23,23:PAPER#5,2:WINDOW#4,6,6,9,23:PAPER#4,2:WINDOW#3,35,35,9,23:PAPER#3,2:CLS#3:CLS#4:CLS#5:CLS#6:sc=0:PEN 0:PRINT tr$;:FOR g=1 TO 4:FOR h=1 TO 23:p=plan(h,g):IF p=0 THEN 2160
2130 IF p=1 THEN LOCATE h+9,g:PRINT CHR$(238)
2140 IF p=2 THEN LOCATE h+9,g:PRINT CHR$(143):cent=cent+2
2150 IF p=4 THEN LOCATE h+9,g:PRINT CHR$(61)
2160 NEXT h,g:PEN 2:LOCATE 17,6:PRINT" THE MAP":LOCATE 6,7:PRINT"YOU HAVE RUN";INT(cent);"% OF YOUR TRIP":PEN 1:LOCATE 8,25:PRINT"PRESS <SPACE> TO RUN AGAIN":INK 0,0:INK 1,24:INK 2,20:INK 3,6:x=200:y=150:CALL &A000,(x/2)-4,(y/2)+7,2
2170 POKE &A12E,8:CALL &A003:CALL &A003:POKE &A12E,1:CALL &A003:x=x+4:y=y+2:GOTO 2210
2180 POKE &A12E,8:CALL &A003:CALL &A003:POKE &A12E,2:CALL &A003:x=x+4:y=y-2:GOTO 2210
2190 POKE &A12E,4:CALL &A003:CALL &A003:POKE &A12E,2:CALL &A003:x=x-4:y=y-2:GOTO 2210
2200 POKE &A12E,4:CALL &A003:CALL &A003:POKE &A12E,1:CALL &A003:x=x-4:y=y+2:GOTO 2210
2210 IF TEST(x,y)=2 THEN sens=sens+1
2220 IF sens>4 THEN sens=1
2230 IF INKEY$=" "THEN ERASE a:ERASE plan:ERASE spt:tps=REMAIN(2):GOTO 480
2240 ON sens GOTO 2170,2180,2190,2200:REM temps-1
2250 DI:temps=temps-1:LOCATE 1,1:PRINT tr$;CHR$(7):IF INT(temps/2)=temps/2 THEN GOTO 2270 ELSE GOTO 2260
2260 PEN 0:LOCATE 32+((temps-1)/2),24:PRINT CHR$(237):EI:RETURN
2270 PEN 0:LOCATE 32+(temps/2),24:PRINT CHR$(236):IF temps=0 THEN fin=1
2280 EI:RETURN:END:REM changement de couleur
2290 col=INT(RND*5)+1:ON col GOTO 2300,2310,2320,2330,2340
2300 BORDER 1:INK 0,1:INK 1,24:INK 2,20:INK 3,6:RETURN
2310 BORDER 5:INK 0,5:INK 1,0:INK 2,26:INK 3,9:RETURN
2320 BORDER 2:INK 0,2:INK 1,26:INK 2,0:INK 3,14:RETURN
2330 BORDER 1:INK 0,1:INK 1,26:INK 2,6:INK 3,0:RETURN
2340 BORDER 0:INK 0,0:INK 1,13:INK 2,10:INK 3,26:RETURN:REM data des 49 tab.
2350 DATA 255,255,255,255,255,254,253,251,0,4,28,13,28,11,28,9,28,7,0,34,10
2360 DATA 16,16,16,239,17,17,17,31,0,1,34,10,0,12,13
2370 DATA 29,1,1,129,128,129,0,128,0,0,2,20,17,1207,30,8,1414,20,3
2380 DATA 31,17,16,17,17,16,17,31,0,6 ,14,8,16,9,18,10,20,11,22,12,24,13,0,28,7  
2390 DATA 112,208,144,27,128,192,96,48,0,2,12,7,18,10,0,16,9
2400 DATA 136,136,128,255,255,8,8,11,0,6,14,12,18,12,18,10,24,9,24,7,26,12,1,6,10,3410,14,6
2410 DATA 0,0,12,205,193,27,216,192,0,5,14,14,20,15,24,11,28,9,22,8,0,24,13
2420 DATA 209,129,129,129,5,135,128,157,0,0,2,20,17,2003,34,10,610,26,6
2430 DATA 255,255,195,219,219,195,255,255,0,8,14,12,16,13,14,8,16,7,24,7,26,8,24,13,26,12,0,20,9
2440 DATA 18,27,1,15,136,129,193,255,0,0,1,22,4,2017,22,10   
2450 DATA 240,128,128,241,17,23,244,252,0,7,18,16,20,15,22,16,26,10,30,8,18,10,10,12,0,20,17
2460 DATA 28,247,227,227,227,227,247,28,0,14,14,6,14,8,14,10,16,11,18,12,20,13,24,13 ,28,13,28,11,28,9,26,8,24,7,22,6,18,6,0,26,14
2470 DATA 1,1,0,255,254,0,32,32,0,6,14,14,14,12,18,10,22,10,22,8,26,8,1,24,15,2204,20,3
2480 DATA 16,16,3,219,216,1,65,127,0,0,0,28,13   
2490 DATA 255,255,255,255,255,255,255,255,0,8,24,15,22,14,20,13,22,12,24,11,26,12,28,13,26,14,0,24,13
2500 DATA 219,183,110,221,187,119,239,223,0,4,26,12,26,10,26,8,26,6,0,28,13    
2510 DATA 31,17,17,239,144,145,145,240,0,6,12,13,20,17,20,3,26,6,16,9,20,11,0,32,9
2520 DATA 255,255,0,255,255,0,255,255,0,8,12,13,16,13,16,11,20,11,20,9,24,9,24,7,28,7,0,14,8
2530 DATA 255,129,253,0,128,254,128,240,0,2,10,12,18,14,1,20,7,2809,24,5
2540 DATA 16,16,56,40,56,16,16,16,0,4,14,10,18,12,18,8,22,10,0,16,11
2550 DATA 0,205,105,185,65,97,48,23,0,1,10,10,0,20,9    
2560 DATA 255,255,255,255,255,255,255,255,0,17,20,17,20,15,20,13,20,11,20,9,20,7,20,5,20,3,14,14,14,12,14,10,14,8,14,6,26,14,26,12,26,10,26,8,0,24,13
2570 DATA 129,129,129,129,129,129,129,129,0,4,8,11,22,4,16,15,30,8,2,6,10,3410,20,3,2017,18,16
2580 DATA 255,255,255,255,255,254,253,251,0,0,4,28,13,610,28,11,610,28,9,610,28,7,610,34,10
2590 DATA 17,112,64,118,4,12,24,16,0,0,1,22,8,2003,24,7
2600 DATA 255,255,255,255,255,0,0,253,0,0,1,34,10,610,20,17
2610 DATA 240,128,184,169,169,169,169,239,0,4,6,10,14,10,20,17,28,13,0,18,8
2620 DATA 249,243,231,207,159,63,159,207,0,1,20,3,0,24,11  
2630 DATA 24,28,14,199,227,112,59,27,0,4,16,13,24,13,16,7,24,7,0,34,10
2640 DATA 29,1,1,1,1,1,1,29,0,0,2,22,4,1605,32,9,3012,28,7
2650 DATA 255,153,153,255,255,153,153,255,0,4,10,12,24,5,16,15,30,8,4,18,10,610,20,9,2003,20,11,2017,22,10,3410,28,7
2660 DATA 240,144,144,145,17,17,19,30,0,3,6,10,12,7,30,10,0,20,11  
2670 DATA 255,255,255,255,255,255,255,255,0,4,14,10,18,8,22,10,18,12,4,16,9,610,20,9,2003,20,11,3410,16,11,2017,18,10 
2680 DATA 219,129,0,255,124,56,16,16,0,0,3,14,12,610,24,13,610,24,7,610,12,7
2690 DATA 29,5,252,129,189,231,1,31,0,3,16,5,32,9,10,12,0,20,3  
2700 DATA 16,16,16,239,18,16,18,242,0,0,0,32,11     
2710 DATA 16,16,16,16,16,16,16,255,0,0,2,18,10,2017,28,13,2017,34,10    
2720 DATA 255,129,129,129,129,129,129,255,0,0,4,6,10,1816,20,17,811,20,3,3209,34,10,2204,16,5
2730 DATA 246,134,34,128,132,132,132,252,0,1,6,10,2,16,5,3012,20,5,1414,18,4 
2740 DATA 56,56,56,56,56,56,56,56,0,12,12,9,14,8,16,7,18,8,16,9,14,10,20,13,22,12,24,11,22,14,24,13,26,12,0,20,11
2750 DATA 255,145,145,239,16,16,16,16,0,2,12,7,24,7,0,16,5 
2760 DATA 253,129,128,129,1,193,129,191,0,0,0,18,14  
2770 DATA 248,136,191,169,189,1,255,16,0,2,14,14,24,13,1,20,15,610,18,16
2780 DATA 255,255,255,255,255,255,255,255,0,10,10,8,12,9,14,8,16,7,14,6,22,6,24,5,24,7,26,8,28,7,3,18,16,610,20,15,2003,22,16,3410,20,17
2790 DATA 60,100,204,153,51,38,44,56,0,2,16,5,20,13,1,26,8,1209,18,12
2800 DATA 16,16,16,248,28,14,7,3,0,2,20,11,20,9,2,28,11,1412,28,9,1408,34,10
2810 DATA 201,173,203,169,169,32,48,16,0,0,0,12,9
2820 DATA 16,16,16,16,16,16,16,16,0,0,2,16,9,1408,22,12,2413,20,11
2830 DATA 28,28,0,59,59,3,219,216,0,0,2,20,15,1605,22,16,1406,18,16   