10 '**********************
20 '* ENVELOPPES SONORES *
30 '**********************
40 ENV 1,1,15,1,11,-1,1:ENT 1,1,120,1,12,-10,4
50 ENV 2,13,1,2,16,0,1,15,-1,10:ENT 2,3,7,1,3,-7,1
60 ENV 3,1,15,1,5,-1,4,3,0,1:ENT -3,1,2,1
70 ENV 4,12,-1,16
80 ENV 5,1,12,1,6,-1,2:ENT 5,2,30,1,2,-30,1
90 ENT 6,1,20,1,2,-10,1
100 ENT 7,3,20,1,3,-20,1:ENV 7,1,13,1,6,-2,1,5,0,1
110 ENV 8,1,9,1,9,-1,14:ENT -8,1,-1,1
120 ENV 9,5,2,1,10,-1,4:ENT -9,20,-100,1,20,100,1
130 ENV 10,1,10,1,10,-1,2:ENT 10,4,-40,1,4,40,1
140 ENV 11,15,1,1,15,-1,10
150 ENV 12,5,2,1,10,-1,1
160 '****************
170 '* PRESENTATION *
180 '****************
190 CLS:GOSUB 300
200 CALL &6000:GOTO 570
210 CALL &A000
220 '****************
230 '* DATAS MUSICS *
240 '****************
250 DATA 1,1,1,1,1,0,1,1,0,1,1,0,1,0,1,0
260 DATA 956,804,1204,1432
270 DATA 80,100,119,100,80,100,134,100
280 DATA 75,100,119,100,75,89,119,89
290 DATA 1,2,4,2,1,1,2,2,2,2,1,1,4
300 DIM RY(16),NO(16):RESTORE 250
310 FOR I=1 TO 16:READ RY(I):NEXT
320 FOR I=1 TO 4:READ BAS(I):NEXT
330 FOR I=1 TO 16:READ NO(I):NEXT
340 FOR I=1 TO 4:READ DIV(I):NEXT
350 FOR I=1 TO 9:READ MORS(I):NEXT
360 '
370 DATA 716,638,602,536,638,602,451,536,478,536,638,602
380 '
390 DIM SO(144),NO2(32)
400 RESTORE 370:FOR I=1 TO 4:FOR J=1 TO 4
410 IF J=4 THEN A=716 ELSE READ A
420 NO2((I-1)*8+J)=A:NO2((I-1)*8+J+4)=A*2
430 NEXT J,I
440 '
450 DATA 402,478,319,301,268,402,478,319,301,268
460 DATA 301,358,239,225,201,402,478,319,301,268
470 DATA 268,319,213,201,179,301,358,239,225,201
480 '
490 RESTORE 450:FOR J=0 TO 5:READ A,B,C,D,E:F=0
500 FOR I=1 TO 24 STEP 3:SO(I+1+J*24)=A:SO(I+2+J*24)=B
510 F=F+1:IF F=4 OR F=6 THEN N=D:GOTO 530
520 IF F=5 THEN N=E ELSE N=C
530 SO(I+J*24)=N:NEXT I,J:RETURN
540 '******************
550 '* PREMIERE MUSIC *
560 '******************
570 CALL &BB03:CALL &BCA7:FOR I=1 TO 9:SOUND 7,30,12*MORS(I),0,1
580 NEXT I:WHILE SQ(1)<>4:WEND:RY=0:OK=0
590 GOSUB 740:EVERY 6 GOSUB 740
600 SOUND 5,0,384,0
610 FOR I=1 TO 2:FOR BAS=1 TO 4:SOUND 4,BAS(BAS)/I,-1,2,2,1
620 SOUND 1,BAS(BAS)-BAS,-1,2,2,1:NEXT BAS,I
630 FOR J=1 TO 2:FOR BAS=1 TO 4:FOR I=1 TO 4
640 SOUND 1,BAS(BAS)/DIV(I),24,0,3:NEXT I
650 SOUND 4,BAS(BAS)/2,96,15,2,1:NEXT BAS,J
660 FOR J=1 TO 4:FOR BAS=0 TO 3:FOR I=1 TO 4
670 SOUND 4,BAS(BAS+1)/DIV(I),24,1,3
680 FOR P=1 TO 2:NO=NO+1:IF NO=5 THEN NO=1
690 IF J>2 THEN PP=ROUND(I/2) ELSE PP=1
700 SOUND 1,NO(NO+BAS*4)/PP,12,10,0,2
710 NEXT P,I,BAS,J:SOUND 1,60,-1,12,4,3
720 SOUND 4,119,-1,12,4,3:WHILE SQ(1)<>4:WEND
730 A=REMAIN(0):GOTO 570
740 RY=RY+1:IF RY=17 THEN RY=1:OK=1
750 IF OK=1 THEN RYTH=RY*1.9
760 SOUND 2,RY(RY)*60,12,0,RY(RY),0,RYTH
770 IF INKEY(47)<>0 THEN RETURN
780 A=REMAIN(0):CALL &BCA7:GOTO 210
790 '******************
800 '* DEUXIEME MUSIC *
810 '******************
820 FO=0:CALL &BB03:CALL 37000
830 FOR L=1 TO 2:FOR K=1 TO 32
840 DIV=1:FO=FO+1:IF FO=9 THEN FO=1
850 IF L=2 AND FO<5 THEN DIV=2
860 SOUND 1,NO2(K),-1,3,5,5:SOUND 1,956,-1,3,5
870 SOUND 2,NO2(K)/(DIV*2),-1,3,5,4+DIV:SOUND 2,478,-1,3,5
880 SOUND 4,NO2(K)/64,13,7:SOUND 4,NO2(K)/32,13,8
890 IF INKEY(47)=0 THEN 910
900 NEXT K,L:FO=0:GOTO 830
910 CALL &BCA7:RETURN
920 '*******************
930 '* TROISIEME MUSIC *
940 '*******************
950 CALL &BB03:FOR J=1 TO 2:F=0:MUL=0:FOR I=1 TO 144:DIV=1
960 IF J=1 THEN 980 ELSE IF F=6 THEN MUL=MUL XOR 1
970 F=F+1:IF F=7 THEN F=1:DIV=4*(MUL+1) ELSE DIV=2
980 SOUND 1,SO(I)/DIV,11,13,0,7:SOUND 1,(J*SO(I))/16,1,10+J
990 SOUND 4,SO(I)+1,12,13,0,7
1000 BA=BA+1:IF BA=25 THEN BA=1
1010 SOUND 2,0,-1,2,7,,BA
1020 IF INKEY(47)=0 THEN RETURN
1030 NEXT I,J:GOTO 950
1040 '************************
1050 '* S/P FENETRE CENTRALE *
1060 '************************
1070 WINDOW #1,2,16,8,12:PAPER #1,8
1080 CLS#1:PLOT 48,278,0:DRAWR 448,0
1090 DRAWR 0,-64:DRAWR -448,0:DRAWR 0,64
1100 RETURN
1110 '***************
1120 '* LES TOUCHES *
1130 '***************
1140 GOSUB 1070:PEN#1,10
1150 LOCATE #1,2,2:PRINT#1,"(J)oy  (C)urs"
1160 CALL &9934
1170 IF INKEY(62)=0 THEN RESTORE 1260:GOTO 1200
1180 IF INKEY(54)=0 THEN 1310
1190 IF INKEY(45)<>0 THEN 1170 ELSE RESTORE 1270
1200 POKE &95E0,102:POKE &95E1,1
1210 POKE &95DF,0:PEN 0:LOCATE 12,23
1220 PRINT CHR$(22)CHR$(1);CHR$(255);STRING$(6,253);
1230 PRINT CHR$(254);CHR$(22);CHR$(0);
1240 FOR I=0 TO 4:READ A:POKE &91E0+I*5,A:NEXT I
1250 CALL &90AD:RETURN
1260 DATA 240,241,242,243,32
1270 DATA 11,10,8,9,88
1280 '**********
1290 '* BALADE *
1300 '**********
1310 XMI=0:YMI=0:XMA=56:YMA=84
1320 X=42:Y=14:GOTO 1390
1330 IF INKEY(8)=0 AND X<>XMI THEN X=X-1:GOTO 1390
1340 IF INKEY(1)=0 AND X<>XMA THEN X=X+1:GOTO 1390
1350 IF INKEY(0)=0 AND Y<>YMI THEN Y=Y-1:GOTO 1390
1360 IF INKEY(2)=0 AND Y<>YMA THEN Y=Y+1:GOTO 1390
1370 IF INKEY(47)=0 THEN 1410
1380 GOTO 1330
1390 SHG=22000+X*2+Y*142:S1=INT(SHG/256):S2=SHG-S1*256
1400 POKE &9185,S2:POKE &9186,S1:CALL &90AD:GOTO 1330
1410 POKE &9185,8:POKE &9186,94:CALL &90AD:GOTO 1140
1420 '******************
1430 '* INITIALISATION *
1440 '******************
1450 WINDOW #2,2,16,2,18:PAPER #2,0
1460 RESTORE 1490:FOR K=1 TO 4:READ P1(K),P2(K):NEXT
1470 FOR K=1 TO 4:TY=P2(K):FOR P=1 TO P1(K):READ I,J
1480 GOSUB 1570:NEXT P,K:COSMO=0:CLS#2:RETURN
1490 DATA 20,13,22,28,11,27,6,26
1500 DATA 4,5,7,11,10,26,14,21,16,21,23,21,25,26,32,16,36,17,37,17
1510 DATA 38,25,48,9,55,7,58,7,55,14,56,25,52,25,61,19,63,14,18,21
1520 DATA 18,4,10,20,6,43,34,25,37,40,25,50,57,19,55,43,51,50,65,24
1530 DATA 19,68,18,89,12,95,25,55,25,68,33,89,55,62,49,75,54,90,63,95
1540 DATA 66,68,66,75
1550 DATA 52,14,20,14,47,35,53,35,10,50,8,68,10,62,59,55,26,62,65,75,61,90
1560 DATA 38,40,22,55,25,62,58,55,12,14,66,6
1570 TYP=20000+(TY-1)*32
1580 T1=INT(TYP/256):T2=TYP-T1*256
1590 ADR=22000+I*2+(J+1)*71*2
1600 POKE ADR,T2:POKE ADR+1,T1
1610 RETURN