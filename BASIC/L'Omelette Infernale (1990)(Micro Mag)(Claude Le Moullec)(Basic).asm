10 REM  :::::::::::::::::::::::
20 REM  :                     :
30 REM  :  CLAUDE LE  MOULLEC :
40 REM  :                     : 
50 REM  : 83 RUE JOLIOT CURIE :
60 REM  :                     : 
70 REM  :    22420 PLOUARET   :
80 REM  :                     :   
90 REM  :   TEL  96 38 94 24  :
100 REM :                     : 
110 REM :::::::::::::::::::::::
120 MEMORY &7FFF   
130 LOAD "spritegg",&8000   
140 LOAD "routegg",&A000
150 GOSUB 2970:REM supprimer cette ligne si vous ne tapez pas la presentation
160 REM ::::::::::::::::::::::: 
170 REM :                     : 
180 REM :  VARIABLES DE BASE  :  
190 REM :                     : 
200 REM ::::::::::::::::::::::: 
210 DEFINT a-z:CLS:LOCATE 1,1:PRINT "30 s DE PATIENCE....":GOSUB 2520
220 MODE 0:BORDER 0:RESTORE 230:FOR h=0 TO 15:READ a:INK h,a:NEXT  
230 DATA 0,2,3,11,9,24,15,6,0,16,7,13,26,24,9,18    
240 DIM m1(20):DEF FN POK(A,B)=&9C7E+(B-1)*39+A  
250 ENV 1,100,3,1:ENT 1,100,2,2
260 ENT 2,10,-2,2:ENV 2,10,-1,2
270 WINDOW #1,1,20,2,25:oeuf=0:tr=1:vie=3
280 REM :::::::::::::::::::::::  
290 REM :                     :  
300 REM :   BRANCHEMENT TAB   :
310 REM :                     : 
320 REM :::::::::::::::::::::::  
330 ON tr GOTO 340,350,360,370,2240    
340 POKE &A446,&FE:POKE &A447,&98:CALL &A445:GOTO 410 
350 POKE &A446,&7D:POKE &A447,&95:CALL &A445:NBO=OF:GOSUB 2810:GOTO 400
360 POKE &A446,&FC:POKE &A447,&91:CALL &A445:NBO=OF:GOSUB 2810:GOTO 390
370 POKE &A446,&7C:POKE &A447,&8E:CALL &A445:NBO=OF:GOSUB 2810:GOTO 380  
380 vx=32:vy=18:m1(18)=1
390 nx=30:ny=10:m1(16)=1
400 mx=15:my=18:m1(14)=1   
410 PEN 7:LOCATE 1,1:PRINT "TAB   VIE   OEUF    "
420 PEN 15:LOCATE 4,1:PRINT TR:LOCATE 10,1:PRINT vie
430 REM :::::::::::::::::::::::
440 REM :                     : 
450 REM : ROUTINE  PRINCIPALE :
460 REM :                     :
470 REM :::::::::::::::::::::::
480 POKE FN pok(1,5),4:CALL &A0A5:POKE FN pok(1,5),1:POKE FN pok(2,5),9
490 CALL &A432:GOSUB 1440
500 GOSUB 610
510 CALL &A432:GOSUB 1440
520 GOSUB 880  
530 CALL &A432:GOSUB 1440
540 GOSUB 1140
550 GOTO 490
560 REM :::::::::::::::::::::::
570 REM :                     :
580 REM : MOUVEMENTS MONSTRES :
590 REM :                     : 
600 REM :::::::::::::::::::::::  
610 IF m1(14)=0 THEN RETURN      
620 m=INT(RND*2)+1:MX1=MX:MY1=MY   
630 ON SM GOTO 640,840,850,860 
640 MY=MY-1:IF PEEK(FN POK(MX,MY))=0 THEN 670
650 IF PEEK(FN POK(MX,MY))=9 THEN 1790
660 SM=INT(RND*4)+1:MX=MX1:MY=MY1:RETURN   
670 ta=PEEK(&A33D):ON ta GOTO 680,720,760,800 
680 DEF FN PO(X,Y)=&C050+(Y-1)*160+(X-1)*4
690 IF mx1<21 AND my1<13 THEN CALL &A00D,FN PO(MX1,MY1),&8000 
700 IF mx<21 AND my<13 THEN CALL &A00D,FN PO(MX,MY),&8340+(&40*m)
710 POKE FN POK(MX1,MY1),0:POKE FN POK(MX,MY),14:RETURN   
720 DEF FN PO(X,Y)=&C050+(Y-1)*160+(X-20)*4
730 IF mx1>19 AND my1<13 THEN CALL &A00D,FN PO(MX1,MY1),&8000 
740 IF mx>19 AND my<13 THEN CALL &A00D,FN PO(MX,MY),&8340+(&40*m) 
750 GOTO 710
760 DEF FN PO(X,Y)=&C050+(Y-12)*160+(X-1)*4
770 IF mx1<21 AND my1>11 THEN CALL &A00D,FN PO(MX1,MY1),&8000 
780 IF mx<21 AND my>11 THEN CALL &A00D,FN PO(MX,MY),&8340+(&40*m)
790 GOTO 710 
800 DEF FN PO(X,Y)=&C050+(Y-12)*160+(X-20)*4
810 IF mx1>19 AND my1>11 THEN CALL &A00D,FN PO(MX1,MY1),&8000 
820 IF mx>19 AND my>11 THEN CALL &A00D,FN PO(MX,MY),&8340+(&40*m)  
830 GOTO 710   
840 MX=MX+1:IF PEEK(FN POK(MX,MY))=0 THEN 670 ELSE 650
850 MY=MY+1:IF PEEK(FN POK(MX,MY))=0 THEN 670 ELSE 650  
860 MX=MX-1:IF PEEK(FN POK(MX,MY))=0 THEN 670 ELSE 650 
870 REM ::: MONSTRE 2 :::
880 IF m1(16)=0 THEN RETURN ELSE NX1=NX:NY1=NY  
890 ON SN GOTO 900,1100,1110,1120
900 NY=NY-1:IF PEEK(FN POK(NX,NY))=0 THEN 930
910 IF PEEK(FN POK(nX,nY))=9 THEN 1790
920 SN=INT(RND*4)+1:NX=NX1:NY=NY1:RETURN   
930 ta=PEEK(&A33D):ON ta GOTO 940,980,1020,1060
940 DEF FN PO(X,Y)=&C050+(Y-1)*160+(X-1)*4   
950 IF Nx1<21 AND Ny1<13 THEN CALL &A00D,FN PO(NX1,NY1),&8000  
960 IF Nx<21 AND Ny<13 THEN CALL &A00D,FN PO(NX,NY),&83C0+(&40*m)  
970 POKE FN POK(NX1,NY1),0:POKE FN POK(NX,NY),16:RETURN  
980 DEF FN PO(X,Y)=&C050+(Y-1)*160+(X-20)*4 
990 IF Nx1>19 AND Ny1<13 THEN CALL &A00D,FN PO(NX1,NY1),&8000 
1000 IF Nx>19 AND Ny<13 THEN CALL &A00D,FN PO(NX,NY),&83C0+(&40*m)
1010 GOTO 970
1020 DEF FN PO(X,Y)=&C050+(Y-12)*160+(X-1)*4 
1030 IF Nx1<21 AND Ny1>11 THEN CALL &A00D,FN PO(NX1,NY1),&8000 
1040 IF Nx<21 AND Ny>11 THEN CALL &A00D,FN PO(NX,NY),&83C0+(&40*m)
1050 GOTO 970
1060 DEF FN PO(X,Y)=&C050+(Y-12)*160+(X-20)*4 
1070 IF Nx1>19 AND Ny1>11 THEN CALL &A00D,FN PO(NX1,NY1),&8000
1080 IF Nx>19 AND Ny>11 THEN CALL &A00D,FN PO(NX,NY),&83C0+(&40*m) 
1090 GOTO 970  
1100 NX=NX+1:IF PEEK(FN POK(NX,NY))=0 THEN 930 ELSE 910
1110 NY=NY+1:IF PEEK(FN POK(NX,NY))=0 THEN 930 ELSE 910 
1120 NX=NX-1:IF PEEK(FN POK(NX,NY))=0 THEN 930 ELSE 910 
1130 REM :::  MONSTRE 2  :::
1140 IF m1(18)=0 THEN RETURN ELSE VX1=VX:VY1=VY   
1150 ON SV GOTO 1160,1360,1370,1380
1160 VY=VY-1:IF PEEK(FN POK(VX,VY))=0 THEN 1190
1170 IF PEEK(FN POK(VX,VY))=9 THEN 1790 
1180 SV=INT(RND*4)+1:VX=VX1:VY=VY1:RETURN     
1190 TA=PEEK(&A33D):ON TA GOTO 1210,1250,1280,1320   
1200 DEF FN PO(X,Y)=&C050+(Y-1)*160+(X-1)*4  
1210 IF Vx1<21 AND Vy1<13 THEN CALL &A00D,FN PO(VX1,VY1),&8000 
1220 IF Vx<21 AND Vy<13 THEN CALL &A00D,FN PO(VX,VY),&8440+(&40*m) 
1230 POKE FN POK(VX1,VY1),0:POKE FN POK(VX,VY),18:RETURN 
1240 DEF FN PO(X,Y)=&C050+(Y-1)*160+(X-20)*4 
1250 IF Vx1>19 AND Vy1<13 THEN CALL &A00D,FN PO(VX1,VY1),&8000 
1260 IF Vx>19 AND Vy<13 THEN CALL &A00D,FN PO(VX,VY),&8440+(&40*m)
1270 GOTO 1230
1280 DEF FN PO(X,Y)=&C050+(Y-12)*160+(X-1)*4 
1290 IF Vx1<21 AND Vy1>11 THEN CALL &A00D,FN PO(VX1,VY1),&8000
1300 IF Vx<21 AND Vy>11 THEN CALL &A00D,FN PO(VX,VY),&8440+(&40*m) 
1310 GOTO 1230  
1320 DEF FN PO(X,Y)=&C050+(Y-12)*160+(X-20)*4  
1330 IF Vx1>19 AND Vy1>11 THEN CALL &A00D,FN PO(VX1,VY1),&8000  
1340 IF Vx>19 AND Vy>11 THEN CALL &A00D,FN PO(VX,VY),&8440+(&40*m)
1350 GOTO 1230  
1360 VX=VX+1:IF PEEK(FN POK(VX,VY))=0 THEN 1190 ELSE 1170
1370 VY=VY+1:IF PEEK(FN POK(VX,VY))=0 THEN 1190 ELSE 1170 
1380 VX=VX-1:IF PEEK(FN POK(VX,VY))=0 THEN 1190 ELSE 1170
1390 REM :::::::::::::::::::::::
1400 REM :                     : 
1410 REM :   S/PROG  DIVERS    :
1420 REM :                     :  
1430 REM ::::::::::::::::::::::: 
1440 a=1+PEEK(&A425):IF a>13 THEN 1790
1450 ON a GOTO 1460,1460,1470,1640,1650,1670
1460 RETURN
1470 sp=2:ram=&8080:GOSUB 1950:a=PEEK(FN pok(ax,ay))
1480 IF a>13 THEN 1530
1490 IF a=5 THEN 1500 ELSE IF pa=0 THEN 1510 ELSE RETURN
1500 ax1=ax:ay1=ay:sp=0:ram=&8180:ON ta GOSUB 2070,2110,2150,2190:GOTO 1750
1510 ax=ax1:ay=ay1:sp=0:ram=&8000:ON ta GOSUB 2070,2110,2150,2190
1520 SOUND 2,50,0,15,2,2,31:RETURN
1530 ax1=ax:ay1=ay:sp=0:ram=&8000:ON ta GOSUB 2070,2110,2150,2190 
1540 m1(a)=0:mons=a:SOUND 2,50,0,15,2,2,31
1550 IF a=14 THEN AFTER 500,1 GOSUB 1600:RETURN
1560 IF a=16 THEN AFTER 500,2 GOSUB 1600:RETURN 
1570 IF a=18 THEN AFTER 500,3 GOSUB 1600:RETURN   
1580 AFTER 500,1 GOSUB 1600:RETURN
1590 REM ::: TEMPO MONSTRE ::::
1600 mzx=INT(RND*39)+1:mzy=INT(RND*23)+1:IF PEEK(FN pok(mzx,mzy))<>0 THEN 1600
1610 IF mons=14 THEN mx=mzx:my=mzy:m1(14)=1:RETURN
1620 IF mons=16 THEN nx=mzx:ny=mzy:m1(16)=1:RETURN 
1630 IF mons=18 THEN vx=mzx:vy=mzy:m1(18)=1:RETURN   
1640 sp=3:ram=&80C0:GOSUB 1950:IF pa=0 THEN 1510 ELSE RETURN 
1650 IF oeuf>11 THEN 1660 ELSE RETURN 
1660 ax=ax1:ay=ay1:sp=0:ram=&8000:ON ta GOSUB 2070,2110,2150,2190:GOTO 1870
1670 sp=5:ram=&8140:GOSUB 1950:a=PEEK(FN pok(ax,ay)) 
1680 IF a=1 OR a=2 THEN 1740
1690 IF a=4 THEN oeuf=oeuf+1:LOCATE 17,1:PEN 15:PRINT oeuf:GOTO 1710
1700 RETURN
1710 ax1=ax-1:ay1=ay:sp=4:ram=&8100   
1720 ON ta GOSUB 2070,2110,2150,2190 
1730 FOR h=5 TO 100 STEP 5:SOUND 1,50+h,3,5:NEXT:RETURN
1740 ax=ax1:ay=ay1:sp=0:ram=&8180:ON ta GOSUB 2070,2110,2150,2190 
1750 FOR t=1 TO 200:NEXT t:ram=&81C0:ON ta GOSUB 2070,2110,2150,2190
1760 FOR t=1 TO 200:NEXT t:ram=&8000:ON ta GOSUB 2070,2110,2150,2190
1770 SOUND 1,100,30,15,1,2,6:RETURN
1780 REM ::: VIE - 1 :::
1790 FOR h=0 TO 3:mu=REMAIN(h):NEXT:vie=vie-1
1800 oeuf=0:BORDER 26:INK 0,26:INK 7,26  
1810 OUT &BC00,2:OUT &BD49,49:SOUND 4,1500,50,7,0,0,10:OUT &BC00,2:OUT &BD49,46
1820 FOR t=1 TO 4000:NEXT:BORDER 0:POKE &A33D,1:BORDER 0:RESTORE 1880
1830 FOR h=&A100 TO &A107:READ a$:POKE h,VAL("&"+a$):NEXT
1840 RESTORE 230:FOR h=0 TO 15:READ a:INK h,a:NEXT:IF vie=0 THEN 2240
1850 CALL &A445:NBO=OF:GOSUB 2810:ON tr GOTO 410,400,390,380 
1860 REM ::: TAB + 1 :::
1870 RESTORE 1880:FOR h=&A100 TO &A107:READ a$:POKE h,VAL("&"+a$):NEXT
1880 DATA 02,01,02,05,1C,9D,D4,C2 
1890 POKE &A33D,1:of=oeuf:oeuf=0:tr=tr+1:GOTO 330 
1900 REM ::::::::::::::::::::::: 
1910 REM :                     : 
1920 REM :  MOUVEMENT D'OBJETS :
1930 REM :                     :  
1940 REM :::::::::::::::::::::::  
1950 pa=0:ta=PEEK(&A33D):ss=PEEK(&A100):ON ss GOTO 1960,1970,1980,1990
1960 ax=PEEK(&A102):ay=PEEK(&A103)-1:GOTO 2000
1970 ax=PEEK(&A102)+1:ay=PEEK(&A103):GOTO 2000 
1980 ax=PEEK(&A102):ay=PEEK(&A103)+1:GOTO 2000 
1990 ax=PEEK(&A102)-1:ay=PEEK(&A103)
2000 ON ss GOTO 2010,2020,2030,2040  
2010 ax1=ax:ay1=ay:ay=ay-1:IF PEEK(FN pok(ax,ay))=0 THEN 2050 ELSE RETURN 
2020 ax1=ax:ay1=ay:ax=ax+1:IF PEEK(FN pok(ax,ay))=0 THEN 2050 ELSE RETURN
2030 ax1=ax:ay1=ay:ay=ay+1:IF PEEK(FN pok(ax,ay))=0 THEN 2050 ELSE RETURN
2040 ax1=ax:ay1=ay:ax=ax-1:IF PEEK(FN pok(ax,ay))=0 THEN 2050 ELSE RETURN
2050 ON ta GOSUB 2070,2110,2150,2190  
2060 pa=pa+1:GOTO 2000  
2070 DEF FN PO(X,Y)=&C050+(Y-1)*160+(X-1)*4 
2080 IF ax1<21 AND ay1<13 THEN CALL &A00D,FN PO(aX1,aY1),&8000
2090 IF ax<21 AND ay<13 THEN CALL &A00D,FN PO(aX,aY),ram
2100 POKE FN POK(aX1,aY1),0:POKE FN POK(aX,aY),sp:RETURN
2110 DEF FN PO(X,Y)=&C050+(Y-1)*160+(X-20)*4
2120 IF ax1>19 AND ay1<13 THEN CALL &A00D,FN PO(aX1,aY1),&8000  
2130 IF ax>19 AND ay<13 THEN CALL &A00D,FN PO(ax,ay),ram
2140 GOTO 2100
2150 DEF FN PO(X,Y)=&C050+(Y-12)*160+(X-1)*4 
2160 IF ax1<21 AND ay1>11 THEN CALL &A00D,FN PO(aX1,aY1),&8000 
2170 IF ax<21 AND ay>11 THEN CALL &A00D,FN PO(aX,aY),ram
2180 GOTO 2100
2190 DEF FN PO(X,Y)=&C050+(Y-12)*160+(X-20)*4    
2200 IF ax1>19 AND ay1>11 THEN CALL &A00D,FN PO(aX1,aY1),&8000 
2210 IF ax>19 AND ay>11 THEN CALL &A00D,FN PO(aX,aY),ram
2220 GOTO 2100
2230 X=0:FOR H=1 TO 23:FOR G=1 TO 39:A=PEEK(&9C7F+X):PRINT USING "#";A;:X=X+1:NEXT G:PRINT:NEXT H  
2240 REM ::::::::::::::::::::::: 
2250 REM :                     : 
2260 REM :    FIN DE PARTIE    :
2270 REM :                     : 
2280 REM :::::::::::::::::::::::  
2290 PEN 12:WHILE INKEY$<>"":WEND     
2300 a$="BRAVO C'EST PAS MAL,MAIS ON PEUT FAIRE MIEUX ---- POUR REJOUER APPUYEZ SUR UNE TOUCHE ----" 
2310 B$="CE SOIR L'OMELETTE SERA REMPLACEE PAR UN PLAT DE NOUILLES A MOINS QUE VOUS VOULIEZ REJOUER ---- POUR CELA APPUYEZ SUR UNE TOUCHE ----"     
2320 IF TR=5 THEN C$=A$:RESTORE 2450:GOTO 2340 
2330 C$=B$:RESTORE 2450:GOTO 2340  
2340 P=1:WHILE P<>0:READ P,D
2350 SOUND 49,P/2,INT(6*d*0.8334),15  
2360 SOUND 42,P,INT(12*d*0.8334),15    
2370 SOUND 28,P/3,INT(6*d*0.8334),15:WEND
2380 FOR T=1 TO 3000:NEXT:CALL &BCA7
2390 LOCATE 1,1:PRINT SPACE$(20):WHILE INKEY$<>"":WEND
2400 T$="":PEN 9:WHILE t$="":SOUND 1,RND*600+50,5,15
2410 d$=LEFT$(c$,1) 
2420 LOCATE 1,1:PRINT MID$(c$,1,20) 
2430 t$=INKEY$:c$=RIGHT$(c$,LEN(c$)-1)+d$:WEND:CLS
2440 FOR h=14 TO 18:m1(h)=0:NEXT:GOTO 270
2450 DATA 478,2,426,1,358,1,379,1,426,1,319,2,319,2,319,1,284,1,379,1,358,1,426,2,426,2,426,1,358,1,379,1,426,1,478,1,239,1,253,1,284,1,319,1,358,1,379,1,426,1,478,1,0,0  
2460 DATA 426,4,426,3,426,2,426,3,358,4,379,2,379,3,426,2,426,3,478,2,426,3,0,0
2470 REM ::::::::::::::::::::::: 
2480 REM :                     : 
2490 REM :  CREATION DES 4 TAB :
2500 REM :                     : 
2510 REM :::::::::::::::::::::::
2520 deb=&98FD:DEF FN POK(A,B)=deb+(B-1)*39+A    
2530 FOR h=deb TO deb+896:POKE h,0:NEXT 
2540 GOSUB 2700:x=14:z=31:GOSUB 2730:x=7:z=14:GOSUB 2770
2550 nbc=75:nbo=35:sp=3:GOSUB 2810:GOSUB 2850:nbp=5:GOSUB 2890
2560 deb=&957C:DEF FN POK(A,B)=deb+(B-1)*39+A    
2570 FOR h=deb TO deb+896:POKE h,0:NEXT  
2580 GOSUB 2700:x=18:z=18:GOSUB 2730:x=10:z=14:GOSUB 2770 
2590 nbc=70:sp=3:GOSUB 2850:nbp=5:GOSUB 2890:nbp=25:GOSUB 2890  
2600 deb=&91FB:DEF FN POK(A,B)=deb+(B-1)*39+A 
2610 FOR h=deb TO deb+896:POKE h,0:NEXT    
2620 GOSUB 2700:x=15:z=28:GOSUB 2730
2630 nbc=70:sp=3:GOSUB 2850:nbp=2:GOSUB 2890:nbp=27:GOSUB 2890 
2640 deb=&8E7B:DEF FN POK(A,B)=deb+(B-1)*39+A  
2650 FOR h=deb TO deb+896:POKE h,0:NEXT 
2660 GOSUB 2700:x=11:z=18:GOSUB 2770
2670 nbc=50:sp=3:GOSUB 2850:nbc=25:sp=2:GOSUB 2850:nbp=2:GOSUB 2890 
2680 RETURN
2690 REM le cadre
2700 FOR h=1 TO 39:POKE FN POK(h,1),1:POKE FN POK(h,23),1:NEXT
2710 FOR h=2 TO 22:POKE FN POK(1,h),1:POKE FN POK(39,h),1:NEXT:RETURN 
2720 REM lignes verticales
2730 FOR g=1 TO 2:FOR h=2 TO 20:y=INT(RND*5)+1  
2740 IF y=1 THEN 2750 ELSE y=2   
2750 POKE FN POK(x,h),y:NEXT h:x=z:NEXT g:RETURN 
2760 REM les horizontales    
2770 FOR g=1 TO 2:FOR h=2 TO 38:y=INT(RND*5)+1  
2780 IF y=1 THEN 2790 ELSE y=2  
2790 POKE FN POK(h,x),y:NEXT h:x=z:NEXT g:RETURN  
2800 REM les oeufs
2810 FOR h=1 TO nbo  
2820 x=INT(RND*35)+3:y=INT(RND*17)+3:IF PEEK(FN pok(x,y))=0 THEN 2830 ELSE 2820
2830 POKE FN POK(x,y),5:NEXT:RETURN
2840 REM les cartons
2850 FOR h=1 TO nbc  
2860 x=INT(RND*35)+3:y=INT(RND*17)+3:IF PEEK(FN pok(x,y))=0 THEN 2870 ELSE 2860
2870 POKE FN POK(x,y),sp:NEXT:POKE FN POK(2,5),11:RETURN   
2880 REM les portes
2890 FOR h=nbp TO nbp+10:POKE FN POK(h,22),3:NEXT  
2900 FOR h=20 TO 22:POKE FN POK(nbp+11,h),1:NEXT:POKE FN POK(nbp+10,20),1:POKE FN POK(nbp+10,21),4:RETURN 
2910 REM ::::::::::::::::::::::::
2920 REM :                      :
2930 REM :     PRESENTATION     :
2940 REM :     (facultative)    :
2950 REM :                      :
2960 REM :::::::::::::::::::::::: 
2970 MODE 0:BORDER 0:RESTORE 2980:FOR h=0 TO 15:READ a:INK h,a:NEXT  
2980 DATA 0,2,3,11,9,24,3,6,6,16,6,13,26,24,9,18 
2990 RESTORE 3390:ENV 1,1,15,1,3,-1,4,12,-1,8:EVERY 25,1 GOSUB 3370
3000 x=0:FOR h=80 TO 112 STEP 2:PLOT 96-x,h,11:DRAW 288+x,h:x=x+2:NEXT 
3010 FOR h=80 TO 96 STEP 2:PLOT 288,h:DRAW 496,208:DRAW 520,208:NEXT
3020 FOR h=1 TO 3:CALL &A00D,&C5D7+(h*4),&81C0
3030 CALL &A00D,&C5CB+(h*4),&8140:NEXT
3040 FOR h=1 TO 100:x=INT(RND*160)+1:y=INT(RND*20)+1   
3050 PLOT 112+x,64+y,7:x=INT(RND*160)+1:y=INT(RND*20)+1
3060 PLOT 112+x,64+y,5:NEXT:INK 7,24,6:INK 5,6,24   
3070 PEN 0:LOCATE 4,21:PRINT CHR$(22)+CHR$(1)+CHR$(215)  
3080 LOCATE 9,21:PRINT CHR$(214)+CHR$(22)+CHR$(0) 
3090 SYMBOL 249,0,138,142,138,138,138,234,0  
3100 SYMBOL 250,0,224,128,128,128,128,224,0 
3110 SYMBOL 251,0,238,138,138,234,42,238,0  
3120 SYMBOL 252,0,238,132,132,196,132,132,0  
3130 SYMBOL 253,0,174,170,170,174,234,170,0   
3140 SYMBOL 254,0,238,168,232,204,168,174,0    
3150 lmc$=CHR$(249)+CHR$(250)+CHR$(251)+CHR$(252)+CHR$(253)+CHR$(254)
3160 PLOT -10,-10,12:TAG:MOVE 40,50:PRINT LMC$;:TAGOFF
3170 FOR H=1 TO 5:MOVE 30,H:DRAW 610,H,4:NEXT:FOR H=6 TO 20:MOVE 30,H:DRAW 610,H,8:NEXT      
3180 FOR H=20 TO 22:MOVE 30,H:DRAW 610,H,1:NEXT:FOR H=1 TO 8:MOVE H,26:DRAW H,374,4:NEXT     
3190 FOR H=8 TO 20:MOVE H,26:DRAW H,374,8:NEXT:FOR H=20 TO 22:MOVE H,26:DRAW H,374,1:NEXT  
3200 FOR H=616 TO 620:MOVE H,26:DRAW H,374,1:NEXT:FOR H=620 TO 632:MOVE H,26:DRAW H,374,8:NEXT 
3210 FOR H=632 TO 636:MOVE H,26:DRAW H,374,4:NEXT:FOR H=394 TO 400:MOVE 30,H:DRAW 610,H,4:NEXT  
3220 FOR H=382 TO 392:MOVE 30,H:DRAW 610,H,8:NEXT:FOR H=378 TO 380:MOVE 30,H:DRAW 610,H,1:NEXT        
3230 X=20:FOR T=1 TO 22:MOVE T,X:DRAW T,20,15:X=X-1:NEXT T  
3240 X=380:FOR T=1 TO 22:MOVE T,X:DRAW T,380:X=X+1:NEXT T   
3250 X=380:FOR T=618 TO 636:MOVE T,380:DRAW 618,X:X=X+1:NEXT T   
3260 X=1:FOR T=618 TO 636:MOVE T,20:DRAW T,X:X=X+1:NEXT T  
3270 PEN 3:LOCATE 3,6:PRINT "L'OMELETTE":PEN 10:LOCATE 7,9:PRINT "INFERNALE" 
3280 WHILE INKEY$="":WEND:INK 1,26:INK 2,13:INK 3,15
3290 MODE 1:LOCATE 11,1:PEN 3:PRINT "L'OMELETTE INFERNALE":LOCATE 11,2:PEN 1:PRINT "===================="  
3300 PEN 2:LOCATE 1,4:PRINT"  FOX,le renard jubile.Il vient de trou-ver un poulailler remplit d'oeufs."  
3310 PEN 2:LOCATE 1,7:PRINT"  Il va falloir qu'il en fasse sortir leplus possible.Le principal {tant qu'a la fin des quatres tableaux ,il en possedeune douzaine."     
3320 LOCATE 1,12:PRINT"  Il devra se m{fier des  gardiens de laferme ,des pierres qui  roulent et de lacasse toujours possible."  
3330 LOCATE 1,16:PRINT"  Les cartons amortissent le d{placementdes oeufs.Les pierres permettent d'{cra-ser les intrus."    
3340 LOCATE 1,20:PRINT"  Le premier tableau comporte 36 oeufs .Dans tous les suivants,vous retrouverez seulement les oeufs qui auront pr{c{dem-ment pass{s la porte."  
3350 LOCATE 20,25:PEN 1:PRINT "<JOYSTICK SEULEMENT>" 
3360 WHILE INKEY$="":WEND:mu=REMAIN(1):RETURN
3370 DI:IF (SQ(1) AND 7)=0 THEN EI:RETURN ELSE READ j,k,l:IF j=-1 THEN RESTORE 3390:GOTO 3370
3380 SOUND 1,j,k,0,l:GOTO 3370
3390 DATA 159,48,1,142,12,1,119,12,1,127,12,1,142,12,1,106,24,1,106,24,1,106,12,1,95,12,1,127,12,1,119,12,1,142,24,1,142,24,1,142,12,1,119,12,1,127,12,1,142,12,1,159,12,1,80,12,1,84,12,1,95,12,1,106,12,1,119,12,1,127,12,1,142,12,1,159,48,1,142,12,1   
3400 DATA 119,12,1,127,12,1,142,12,1,106,24,1,106,24,1,106,12,1,95,12,1,127,12,1,119,12,1,142,24,1,142,24,1,142,12,1,119,12,1,127,12,1,142,12,1,159,12,1,106,12,1,142,12,1,127,12,1,159,24,1,159,24,0,159,48,1,142,12,1,119,12,1,127,12,1,142,12,1,106,24,1   
3410 DATA 106,24,1,106,12,1,95,12,1,127,12,1,119,12,1,142,24,1,142,24,1,142,12,1,119,12,1,127,12,1,142,12,1,159,12,1,80,12,1,84,12,1,95,12,1,106,12,1,119,12,1,127,12,1,142,12,1,159,48,1,142,12,1,119,12,1,127,12,1,142,12,1,106,24,1,106,24,1,106,12,1 
3420 DATA 95,12,1,127,12,1,119,12,1,142,24,1,142,24,1,142,12,1,119,12,1,127,12,1,142,12,1,159,12,1,106,12,1,142,12,1,127,12,1,159,48,1,-1,-1,-1