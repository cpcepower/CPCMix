10 REM :::::::::::::::::::::::
20 REM :                     :
30 REM :    REDEFINITIONS    :
40 REM :                     :
50 REM :::::::::::::::::::::::
60 SYMBOL AFTER 200
70 SYMBOL 221,24,24,60,60,126,126,255,255  
80 SYMBOL 222,60,60,60,60,60,60,60,60 
90 SYMBOL 223,60,60,60,60,60,60,60,60 
100 SYMBOL 224,255,255,126,126,60,60,24,24 
110 SYMBOL 225,16,16,48,48,127,127,255,255 
120 SYMBOL 226,255,255,127,127,48,48,16,16  
130 SYMBOL 227,8,8,12,12,254,254,255,255    
140 SYMBOL 228,255,255,254,254,12,12,8,8  
150 SYMBOL 229,0,117,87,87,85,117,0,0  
160 SYMBOL 230,16,16,0,56,56,56,56,255 
170 SYMBOL 231,127,67,71,79,95,95,95,95  
180 SYMBOL 232,95,87,95,95,95,94,92,24  
190 SYMBOL 233,248,8,28,8,0,255,189,219  
200 SYMBOL 234,231,255,231,255,255,255,255,255 
210 SYMBOL 235,34,39,34,114,34,0,255,189  
220 SYMBOL 236,219,231,255,231,255,255,255,255 
230 SYMBOL 237,119,119,68,0,221,221,17,0  
240 SYMBOL 238,0,136,51,0,0,34,220,0 
250 SYMBOL 239,24,16,8,24,24,16,8,24 
260 SYMBOL 240,24,60,36,36,36,36,36,36
270 SYMBOL 241,36,36,36,36,36,36,38,36
280 SYMBOL 242,60,60,60,60,60,60,60,60
290 MEMORY &8FFF   
300 LOAD "!ENIGME.BIN",&9000 
310 REM ::::::::::::::::::::::: 
320 REM :                     :
330 REM :  VARIABLES DE BASE  :
340 REM :                     :
350 REM :::::::::::::::::::::::
360 MODE 0:RESTORE 370:FOR h=0 TO 15:READ a:INK h,a:NEXT:BORDER 0
370 DATA 0,3,6,16,9,18,13,1,2,11,24,25,26,4,7,8 
380 DEF FN po(x,y)=&C000+(y-1)*80+(x-1)*2      
390 GOSUB 2590:REM PRESENTATION
400 GOSUB 2420:REM EXPLICATIONS
410 FOR h=0 TO 3:sp(h+1)=&9894+(124*h):NEXT:sit=&D35E
420 DIM obj(20):FOR h=0 TO 19:obj(h+1)=&9000+(64*h):NEXT
430 DIM tex$(30):RESTORE 2330:tex=0
440 tex=tex+1:READ tex$(tex):IF tex$(tex)="XX" THEN 450 ELSE 440
450 tr$=CHR$(22)+CHR$(1):nr$=CHR$(22)+CHR$(0)
460 xo$=CHR$(23)+CHR$(1):xr$=CHR$(23)+CHR$(0)  
470 WINDOW #1,2,19,19,18:WINDOW #3,1,18,7,15
480 flo=1:ENT 1,100,2,2:ENV 1,100,3,1
490 DIM eta(50,12):FOR h=1 TO 10  
500 x=INT(RND*50)+1:IF eta(x,1)<>0 THEN 500 ELSE eta(x,1)=h
510 NEXT:FOR h=1 TO 50:IF eta(h,1)=0 THEN 530   
520 FOR g=2 TO 4:x=INT(RND*20)+1:eta(h,g)=x:NEXT g 
530 NEXT h   
540 FOR h=1 TO 50:IF eta(h,1)<>0 THEN 560
550 FOR g=8 TO 10:x=INT(RND*20)+1:eta(h,g)=x:NEXT g 
560 NEXT h  
570 FOR h=1 TO 50:eta(h,11)=1:x=INT(RND*20)+1:eta(h,12)=x:NEXT
580 FOR h=1 TO 12
590 x=INT(RND*50)+1:IF eta(x,1)<>0 THEN 590 ELSE eta(x,8)=1
600 x=INT(RND*50)+1:IF eta(x,1)<>0 THEN 600 ELSE eta(x,9)=1
610 x=INT(RND*50)+1:IF eta(x,1)<>0 THEN 610 ELSE eta(x,10)=1
620 x=INT(RND*50)+1:eta(x,12)=1:x=INT(RND*50)+1:eta(x,12)=1:NEXT
630 REM ::::::::::::::::::::::: 
640 REM :                     : 
650 REM :   DESSIN DU DECOR   :
660 REM :                     :
670 REM :::::::::::::::::::::::
680 PLOT -10,1,10:TAG:FOR h=272 TO 400 STEP 16:MOVE 592,h:PRINT CHR$(239);:NEXT:TAGOFF  
690 PEN 10:LOCATE 19,9:PRINT CHR$(214)+CHR$(215):FOR h=10 TO 14:LOCATE 20,h:PRINT CHR$(209):NEXT:LOCATE 19,15:PRINT CHR$(131)+CHR$(131) 
700 PLOT -10,-10,5:TAG:x=1:FOR h=12 TO 640 STEP 40:ORIGIN h,40:MOVE h,16:PRINT CHR$(220+x);:x=x+1:MOVE h,0:PRINT CHR$(220+x);:x=x+1   
710 NEXT:TAGOFF:ORIGIN 0,0
720 DATA 1,17,20,1,20,20,1,2,17,1,5,17,1,17,4,20,17,4,1,2,4,17,2,4  
730 e1=2:e2=15:RESTORE 720:FOR i=1 TO 8:GOSUB 740:NEXT:GOTO 820
740 READ X,Y,L:x1=14+(X-1)*32:y1=388-(Y-1)*16   
750 IF i>4 THEN 790    
760 FOR J=0 TO 2 STEP 2:PLOT x1,y1+j,e1:DRAW x1+4+(l-1)*32,y1+j:NEXT 
770 FOR J=4 TO 6 STEP 2:PLOT x1,y1+j,e2:DRAW x1+4+(l-1)*32,y1+j:NEXT  
780 RETURN   
790 PLOT x1+4,y1+2,e1:DRAW x1+4,y1+2-(l-1)*16 
800 PLOT x1,y1+2,e2:DRAW x1,y1+2-(l-1)*16   
810 RETURN  
820 LOCATE 1,1:PRINT tr$:FOR h=1 TO 18:PEN 6:LOCATE h,7:PRINT CHR$(237):LOCATE h,15:PRINT CHR$(237) 
830 PEN 2:LOCATE h,7:PRINT CHR$(238):LOCATE h,15:PRINT CHR$(238):NEXT:PRINT nr$
840 FOR h=8 TO 14:LOCATE 1,h:PRINT CHR$ (133):NEXT:PEN 6:FOR h=8 TO 10:LOCATE 12,h:PRINT CHR$(149):NEXT
850 IF eta(flo,1)<>0 THEN PLOT 14,212,10:DRAW 48,212:PLOT 14,248:DRAW 48,248 
860 eta(1,11)=0:GOSUB 2230:IF as=1 THEN RETURN 
870 eta(1,11)=0
880 REM :::::::::::::::::::::::
890 REM :                     : 
900 REM :  ROUTINE PRINCIPALE :   
910 REM :                     :
920 REM ::::::::::::::::::::::: 
930 CALL &A103,sit,sp(4):act=4:x=31
940 IF INKEY(GA)=0 AND x>nin THEN 990
950 IF INKEY(DA)=0 AND x<34 THEN 1060 
960 IF INKEY(BA)=0 THEN CLS #1:GOTO 1170  
970 GOTO 940  
980 REM :::  vers la GAUCHE  :::   
990 CALL &A103,sit,sp(act):sit=sit-1  
1000 CALL &A103,sit,sp(3):FOR t=1 TO 50:NEXT 
1010 CALL &A103,sit,sp(3):sit=sit-1
1020 CALL &A103,sit,sp(4):FOR t=1 TO 50:NEXT   
1030 SOUND 1,300,5,1,1,1,15
1040 act=4:x=x-1:IF as=1 THEN RETURN ELSE 940
1050 REM :::  vers la DROITE  ::: 
1060 CALL &A103,sit,sp(act):sit=sit+1
1070 CALL &A103,sit,sp(1):FOR t=1 TO 50:NEXT  
1080 CALL &A103,sit,sp(1):sit=sit+1
1090 CALL &A103,sit,sp(2):FOR t=1 TO 50:NEXT
1100 SOUND 1,300,5,1,1,1,15  
1110 act=2:x=x+1:IF as=1 THEN RETURN ELSE 940 
1120 REM ::::::::::::::::::::::: 
1130 REM :                     : 
1140 REM :   ACTIONS  ICONES   :
1150 REM :                     : 
1160 REM :::::::::::::::::::::::
1170 LOCATE 1,1:PRINT xo$:sx=18:GOSUB 1230:op=1
1180 IF INKEY(GA)=0 THEN op=op-1:GOTO 1240  
1190 IF INKEY(DA)=0 THEN op=op+1:GOTO 1260  
1200 IF INKEY(FE)=0 THEN 1290     
1210 IF INKEY(HA)=0 AND as=0 THEN CLS #1:GOTO 1280  
1220 GOTO 1180
1230 PLOT sx,64,2:DRAW sx+48,64:DRAW sx+48,16:DRAW sx,16:DRAW sx,64:RETURN
1240 GOSUB 1230:sx=sx-80:IF op=0 THEN op=8:sx=578
1250 GOSUB 1230:FOR t=1 TO 100:NEXT:GOTO 1180
1260 GOSUB 1230:sx=sx+80:IF op=9 THEN op=1:sx=18
1270 GOSUB 1230:FOR t=1 TO 100:NEXT:GOTO 1180  
1280 GOSUB 1230:LOCATE 1,1:PRINT xr$:GOTO 940
1290 ON op GOTO 1300,1350,1400,1430,1470,1700,1800,1970
1300 IF as=0 THEN LOCATE 1,1:PRINT CHR$(7):PH$=TEX$(1):GOSUB 2180:GOTO 1180
1310 IF flo=50 THEN LOCATE 1,1:PRINT CHR$(7):PH$=TEX$(3):GOSUB 2180:GOTO 1180
1320 LOCATE 11,12:PEN 0:PRINT CHR$(143)+CHR$(143)
1330 flo=flo+1:ph$=STR$(flo):lx=21:ly=12:GOSUB 2190
1340 FOR t=1 TO 100:NEXT:GOTO 1180  
1350 IF as=0 THEN LOCATE 1,1:PRINT CHR$(7):PH$=TEX$(1):GOSUB 2180:GOTO 1180
1360 IF flo=1 THEN LOCATE 1,1:PRINT CHR$(7):PH$=TEX$(4):GOSUB 2180:GOTO 1180
1370 LOCATE 11,12:PEN 0:PRINT CHR$(143)+CHR$(143) 
1380 flo=flo-1:ph$=STR$(flo):lx=21:ly=12:GOSUB 2190
1390 FOR t=1 TO 100:NEXT:GOTO 1180 
1400 IF as=0 THEN LOCATE 1,1:PRINT CHR$(7):PH$=TEX$(1):GOSUB 2180:GOTO 1180    
1410 CLS #3:GOSUB 820:FOR h=36 TO 31 STEP -1:GOSUB 990:NEXT
1420 as=0:GOSUB 1230:CLS #1:GOTO 940  
1430 IF as=1 THEN LOCATE 1,1:PRINT CHR$(7):GOTO 1180 ELSE as=1  
1440 FOR h=x TO 36:GOSUB 1060:NEXT:CALL &A103,sit,sp(act) 
1450 CALL &A103,sit,sp(4):act=4:CLS #3:ph$="ETAGE":lx=15:ly=12
1460 GOSUB 2190:ph$=STR$(flo):lx=21:ly=12:GOSUB 2190:GOTO 1180 
1470 IF as=1 THEN LOCATE 1,1:PRINT CHR$(7):PH$=TEX$(14):GOSUB 2180:GOTO 1180
1480 IF x<>11 OR eta(flo,1)=0 THEN ph$=tex$(12):GOSUB 2180:GOSUB 1230:GOTO 940
1490 IF eta(flo,5)=0 THEN 1500 ELSE 1530
1500 sac=0:FOR h=1 TO 7:IF poch(h)=eta(flo,2) THEN sac=h
1510 NEXT:IF sac=0 THEN 1530 ELSE eta(flo,5)=poch(sac)
1520 pose=&C0A0+(sac*8):ob=poch(sac):CALL &A113,pose,obj(ob):poch(sac)=0
1530 IF eta(flo,6)=0 THEN 1540 ELSE 1570
1540 sac=0:FOR h=1 TO 7:IF poch(h)=eta(flo,3) THEN sac=h 
1550 NEXT:IF sac=0 THEN 1570 ELSE eta(flo,6)=poch(sac)  
1560 pose=&C0A0+(sac*8):ob=poch(sac):CALL &A113,pose,obj(ob):poch(sac)=0 
1570 IF eta(flo,7)=0 THEN 1580 ELSE 1610
1580 sac=0:FOR h=1 TO 7:IF poch(h)=eta(flo,4) THEN sac=h
1590 NEXT:IF sac=0 THEN 1610 ELSE eta(flo,7)=poch(sac)    
1600 pose=&C0A0+(sac*8):ob=poch(sac):CALL &A113,pose,obj(ob):poch(sac)=0
1610 POKE &A034,eta(flo,5):POKE &A035,eta(flo,6):POKE &A036,eta(flo,7) 
1620 POKE &A024,0:POKE &A0F2,&C9:CALL &A06D:POKE &A0F2,&3A
1630 EVERY 5,1 GOSUB 2310:mq=0:FOR h=5 TO 7:IF eta(flo,h)=0 THEN mq=mq+1
1640 IF eta(flo,h)=0 THEN manq=manq+1
1650 NEXT:GOSUB 2300:IF mq=0 THEN 1680 ELSE ph$=tex$(13):GOSUB 2180  
1660 IF mq>1 THEN ph$=STR$(mq)+" OBJETS:":GOSUB 2180 ELSE ph$=STR$(mq)+" OBJET:":GOSUB 2180
1670 A$=INKEY$:IF A$="" THEN 1670 ELSE MU=REMAIN(1):POKE &A024,&AE:GOSUB 1230:GOTO 940 
1680 MU=REMAIN(1):GOSUB 2080:EVERY 5,1 GOSUB 2310
1690 GOTO 1670 
1700 IF as=1 THEN LOCATE 1,1:PRINT CHR$(7):PH$=TEX$(14):GOSUB 2180:GOTO 1180 
1710 IF ETA(FLO,11)=0 THEN PH$=TEX$(5):GOSUB 2180:PH$=TEX$(6):GOSUB 2180:GOTO 1180   
1720 IF x<>24 THEN PH$=TEX$(16):GOSUB 2180:GOSUB 1230:GOTO 940
1730 CLEF=0:FOR H=1 TO 7:IF POCH(H)=1 THEN CLEF=H  
1740 NEXT:IF CLEF=0 THEN PH$=TEX$(7):GOSUB 2180:GOTO 1180
1750 PH$=TEX$(8):GOSUB 2180:FOR t=1 TO 400:NEXT:SOUND 1,2056,60,15 
1760 POSE=&C0A0+(CLEF*8):CALL &A113,pose,obj(1) 
1770 PEN 0:FOR h=11 TO 14:LOCATE 12,h:PRINT CHR$(143):NEXT   
1780 IF ETA(FLO,1)=0 THEN NIN=1 ELSE NIN=11
1790 ETA(FLO,11)=0:POCH(CLEF)=0:GOSUB 1230:CLS #1:GOTO 940 
1800 IF as=1 THEN LOCATE 1,1:PRINT CHR$(7):PH$=TEX$(14):GOSUB 2180:GOTO 1180 
1810 IF act=2 THEN 1860 
1820 IF x=9 AND eta(flo,8)<>0 THEN ote=&C3CE:pla=8:GOTO 1920  
1830 IF x=12 AND eta(flo,9)<>0 THEN ote=&C3D4:pla=9:GOTO 1920   
1840 IF x=15 AND eta(flo,10)<>0 THEN ote=&C3DA:pla=10:GOTO 1920
1850 IF x=27 AND eta(flo,12)<>0 THEN ote=&C3F2:pla=12:GOTO 1920
1860 IF x=5 AND eta(flo,8)<>0 THEN ote=&C3CE:pla=8:GOTO 1920 
1870 IF x=8 AND eta(flo,9)<>0 THEN ote=&C3D4:pla=9:GOTO 1920 
1880 IF x=11 AND eta(flo,10)<>0 THEN ote=&C3DA:pla=10:GOTO 1920 
1890 IF x=23 AND eta(flo,12)<>0 THEN ote=&C3F2:pla=12:GOTO 1920 
1900 IF cha=1 THEN RETURN
1910 LOCATE 1,1:PRINT CHR$(7):PH$=TEX$(9):GOSUB 2180:GOTO 1180
1920 IF cha=1 THEN fla=1:RETURN ELSE ob=eta(flo,pla):CALL &A113,ote,obj(ob):sac=0:pose=&C0A0
1930 SOUND 2,300,2,6:sac=sac+1:pose=pose+8:IF sac=8 THEN 1960  
1940 IF poch(sac)<>0 THEN 1930 ELSE CALL &A113,pose,obj(ob)
1950 poch(sac)=ob:eta(flo,pla)=0:GOSUB 1230:GOTO 940 
1960 CALL &A113,ote,obj(ob):LOCATE 1,1:PRINT CHR$(7):PH$=TEX$(2):GOSUB 2180:GOSUB 1230:GOTO 940
1970 IF as=1 THEN LOCATE 1,1:PRINT CHR$(7):PH$=TEX$(14):GOSUB 2180:GOTO 1180 
1980 cha=1:fla=0:GOSUB 1810:cha=0:IF fla=1 THEN 2000 
1990 LOCATE 1,1:PRINT CHR$(7):PH$=TEX$(9):GOSUB 2180:GOTO 1180 
2000 PH$=TEX$(10):GOSUB 2180:GOSUB 2300
2010 A$=INKEY$:IF A$="" THEN 2010 ELSE A=ASC(A$)
2020 IF A<49 OR A>55 THEN CLS #1:GOTO 2000 ELSE A=A-48
2030 IF POCH(A)=0 THEN PH$=TEX$(11):GOSUB 2180:GOSUB 1230:GOTO 940
2040 POSE=&C0A0+(A*8):OB=POCH(A):CALL &A113,POSE,OBJ(ob)
2050 ob1=eta(flo,pla):CALL &A113,ote,obj(ob1):SOUND 2,300,2,6
2060 CALL &A113,POSE,OBJ(ob1):CALL &A113,ote,obj(ob)
2070 eta(flo,pla)=ob:poch(a)=ob1:CLS#1:GOSUB 1230:GOTO 940
2080 PH$=TEX$(15):GOSUB 2180
2090 DEB=ETA(FLO,1):DEB=((DEB-1)*40)+&9BA0:A$="":FOR H=0 TO 35
2100 A=PEEK(DEB+H):A$=A$+CHR$(A-(h+1)):NEXT:PH$=LEFT$(a$,35):GOSUB 2180 
2110 PEN 2:RETURN 
2120 REM ::::::::::::::::::::::: 
2130 REM :                     : 
2140 REM :  SOUS PROG  DIVERS  :
2150 REM :                     :
2160 REM :::::::::::::::::::::::
2170 REM ::: afficher texte :::
2180 LOCATE #1,18,2:PRINT #1,CHR$(10):LX=3:LY=19
2190 ph$=UPPER$(ph$):FOR t=1 TO LEN(ph$):al=(ASC(MID$(PH$,t,1)))-48  
2200 SOUND 1,1,2,15,0,0,1:IF al=-16 THEN al=16
2210 CALL &9FE0,FN po(lx,ly)+(t*2),&9D30+(al*16):NEXT:RETURN   
2220 REM ::: contenu  etage :::
2230 POKE &A033,eta(flo,1):POKE &A034,eta(flo,5):POKE &A035,eta(flo,6) 
2240 POKE &A036,eta(flo,7):POKE &A037,eta(flo,8):POKE &A038,eta(flo,9)
2250 POKE &A039,eta(flo,10):POKE &A03A,eta(flo,12):CALL &A03B
2260 IF eta(flo,1)<>0 THEN NIN=11 ELSE NIN=1 
2270 IF eta(flo,11)=0 THEN RETURN  
2280 PEN 12:FOR h=11 TO 13:LOCATE 12,h:PRINT CHR$(229+h):NEXT:LOCATE 12,14:PRINT CHR$(242):nIN=24:RETURN
2290 REM ::::  divers ::::
2300 WHILE INKEY$<>"":WEND:RETURN
2310 DI:IF PEEK(&9AB0)=0 THEN POKE &9AB0,1:CALL &9A90,&9500:EI:RETURN
2320 POKE &9AB0,0:CALL &9A90,&969A:EI:RETURN 
2330 DATA "VOUS N ETES PAS DANS L ASCENCEUR::","DESOLE;PLUS DE PLACE:::","IMPOSSIBLE D ALLER PLUS HAUT <","IMPOSSIBLE D ALLER PLUS BAS <"
2340 DATA "ENFONCER UNE PORTE OUVERTE >","ALLONS:::RESTONS SERIEUX <","TROUVEZ UNE CLEE POUR L OUVRIR:","SESAME : : : OUVRE TOI <" 
2350 DATA "PAS D OBJET A PORTE DE MAINS:","ECHANGE OK : VOTRE CHOIX >   1 A 7","IL N Y A RIEN A ECHANGER <<<","OU AVEZ VOUS VU UN INTERRUPTEUR >"
2360 DATA "DESOLE IL VOUS  MANQUE ENCORE::::","SORTEZ D ABORD DE L ASCENSEUR:::","VOICI UN ELEMENT DE L ENIGME::::","VOUS N ETES PAS ASSEZ PRES:","XX"
2370 REM :::::::::::::::::::::::
2380 REM :                     : 
2390 REM :    EXPLICATIONS     :
2400 REM :                     : 
2410 REM ::::::::::::::::::::::: 
2420 CLS:ph$="50 ETAGES A VISITER:20 OBJETS DIFFERENTS":LX=0:LY=2:GOSUB 2190
2430 ph$="10 GRANDS ORDINATEURS QUI? CHACUN CONTRE":LY=4:GOSUB 2190
2440 ph$="3 CADEAUX VOUS LIVRERONT LEUR SECRET:":LY=6:GOSUB 2190 
2450 ph$="CES DIX ELEMENTS FORMENT L ENIGME:A VOUS":LY=8:GOSUB 2190 
2460 ph$="DE LA RESOUDRE POUR ENFIN SAVOIR QUI EST":LY=10:GOSUB 2190  
2470 ph$="E N I G M A":LX=14:LY=13:GOSUB 2190:ph$="1  JOYSTICK"  
2480 LY=21:GOSUB 2190:ph$="2  CURSEURS":LY=24:GOSUB 2190
2490 A$=INKEY$:IF A$="" THEN 2490
2500 A=ASC(A$):IF A<49 OR A>50 THEN 2490 ELSE CLS
2510 IF A=49 THEN GA=74:DA=75:HA=72:BA=73:FE=76:RETURN
2520 IF A=50 THEN GA=8:DA=1:HA=0:BA=2:FE=9:RETURN ELSE 2490
2530 REM :::::::::::::::::::::::
2540 REM :                     :
2550 REM :    PRESENTATION     :
2560 REM :                     :  
2570 REM :::::::::::::::::::::::
2580 REM les faineants peuvent eviter de taper ce sous programme.Dans ce cas ils oterons le GOSUB PRESENTATION apres l'initialisation des couleurs dans le s/p VARIABLES DE BASE
2590 PH$="AMI;VEUX TU VOIR LA PRESENTATION >":LX=INT(40-LEN(PH$))/2:LY=12:GOSUB 2190  
2600 PH$=": OUI : NON :":LX=INT(40-LEN(PH$))/2:LY=14:GOSUB 2190 
2610 A$=INKEY$:IF A$="" THEN 2610 ELSE A$=UPPER$(A$)
2620 IF A$="O" THEN CLS:GOTO 2640
2630 IF A$="N" THEN CLS:RETURN ELSE 2610
2640 ENV 4,1,12,1,1,0,1,1,0,1,12,-1,8:ENT -3,1,1,3,1,-1,3,1,0,1,1,1,3,1,-1,3
2650 FOR i=1 TO 4:SOUND 130,0,50,0,4,3,1:FOR l=1 TO 400:NEXT l,i  
2660 RESTORE 3150:EVERY 25,2 GOSUB 3130 
2670 FOR J=1 TO 8:A$="?":X=INT(RND*200)+30:Y=INT(RND*260)+30   
2680 ENC=INT(RND*15)+1:EN2=ENC:IF ENC=3 THEN 2680
2690 GOSUB 3060:X=INT(RND*280)+280:Y=INT(RND*260)+30   
2700 ENC=INT(RND*15)+1:EN2=ENC:IF ENC=3 THEN 2700
2710 GOSUB 3060:NEXT 
2720 zc=320:zd=-24:za=80:zb=250:enc=3:GOSUB 2880 
2730 y1=24:y2=224:xl=320:GOSUB 2920  
2740 zc=290:zd=36:za=16:zb=50:enc=12:GOSUB 2880  
2750 zc=350:zd=36:za=16:zb=50:enc=12:GOSUB 2880  
2760 y1=24:y2=82:xl=291:GOSUB 2920:xl=351:GOSUB 2920 
2770 PEN 0:LOCATE 9,19:PRINT CHR$(22)+CHR$(1)+CHR$(194)+CHR$(195)+CHR$(194)+CHR$(195)+CHR$(22)+CHR$(0)
2780 zc=290:zd=24:za=8:zb=30:enc=0:GOSUB 2880:zc=350:zd=24:za=8:zb=30:GOSUB 2880
2790 y1=24:y2=50:xl=291:enc=0:GOSUB 2920:xl=351:GOSUB 2920:GOSUB 2960   
2800 FOR h=128 TO 178 STEP 16:zc=h:zd=30:za=8:zb=20:enc=3:GOSUB 2880:NEXT
2810 FOR h=464 TO 512 STEP 16:zc=h:zd=30:za=8:zb=20:GOSUB 2880:NEXT
2820 FOR g=128 TO 178 STEP 16:xl=g:y1=12:y2=48:GOSUB 2920:NEXT
2830 FOR g=464 TO 512 STEP 16:xl=g:y1=12:y2=48:GOSUB 2920:NEXT
2840 A$="E N I G M A":ENC=2:EN2=5:Y=320:X=94:GOSUB 3060  
2850 A$="?":X=278:Y=220:ENC=3:EN2=3:GOSUB 3060  
2860 ph$="LMC SOFTWARE":LX=2:LY=21:GOSUB 2190   
2870 a$=INKEY$:IF a$="" THEN 2870 ELSE mu=REMAIN(2):CLS:RETURN  
2880 PLOT -10,-10,enc:ORIGIN zc,zd:zf=2/SQR(za*za+zb*zb):zf1=zf*za/zb
2890 zf2=zf*zb/za:zc=za:zd=0:zim=1+PI/zf/2:FOR zi=0 TO zim:PLOT zc,zd
2900 PLOT zc,-zd:PLOT -zc,zd:PLOT -zc,-zd:zc=zc-zf1*zd:zd=zd+zf2*zc
2910 NEXT zi:ORIGIN 0,0:RETURN 
2920 FOR h=y1 TO y2 STEP 2:x=xl:x1=x  
2930 IF TEST(x,h)=enc THEN x=x1-4:GOTO 2940 ELSE PLOT x,h,enc:x=x+4:GOTO 2930 
2940 IF TEST(x,h)=enc THEN 2950 ELSE PLOT x,h,enc:x=x-4:GOTO 2940
2950 NEXT:RETURN
2960 FOR H=1 TO 5:MOVE 30,H:DRAW 610,H,8:NEXT:FOR H=6 TO 20:MOVE 30,H:DRAW 610,H,2:NEXT   
2970 FOR H=20 TO 22:MOVE 30,H:DRAW 610,H,10:NEXT:FOR H=1 TO 8:MOVE H,26:DRAW H,374,8:NEXT    
2980 FOR H=8 TO 20:MOVE H,26:DRAW H,374,2:NEXT:FOR H=20 TO 22:MOVE H,26:DRAW H,374,10:NEXT    
2990 FOR H=616 TO 620:MOVE H,26:DRAW H,374,10:NEXT:FOR H=620 TO 632:MOVE H,26:DRAW H,374,2:NEXT    
3000 FOR H=632 TO 636:MOVE H,26:DRAW H,374,8:NEXT:FOR H=394 TO 400:MOVE 30,H:DRAW 610,H,8:NEXT   
3010 FOR H=382 TO 392:MOVE 30,H:DRAW 610,H,2:NEXT:FOR H=378 TO 380:MOVE 30,H:DRAW 610,H,10:NEXT  
3020 X=20:FOR T=1 TO 22:MOVE T,X:DRAW T,20,8:X=X-1:NEXT T
3030 X=380:FOR T=1 TO 22:MOVE T,X:DRAW T,380:X=X+1:NEXT T  
3040 X=380:FOR T=618 TO 636:MOVE T,380:DRAW 618,X:X=X+1:NEXT T 
3050 X=1:FOR T=618 TO 636:MOVE T,20:DRAW T,X:X=X+1:NEXT T:RETURN 
3060 INK 4,0:PLOT -10,-10,4:TAG:FOR H=1 TO LEN(A$):B$=MID$(A$,H,1)
3070 MOVE (H*36)-4,366:PRINT B$;:NEXT:TAGOFF  
3080 FOR G=0 TO 14 STEP 2:FOR H=32 TO LEN(A$)*64 STEP 4   
3090 IF TEST(H,354+G)=4 THEN GOSUB 3110     
3100 NEXT H,G:LOCATE 2,3:PRINT NR$;SPACE$(INT(LEN(A$)*1.5)):INK 4,9:RETURN
3110 PLOT H+X,Y+(G*2),ENC:PLOT H+X,Y+2+(G*2),EN2:RETURN 
3120 CALL &BB18:MODE 2:PEN 1:LIST
3130 DI:IF (SQ(1) AND 7)=0 THEN EI:RETURN ELSE READ n,d:IF n=-1 THEN RESTORE 3150:GOTO 3130
3140 SOUND 1,n,d/1.5,12:GOTO 3130
3150 DATA 142,20,190,20,142,20,119,20,127,20,119,20,142,60,179,20,142,20,119,20,127,20,119,20,142,60,179,20,142,20,106,20,119,20,106,20,142,60,190,20,142,20,119,20,127,20,142,20,127,20
3160 DATA 190,20,150,20,127,20,142,20,150,20
3170 DATA 142,20,190,20,142,20,119,20,127,20,119,20,142,60,179,20,142,20,119,20,127,20,119,20,142,60,179,20,142,20,106,20,119,20,106,20,142,60,190,20,142,20,119,20,127,20,142,20,127,20,190,20,150,20,127,20,142,20,150,20
3180 DATA 142,20,190,20,142,20,119,20,127,20,119,20,142,20,190,20,142,20,119,20,127,20,119,20,142,20,179,20,142,20,119,20,127,20,119,20,142,20,179,20,142,20,119,20,127,20,119,20,142,20,179,20,142,20
3190 DATA 106,20,119,20,106,20,142,20,179,20,142,20,106,20,119,20,127,20,119,20,190,20,142,20,119,20,127,20,142,20,127,20,190,20,150,20,127,20,142,20,150,20,142,20
3200 DATA 190,20,142,20,119,20,127,20,119,20,142,20,190,20,142,20,119,20,127,20,119,20,142,20,179,20,142,20,119,20,127,20,119,20,142,20,179,20,142,20,119,20,127,20,119,20,142,20,179,20,142,20
3210 DATA 106,20,119,20,106,20,142,20,179,20,142,20,106,20,119,20,127,20,119,20,190,20,142,20,119,20,127,20,142,20,127,20,190,20,150,20,127,20,142,20,127,20
3220 DATA 119,20,159,20,119,20,94,20,106,20,94,20,119,20,159,20,119,20,94,20,106,20,119,20,106,20,159,20,126,20,106,20,119,20,106,20,127,20,159,20,126,20,106,20,119,20,106,20,89,20,142,20,127,20,89,20,94,20,89,20,106,20
3230 DATA 119,20,106,20,89,20,94,20,106,20,94,20,106,20,119,20,126,20,119,20,126,20,142,20,159,20,142,20,126,20,119,20,106,20
3240 DATA 119,20,159,20,119,20,94,20,106,20,94,20,119,20,159,20,119,20,94,20,106,20,119,20,106,20,159,20,126,20,106,20,119,20,106,20,127,20,159,20,126,20,106,20,119,20,106,20,89,20,142,20,127,20,89,20,94,20,89,20,106,20
3250 DATA 119,20,106,20,89,20,94,20,106,20,94,20,106,20,119,20,126,20,119,20,126,20,142,20,159,20,142,20,126,20,119,20,106,20,119,20
3260 DATA -1,-1