; Music of Shadows Demo (1993)(OdieSoft)(OdieSoft)(ST-Module)
; Ripped by Megachur the 04/01/2021
; $VER 1.5

IFDEF FILENAME_WRITE
	write "SHADOWSD.BIN"
ENDIF

MUSIC_DATE_RIP_DAY		equ 04
MUSIC_DATE_RIP_MONTH	equ 01
MUSIC_DATE_RIP_YEAR		equ 2021
music_adr				equ #043b

	read "music_header.asm"

	jp l0446
	jp l04ce
	jp l04b2
	db #66,#04
;
.init_music
.l0446
;
	ld b,#03
	ld ix,l0815
	ld iy,l0741
	ld de,#001c
.l0453
	push bc
	ld (ix+#06),#01
	ld (ix+#09),d
	ld (ix+#1b),d
	ld (ix+#05),#10
	ld l,(iy+#00)
	ld h,(iy+#01)
	ld a,(hl)
	ld (ix+#08),a
	inc hl
	ld c,(hl)
	inc hl
	ld b,(hl)
	inc hl
	ld (ix+#0c),l
	ld (ix+#0d),h
	ld (ix+#00),c
	ld (ix+#01),b
	add ix,de
	inc iy
	inc iy
	pop bc
	djnz l0453
	ld a,#06
	ld (l04f6),a
	ld a,d
	ld (l050a),a
	inc a
	ld (l04f1),a
	ld a,#38
	ld (l04fb),a
	ld a,#ff
	ld (l073d),a
	ld (l073e),a
	ld (l073f),a
	ld (l0740),a
	ld a,#0c
	ld c,d
	call l071f
	ld a,#0d
	ld c,d
	jp l071f
;
.stop_music
.l04b2
;
	ld a,#07
	ld c,#3f
	call l071f
	ld a,#08
	ld c,#00
	call l071f
	ld a,#09
	ld c,#00
	call l071f
	ld a,#0a
	ld c,#00
	jp l071f
;
.play_music
.l04ce
;
	ld hl,l04f1
	dec (hl)
	ld ix,l0815
	ld bc,l0823
	call l0584
	ld ix,l0831
	ld bc,l083f
	call l0584
	ld ix,l084d
	ld bc,l085b
	call l0584
.l04f1 equ $ + 1
	ld a,#00
	or a
	jr nz,l04fa
.l04f6 equ $ + 1
	ld a,#00
	ld (l04f1),a
.l04fb equ $ + 1
.l04fa
	ld a,#00
	ld hl,l073e
	cp (hl)
	jr z,l0509
	ld (hl),a
	ld c,a
	ld a,#07
	call l071f
.l050a equ $ + 1
.l0509
	ld a,#00
	ld hl,l073d
	cp (hl)
	jr z,l0518
	ld (hl),a
	ld c,a
	ld a,#06
	call l071f
.l0519 equ $ + 1
.l0518
	ld a,#00
	ld hl,l073f
	cp (hl)
	jr z,l0527
	ld (hl),a
	ld c,a
	ld a,#0b
	call l071f
.l0528 equ $ + 1
.l0527
	ld a,#00
	ld hl,l0740
	cp (hl)
	ret z
	ld (hl),a
	ld c,a
	ld a,#0d
	jp l071f
.l0535
	inc hl
	ld b,(hl)
	ld (ix+#06),b
	inc hl
	ld (ix+#00),l
	ld (ix+#01),h
	jp l0635
.l0544
	inc hl
	ld a,(hl)
	ld (ix+#06),a
	inc hl
	ld (ix+#00),l
	ld (ix+#01),h
	xor a
	ld (ix+#17),a
	ld (ix+#15),a
	ld c,a
	ld a,(ix+#04)
	jp l071f
.l055e
	ld (ix+#0a),#00
	ld l,(ix+#0c)
	ld h,(ix+#0d)
	ld a,(hl)
	cp #80
	jr nz,l0573
	inc hl
	ld e,(hl)
	inc hl
	ld d,(hl)
	ex de,hl
	ld a,(hl)
.l0573
	inc hl
	ld e,(hl)
	inc hl
	ld d,(hl)
	inc hl
	ld (ix+#0c),l
	ld (ix+#0d),h
	ld (ix+#08),a
	ex de,hl
	jr l0597
.l0584
	ld a,(l04f1)
	or a
	jp nz,l0635
	dec (ix+#06)
	jp nz,l0635
	ld l,(ix+#00)
	ld h,(ix+#01)
.l0597
	ld a,(hl)
	or a
	jr z,l0535
	cp #fe
	jr z,l0544
	cp #ff
	jr z,l055e
	ld d,#00
	and #7f
	sub #0a
	add (ix+#08)
	ld (ix+#07),a
	add a
	ld e,a
	push hl
	ld hl,l0747
	add hl,de
	ld a,(hl)
	ld (ix+#18),a
	inc hl
	ld a,(hl)
	ld (ix+#19),a
	pop hl
	ld a,#01
	bit 7,(hl)
	jr nz,l05d3
	inc hl
	ld a,(hl)
	bit 7,a
	jr z,l05d3
	and #7f
	ld (ix+#06),a
	jr l0626
.l05d3
	ld (ix+#06),a
	inc hl
	push hl
	ld a,(hl)
	push af
	and #0f
	cp (ix+#05)
	jr z,l05e7
	ld (ix+#05),a
	ld (ix+#0a),d
.l05e7
	add a
	add a
	add a
	ld e,a
	ld hl,l087d
	add hl,de
	ld d,b
	ld e,c
	ldi
	ldi
	ldi
	ldi
	ldi
	ldi
	ldi
	ldi
	pop af
	pop hl
	and #f0
	jr z,l0626
	cp #f0
	jp z,l06db
	cp #d0
	jp z,l06f7
	cp #b0
	jp z,l06ff
	cp #80
	jp nc,l0707
	cp #10
	jr nz,l0626
	xor a
	ld (ix+#1b),a
	ld (ix+#09),a
.l0626
	inc hl
	ld (ix+#00),l
	ld (ix+#01),h
	ld (ix+#16),#00
	ld (ix+#17),#20
.l0635
	ld a,(ix+#17)
	or a
	jr nz,l0649
	ld a,(ix+#15)
	or a
	ret z
	ld (ix+#17),a
	ld a,(ix+#14)
	ld (ix+#16),a
.l0649
	ld d,#00
	ld e,(ix+#16)
	inc (ix+#16)
	dec (ix+#17)
	ld a,(ix+#1b)
	or a
	jr z,l0674
	ld h,a
	ld l,(ix+#1a)
	add hl,de
	ld a,(hl)
	ld b,(ix+#07)
	add b
	add a
	ld b,d
	ld c,a
	ld hl,l0747
	add hl,bc
	ld a,(hl)
	ld (ix+#18),a
	inc hl
	ld a,(hl)
	ld (ix+#19),a
.l0674
	ld h,(ix+#0f)
	ld l,(ix+#0e)
	add hl,de
	add hl,de
	ld c,(hl)
	inc hl
	ld b,(hl)
	ld l,(ix+#18)
	ld h,(ix+#19)
	add hl,bc
	ld c,l
	ld a,(ix+#02)
	call l071f
	ld c,h
	ld a,(ix+#03)
	call l071f
	ld h,(ix+#11)
	ld l,(ix+#10)
	add hl,de
	ld a,(hl)
	bit 7,a
	jr nz,l06b2
	and #0f
	sub (ix+#0a)
	jr nc,l06a8
	xor a
.l06a8
	or (ix+#09)
	ld c,a
	ld a,(ix+#04)
	call l071f
.l06b2
	ld l,(ix+#12)
	ld h,(ix+#13)
	add hl,de
	ld a,(hl)
	bit 7,a
	ret nz
	and #1f
	ld b,(ix+#0b)
	ld c,a
	or a
	ld a,b
	jr z,l06cf
	ld b,a
	ld a,c
	ld (l050a),a
	ld a,b
	sub #40
.l06cf
	ld (l06d6),a
	ld a,(l04fb)
.l06d6 equ $ + 1
	bit 0,a
	ld (l04fb),a
	ret
.l06db
	inc hl
	ld a,(hl)
	push hl
	add a
	ld b,#00
	ld c,a
	ld hl,l08fd
	add hl,bc
	ld e,(hl)
	inc hl
	ld d,(hl)
	ld (ix+#1a),e
	ld (ix+#1b),d
	ld (ix+#09),#00
	pop hl
	jp l0626
.l06f7
	inc hl
	ld a,(hl)
	ld (l04f6),a
	jp l0626
.l06ff
	inc hl
	ld a,(hl)
	ld (ix+#0a),a
	jp l0626
.l0707
	ld (ix+#09),#10
	ld (ix+#1b),#00
	ld a,(hl)
	rrca
	rrca
	rrca
	rrca
	ld (l0528),a
	inc hl
	ld a,(hl)
	ld (l0519),a
	jp l0626
.l071f
	ld b,#f4
	out (c),a
	ld b,#f6
	in a,(c)
	or #c0
	out (c),a
	and #3f
	out (c),a
	ld b,#f4
	out (c),c
	ld b,#f6
	ld c,a
	or #80
	out (c),a
	out (c),c
	ret
.l0740 equ $ + 3
.l073f equ $ + 2
.l073e equ $ + 1
.l073d
	db #ff,#ff,#ff,#ff
.l0741
	dw l0b5d,l0b7e,l0b9f
.l0747
	db #ee,#0e,#18,#0e,#4d,#0d,#8e,#0c
	db #da,#0b,#2f,#0b,#8f,#0a,#f7,#09
	db #68,#09,#e1,#08,#61,#08,#e9,#07
	db #77,#07,#0c,#07,#a7,#06,#47,#06
	db #ed,#05,#98,#05,#47,#05,#fc,#04
	db #b4,#04,#70,#04,#31,#04,#f4,#03
	db #bc,#03,#86,#03,#53,#03,#24,#03
	db #f6,#02,#cc,#02,#a4,#02,#7e,#02
	db #5a,#02,#38,#02,#18,#02,#fa,#01
	db #de,#01,#c3,#01,#aa,#01,#92,#01
	db #7b,#01,#66,#01,#52,#01,#3f,#01
	db #2d,#01,#1c,#01,#0c,#01,#fd,#00
	db #ef,#00,#e1,#00,#d5,#00,#c9,#00
	db #be,#00,#b3,#00,#a9,#00,#9f,#00
	db #96,#00,#8e,#00,#86,#00,#7f,#00
	db #77,#00,#71,#00,#6a,#00,#64,#00
	db #5f,#00,#59,#00,#54,#00,#50,#00
	db #4b,#00,#47,#00,#43,#00,#3f,#00
	db #3c,#00,#38,#00,#35,#00,#32,#00
	db #2f,#00,#2d,#00,#2a,#00,#28,#00
	db #26,#00,#24,#00,#22,#00,#20,#00
	db #1e,#00,#1c,#00,#1b,#00,#19,#00
	db #18,#00,#16,#00,#15,#00,#14,#00
	db #13,#00,#12,#00,#11,#00,#10,#00
	db #0f,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
.l0815 equ $ + 4
	db #00,#00,#00,#00,#00,#00,#00,#01
	db #08,#00,#00,#00,#00,#00,#00,#df
.l0823 equ $ + 2
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
.l0831
	db #00,#00,#02,#03,#09,#00,#00,#00
.l083f equ $ + 6
	db #00,#00,#00,#e7,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
.l084d equ $ + 4
	db #00,#00,#00,#00,#00,#00,#04,#05
	db #0a,#00,#00,#00,#00,#00,#00,#ef
.l085b equ $ + 2
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#53,#54,#2d,#4d,#6f,#64
.l087d equ $ + 4
	db #75,#6c,#65,#2e,#1d,#09,#5d,#09
	db #7d,#09,#00,#00,#17,#03,#17,#03
	db #17,#03,#00,#00,#9d,#09,#dd,#09
	db #7d,#09,#08,#18,#17,#03,#17,#03
	db #17,#03,#00,#00,#fd,#09,#3d,#0a
	db #7d,#09,#18,#07,#17,#03,#17,#03
	db #17,#03,#00,#00,#5d,#0a,#9d,#0a
	db #bd,#0a,#00,#00,#dd,#0a,#1d,#0b
	db #3d,#0b,#00,#00,#17,#03,#17,#03
	db #17,#03,#00,#00,#17,#03,#17,#03
	db #17,#03,#00,#00,#17,#03,#17,#03
	db #17,#03,#00,#00,#17,#03,#17,#03
	db #17,#03,#00,#00,#17,#03,#17,#03
	db #17,#03,#00,#00,#17,#03,#17,#03
	db #17,#03,#00,#00,#17,#03,#17,#03
	db #17,#03,#00,#00,#17,#03,#17,#03
.l08fd equ $ + 4
	db #17,#03,#00,#00,#17,#03,#17,#03
	db #17,#03,#17,#03,#17,#03,#17,#03
	db #17,#03,#17,#03,#17,#03,#17,#03
	db #17,#03,#17,#03,#17,#03,#17,#03
	db #17,#03,#17,#03,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#00,#00,#0f,#0e,#0d,#0d
	db #0d,#0c,#0c,#0c,#0c,#0b,#0b,#0b
	db #0b,#0a,#0a,#0a,#09,#09,#09,#08
	db #08,#07,#07,#06,#05,#04,#03,#02
	db #01,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #01,#00,#01,#00,#02,#00,#02,#00
	db #01,#00,#01,#00,#00,#00,#00,#00
	db #01,#00,#01,#00,#02,#00,#02,#00
	db #01,#00,#01,#00,#00,#00,#00,#00
	db #01,#00,#01,#00,#02,#00,#02,#00
	db #01,#00,#01,#00,#00,#00,#00,#00
	db #01,#00,#01,#00,#02,#00,#02,#00
	db #01,#00,#01,#00,#0d,#0c,#0b,#80
	db #80,#80,#80,#80,#80,#80,#80,#80
	db #80,#80,#80,#80,#80,#80,#80,#80
	db #80,#80,#80,#80,#80,#80,#80,#80
	db #80,#80,#80,#80,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#01,#00
	db #02,#00,#01,#00,#00,#00,#ff,#ff
	db #fe,#ff,#ff,#ff,#00,#00,#01,#00
	db #02,#00,#01,#00,#00,#00,#ff,#ff
	db #fe,#ff,#ff,#ff,#00,#00,#01,#00
	db #02,#00,#01,#00,#00,#00,#ff,#ff
	db #fe,#ff,#ff,#ff,#00,#00,#01,#00
	db #02,#00,#01,#00,#0e,#0e,#0e,#0d
	db #0d,#0d,#0c,#0c,#0b,#0a,#09,#07
	db #05,#07,#09,#0b,#0b,#0b,#0b,#0b
	db #0b,#0a,#0a,#0a,#09,#09,#09,#09
	db #09,#09,#09,#09,#00,#00,#40,#00
	db #80,#00,#c0,#00,#00,#01,#40,#01
	db #80,#01,#c0,#01,#00,#02,#40,#02
	db #80,#02,#c0,#02,#00,#03,#40,#03
	db #80,#03,#c0,#03,#00,#04,#40,#04
	db #80,#04,#c0,#04,#00,#05,#40,#05
	db #80,#05,#c0,#05,#00,#06,#40,#06
	db #80,#06,#c0,#06,#00,#07,#40,#07
	db #80,#07,#c0,#07,#0f,#0f,#0f,#0e
	db #0e,#0e,#0d,#0d,#0d,#0c,#0c,#0c
	db #0b,#0b,#0b,#0a,#0a,#0a,#09,#09
	db #09,#08,#08,#08,#07,#07,#07,#06
	db #06,#06,#03,#00,#00,#80,#80,#80
	db #80,#80,#80,#80,#80,#80,#80,#80
	db #80,#80,#80,#80,#80,#80,#80,#80
	db #80,#80,#80,#80,#80,#80,#80,#80
	db #80,#80,#80,#80,#00,#00,#30,#00
	db #60,#00,#90,#00,#c0,#00,#f0,#00
	db #20,#01,#50,#01,#80,#01,#b0,#01
	db #e0,#01,#10,#02,#40,#02,#70,#02
	db #a0,#02,#d0,#02,#00,#03,#20,#03
	db #40,#03,#60,#03,#70,#03,#80,#03
	db #90,#03,#a0,#03,#00,#00,#00,#00
	db #00,#00,#00,#00,#00,#00,#00,#00
	db #00,#00,#00,#00,#0f,#0e,#0e,#0d
	db #0d,#0c,#0c,#0b,#0a,#0a,#09,#09
	db #08,#07,#07,#06,#06,#05,#05,#04
	db #04,#03,#03,#02,#02,#00,#00,#00
	db #00,#00,#00,#00,#04,#06,#07,#09
	db #0c,#11,#17,#1d,#15,#10,#0c,#09
	db #06,#05,#04,#04,#03,#03,#03,#02
	db #02,#02,#01,#00,#00,#00,#00,#00
.l0b5d equ $ + 4
	db #00,#00,#00,#00,#00,#c0,#0b,#00
	db #db,#0b,#00,#f3,#0b,#00,#09,#0c
	db #00,#f3,#0b,#00,#09,#0c,#00,#25
	db #0c,#00,#3b,#0c,#00,#f3,#0b,#00
.l0b7e equ $ + 5
	db #09,#0c,#80,#5d,#0b,#00,#55,#0c
	db #00,#6e,#0c,#00,#86,#0c,#00,#aa
	db #0c,#00,#ca,#0c,#00,#0c,#0d,#00
	db #ca,#0c,#00,#0c,#0d,#00,#ca,#0c
.l0b9f equ $ + 6
	db #00,#0c,#0d,#80,#7e,#0b,#00,#4e
	db #0d,#00,#67,#0d,#00,#81,#0d,#00
	db #a3,#0d,#00,#c9,#0d,#00,#22,#0e
	db #00,#c9,#0d,#00,#7d,#0e,#00,#c9
	db #0d,#00,#22,#0e,#80,#9f,#0b,#00
	db #04,#40,#06,#12,#44,#06,#02,#49
	db #86,#3d,#86,#40,#84,#47,#86,#3b
	db #86,#3f,#86,#42,#86,#47,#86,#3b
	db #82,#ff,#00,#04,#3d,#06,#02,#40
	db #86,#45,#86,#39,#86,#3d,#84,#38
	db #86,#44,#86,#3f,#86,#3c,#88,#3c
	db #86,#ff,#49,#16,#04,#49,#82,#4c
	db #82,#4b,#82,#49,#82,#47,#98,#47
	db #82,#47,#83,#47,#83,#47,#82,#ff
	db #45,#16,#04,#45,#82,#45,#82,#47
	db #82,#45,#82,#44,#90,#44,#82,#48
	db #84,#49,#84,#4c,#82,#4b,#82,#49
	db #82,#47,#82,#ff,#4c,#16,#04,#4c
	db #82,#4c,#82,#4e,#82,#50,#84,#4e
	db #96,#4e,#82,#53,#83,#53,#83,#53
	db #82,#ff,#51,#16,#04,#51,#82,#51
	db #83,#55,#83,#51,#82,#50,#90,#4e
	db #84,#4c,#84,#4b,#82,#4c,#82,#4b
	db #82,#47,#82,#ff,#00,#02,#44,#06
	db #12,#49,#06,#02,#3d,#86,#40,#86
	db #44,#88,#42,#86,#47,#86,#3b,#86
	db #3f,#86,#42,#86,#ff,#45,#06,#02
	db #39,#86,#3d,#86,#40,#88,#40,#88
	db #3c,#86,#38,#86,#44,#86,#3f,#84
	db #38,#86,#44,#82,#ff,#00,#02,#44
	db #04,#02,#3d,#84,#44,#84,#3d,#84
	db #44,#84,#3d,#84,#44,#84,#3d,#84
	db #42,#84,#3b,#84,#42,#84,#3b,#84
	db #42,#84,#3b,#84,#42,#84,#3b,#82
	db #ff,#45,#04,#02,#3d,#84,#45,#84
	db #3d,#84,#45,#84,#3d,#84,#45,#84
	db #3d,#84,#38,#86,#44,#84,#3c,#84
	db #44,#84,#3c,#86,#38,#84,#3f,#84
	db #ff,#49,#02,#02,#44,#82,#40,#82
	db #3d,#82,#49,#82,#44,#82,#40,#82
	db #3d,#82,#49,#82,#44,#82,#40,#82
	db #3d,#82,#49,#82,#44,#82,#40,#82
	db #3d,#82,#47,#82,#42,#82,#3f,#82
	db #3b,#82,#47,#82,#42,#82,#3f,#82
	db #3b,#82,#47,#82,#42,#82,#3f,#82
	db #3b,#82,#47,#82,#42,#82,#3f,#82
	db #3b,#82,#ff,#45,#02,#02,#40,#82
	db #3d,#82,#39,#82,#45,#82,#40,#82
	db #3d,#82,#39,#82,#45,#82,#40,#82
	db #3d,#82,#39,#82,#45,#82,#40,#82
	db #3d,#82,#39,#82,#38,#82,#3c,#82
	db #3f,#82,#44,#82,#38,#82,#3c,#82
	db #3f,#82,#44,#82,#38,#82,#3c,#82
	db #3f,#82,#44,#82,#38,#82,#3c,#82
	db #3f,#82,#44,#82,#ff,#49,#06,#12
	db #3d,#06,#02,#40,#86,#44,#86,#49
	db #86,#3d,#86,#3f,#86,#42,#86,#47
	db #86,#3b,#86,#3f,#84,#ff,#00,#02
	db #40,#06,#02,#45,#86,#39,#86,#3d
	db #84,#45,#86,#39,#86,#3f,#86,#3c
	db #86,#38,#86,#44,#86,#3f,#84,#ff
	db #49,#04,#02,#40,#84,#49,#84,#40
	db #84,#49,#84,#40,#84,#49,#84,#40
	db #84,#47,#84,#3f,#84,#47,#84,#3f
	db #84,#47,#84,#3f,#84,#47,#84,#3f
	db #84,#ff,#00,#02,#40,#04,#02,#39
	db #84,#40,#84,#39,#84,#40,#84,#39
	db #84,#40,#84,#39,#84,#3c,#82,#3f
	db #84,#38,#84,#3f,#84,#38,#84,#3f
	db #82,#44,#84,#3c,#84,#44,#82,#ff
	db #2e,#02,#16,#25,#02,#c0,#19,#25
	db #82,#25,#82,#3a,#02,#17,#25,#02
	db #c0,#19,#25,#82,#2e,#02,#16,#2e
	db #82,#25,#02,#c0,#19,#25,#82,#25
	db #82,#3a,#02,#17,#25,#02,#c0,#19
	db #25,#82,#25,#82,#2e,#02,#16,#23
	db #02,#c0,#1c,#23,#82,#23,#82,#3a
	db #02,#17,#23,#02,#c0,#1c,#23,#82
	db #2e,#02,#16,#2e,#82,#23,#02,#c0
	db #1c,#23,#82,#23,#82,#3a,#02,#17
	db #23,#02,#c0,#1c,#23,#82,#23,#82
	db #ff
;
.music_info
	db "Shadows Demo (1993)(OdieSoft)(OdieSoft)",0
	db "ST-Module",0

	read "music_end.asm"
